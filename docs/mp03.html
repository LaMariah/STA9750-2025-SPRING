<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="La Maria">
<meta name="dcterms.date" content="2025-04-23">

<title>STA 9750 Mini-Project #03: Creating the Ultimate Playlist – STA 9750 Submission Material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-5664db548e9c0b0a5afddbdb7cf6a1b8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>

<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">STA 9750 Submission Material</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#task-1-song-characteristics-dataset" id="toc-task-1-song-characteristics-dataset" class="nav-link" data-scroll-target="#task-1-song-characteristics-dataset">Task 1: Song Characteristics Dataset</a></li>
  <li><a href="#task-2-playlist-dataset" id="toc-task-2-playlist-dataset" class="nav-link" data-scroll-target="#task-2-playlist-dataset">Task 2: Playlist Dataset</a></li>
  <li><a href="#task-3-rectangling-the-playlist-data" id="toc-task-3-rectangling-the-playlist-data" class="nav-link" data-scroll-target="#task-3-rectangling-the-playlist-data">Task 3: Rectangling the Playlist Data</a></li>
  <li><a href="#task-4-initial-exploration" id="toc-task-4-initial-exploration" class="nav-link" data-scroll-target="#task-4-initial-exploration">Task 4: Initial Exploration</a></li>
  <li><a href="#combining-datasets" id="toc-combining-datasets" class="nav-link" data-scroll-target="#combining-datasets">Combining Datasets</a></li>
  <li><a href="#task-5-visually-identifying-characteristics-of-popular-songs" id="toc-task-5-visually-identifying-characteristics-of-popular-songs" class="nav-link" data-scroll-target="#task-5-visually-identifying-characteristics-of-popular-songs">Task 5: Visually Identifying Characteristics of Popular Songs</a>
  <ul class="collapse">
  <li><a href="#question-1-is-popularity-correlated-with-playlist-appearances" id="toc-question-1-is-popularity-correlated-with-playlist-appearances" class="nav-link" data-scroll-target="#question-1-is-popularity-correlated-with-playlist-appearances">Question 1: Is popularity correlated with playlist appearances?</a></li>
  <li><a href="#question-2-in-what-year-were-the-most-popular-songs-released" id="toc-question-2-in-what-year-were-the-most-popular-songs-released" class="nav-link" data-scroll-target="#question-2-in-what-year-were-the-most-popular-songs-released">Question 2: In what year were the most popular songs released?</a></li>
  <li><a href="#question-3-in-what-year-did-danceability-peak" id="toc-question-3-in-what-year-did-danceability-peak" class="nav-link" data-scroll-target="#question-3-in-what-year-did-danceability-peak">Question 3: In what year did danceability peak?</a></li>
  <li><a href="#question-4-which-decade-is-most-represented-on-user-playlists" id="toc-question-4-which-decade-is-most-represented-on-user-playlists" class="nav-link" data-scroll-target="#question-4-which-decade-is-most-represented-on-user-playlists">Question 4: Which decade is most represented on user playlists?</a></li>
  <li><a href="#question-5-musical-key-frequency-in-polar-coordinates" id="toc-question-5-musical-key-frequency-in-polar-coordinates" class="nav-link" data-scroll-target="#question-5-musical-key-frequency-in-polar-coordinates">Question 5: Musical Key Frequency in Polar Coordinates</a></li>
  <li><a href="#question-6-popular-track-lengths" id="toc-question-6-popular-track-lengths" class="nav-link" data-scroll-target="#question-6-popular-track-lengths">Question 6: Popular Track Lengths</a></li>
  <li><a href="#question-7-additional-exploratory-analyses" id="toc-question-7-additional-exploratory-analyses" class="nav-link" data-scroll-target="#question-7-additional-exploratory-analyses">Question 7: Additional Exploratory Analyses</a></li>
  </ul></li>
  <li><a href="#task-6-finding-related-songs-using-anchor-songs" id="toc-task-6-finding-related-songs-using-anchor-songs" class="nav-link" data-scroll-target="#task-6-finding-related-songs-using-anchor-songs">Task 6: Finding Related Songs Using Anchor Songs</a>
  <ul class="collapse">
  <li><a href="#heuristic-1-songs-on-the-same-playlists" id="toc-heuristic-1-songs-on-the-same-playlists" class="nav-link" data-scroll-target="#heuristic-1-songs-on-the-same-playlists">Heuristic 1: Songs on the Same Playlists</a></li>
  <li><a href="#heuristic-2-songs-with-similar-audio-features" id="toc-heuristic-2-songs-with-similar-audio-features" class="nav-link" data-scroll-target="#heuristic-2-songs-with-similar-audio-features">Heuristic 2: Songs with Similar Audio Features</a></li>
  <li><a href="#heuristic-3-songs-by-the-same-artists" id="toc-heuristic-3-songs-by-the-same-artists" class="nav-link" data-scroll-target="#heuristic-3-songs-by-the-same-artists">Heuristic 3: Songs by the Same Artists</a></li>
  <li><a href="#heuristic-4-songs-from-the-same-era-with-similar-features" id="toc-heuristic-4-songs-from-the-same-era-with-similar-features" class="nav-link" data-scroll-target="#heuristic-4-songs-from-the-same-era-with-similar-features">Heuristic 4: Songs from the Same Era with Similar Features</a></li>
  <li><a href="#heuristic-5-songs-with-complementary-key-signatures" id="toc-heuristic-5-songs-with-complementary-key-signatures" class="nav-link" data-scroll-target="#heuristic-5-songs-with-complementary-key-signatures">Heuristic 5: Songs with Complementary Key Signatures</a></li>
  <li><a href="#combining-candidate-songs" id="toc-combining-candidate-songs" class="nav-link" data-scroll-target="#combining-candidate-songs">Combining Candidate Songs</a></li>
  </ul></li>
  <li><a href="#task-7-creating-the-ultimate-playlist" id="toc-task-7-creating-the-ultimate-playlist" class="nav-link" data-scroll-target="#task-7-creating-the-ultimate-playlist">Task 7: Creating the Ultimate Playlist</a>
  <ul class="collapse">
  <li><a href="#visualizing-the-ultimate-playlist" id="toc-visualizing-the-ultimate-playlist" class="nav-link" data-scroll-target="#visualizing-the-ultimate-playlist">Visualizing the Ultimate Playlist</a></li>
  </ul></li>
  <li><a href="#task-7-the-ultimate-playlist---harmonic-journey" id="toc-task-7-the-ultimate-playlist---harmonic-journey" class="nav-link" data-scroll-target="#task-7-the-ultimate-playlist---harmonic-journey">Task 7: The Ultimate Playlist - “Harmonic Journey”</a>
  <ul class="collapse">
  <li><a href="#playlist-design-principles" id="toc-playlist-design-principles" class="nav-link" data-scroll-target="#playlist-design-principles">Playlist Design Principles</a></li>
  </ul></li>
  <li><a href="#why-harmonic-journey-is-ultimate" id="toc-why-harmonic-journey-is-ultimate" class="nav-link" data-scroll-target="#why-harmonic-journey-is-ultimate">Why “Harmonic Journey” Is Ultimate</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#extra-credit-interactive-visualization" id="toc-extra-credit-interactive-visualization" class="nav-link" data-scroll-target="#extra-credit-interactive-visualization">Extra Credit: Interactive Visualization</a></li>
  <li><a href="#interactive-viewer-experience-the-ultimate-playlist" id="toc-interactive-viewer-experience-the-ultimate-playlist" class="nav-link" data-scroll-target="#interactive-viewer-experience-the-ultimate-playlist">Interactive Viewer: Experience the Ultimate Playlist</a></li>
  <li><a href="#resources-references" id="toc-resources-references" class="nav-link" data-scroll-target="#resources-references">Resources &amp; References</a></li>
  <li><a href="#appendix-full-code-repository" id="toc-appendix-full-code-repository" class="nav-link" data-scroll-target="#appendix-full-code-repository">Appendix: Full Code Repository</a></li>
  <li><a href="#final-thoughts" id="toc-final-thoughts" class="nav-link" data-scroll-target="#final-thoughts">Final Thoughts</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">STA 9750 Mini-Project #03: Creating the Ultimate Playlist</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>La Maria </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 23, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load required packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Global options</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-12"><a href="#cb1-12"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>, </span>
<span id="cb1-13"><a href="#cb1-13"></a>                      <span class="at">message =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-14"><a href="#cb1-14"></a>                      <span class="at">fig.width =</span> <span class="dv">10</span>, </span>
<span id="cb1-15"><a href="#cb1-15"></a>                      <span class="at">fig.height =</span> <span class="dv">6</span>,</span>
<span id="cb1-16"><a href="#cb1-16"></a>                      <span class="at">dpi =</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Welcome to my Mini-Project #03: Creating the Ultimate Playlist! In this analysis, I dive into the world of music analytics using Spotify data to create an optimized, data-driven playlist. This project combines two key Spotify data exports:</p>
<ol type="1">
<li>A comprehensive dataset of songs and their audio characteristics (danceability, energy, tempo, etc.)</li>
<li>A collection of user-created playlists showing how songs are typically grouped together</li>
</ol>
<p>Through statistical analysis and visualization of these datasets, I’ll discover patterns in music popularity, explore relationships between audio features, and apply data-driven techniques to music curation. The goal is to create “The Ultimate Playlist” - a carefully crafted sequence of songs that balances familiarity with discovery and creates an engaging listening experience based on audio feature analysis.</p>
<p>This mini-project addresses four key data science competencies: - Data Ingest and Cleaning (partial) - Data Combination and Alignment - Descriptive Statistical Analysis - Data Visualization</p>
<p>The analysis follows a systematic approach, from responsible data acquisition to exploratory data analysis and ultimately playlist creation. Each visualization is crafted to publication quality, with attention to aesthetics, interpretability, and insight generation.</p>
</section>
<section id="task-1-song-characteristics-dataset" class="level2">
<h2 class="anchored" data-anchor-id="task-1-song-characteristics-dataset">Task 1: Song Characteristics Dataset</h2>
<p>First, I’ll write a function to download and load the Spotify song analytics dataset, following responsible data acquisition practices.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)  <span class="co"># for dplyr, tidyr, stringr, etc.</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>load_songs <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb2-4"><a href="#cb2-4"></a>  <span class="co"># 1) Professor-provided file (OneDrive)</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>  local_prof_path <span class="ot">&lt;-</span> <span class="st">"C:/Users/gerus/OneDrive/Documents/STA9750-2025-SPRING/STA9750-2025-SPRING/Spotify_data.csv"</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>  </span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="co"># 2) Project data folder</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>  dest_dir  <span class="ot">&lt;-</span> <span class="st">"data/mp03"</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>  dest_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dest_dir, <span class="st">"spotify_data.csv"</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a>  </span>
<span id="cb2-11"><a href="#cb2-11"></a>  <span class="co"># Ensure data directory exists</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(dest_dir)) {</span>
<span id="cb2-13"><a href="#cb2-13"></a>    <span class="fu">dir.create</span>(dest_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-14"><a href="#cb2-14"></a>    <span class="fu">message</span>(<span class="st">"Created directory: "</span>, dest_dir)</span>
<span id="cb2-15"><a href="#cb2-15"></a>  }</span>
<span id="cb2-16"><a href="#cb2-16"></a>  </span>
<span id="cb2-17"><a href="#cb2-17"></a>  <span class="co"># Load logic</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>  <span class="cf">if</span> (<span class="fu">file.exists</span>(local_prof_path)) {</span>
<span id="cb2-19"><a href="#cb2-19"></a>    <span class="fu">message</span>(<span class="st">"Loading professor-provided CSV from OneDrive"</span>)</span>
<span id="cb2-20"><a href="#cb2-20"></a>    songs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(local_prof_path, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-21"><a href="#cb2-21"></a>    </span>
<span id="cb2-22"><a href="#cb2-22"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">file.exists</span>(dest_file)) {</span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="fu">message</span>(<span class="st">"Loading existing Spotify dataset from "</span>, dest_file)</span>
<span id="cb2-24"><a href="#cb2-24"></a>    songs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(dest_file, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-25"><a href="#cb2-25"></a>    </span>
<span id="cb2-26"><a href="#cb2-26"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="co"># Download fallback</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>    spotify_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/gabminamedez/spotify-data/refs/heads/master/data.csv"</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>    <span class="fu">download.file</span>(<span class="at">url =</span> spotify_url, <span class="at">destfile =</span> dest_file, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="fu">message</span>(<span class="st">"Downloaded Spotify song analytics dataset to "</span>, dest_file)</span>
<span id="cb2-31"><a href="#cb2-31"></a>    songs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(dest_file, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-32"><a href="#cb2-32"></a>  }</span>
<span id="cb2-33"><a href="#cb2-33"></a>  </span>
<span id="cb2-34"><a href="#cb2-34"></a>  <span class="co"># Clean up artist strings and split multiple artists into rows</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>  clean_artist_string <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-36"><a href="#cb2-36"></a>    <span class="fu">str_replace_all</span>(x, <span class="st">"</span><span class="sc">\\</span><span class="st">['"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-37"><a href="#cb2-37"></a>    <span class="fu">str_replace_all</span>(<span class="st">"'</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-38"><a href="#cb2-38"></a>    <span class="fu">str_replace_all</span>(<span class="st">"', '"</span>, <span class="st">","</span>)</span>
<span id="cb2-39"><a href="#cb2-39"></a>  }</span>
<span id="cb2-40"><a href="#cb2-40"></a>  </span>
<span id="cb2-41"><a href="#cb2-41"></a>  songs_clean <span class="ot">&lt;-</span> songs <span class="sc">%&gt;%</span></span>
<span id="cb2-42"><a href="#cb2-42"></a>    <span class="fu">mutate</span>(<span class="at">artists =</span> <span class="fu">clean_artist_string</span>(artists)) <span class="sc">%&gt;%</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>    <span class="fu">separate_rows</span>(artists, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-44"><a href="#cb2-44"></a>    <span class="fu">mutate</span>(<span class="at">artist =</span> <span class="fu">trimws</span>(artists)) <span class="sc">%&gt;%</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>    <span class="fu">select</span>(<span class="sc">-</span>artists)</span>
<span id="cb2-46"><a href="#cb2-46"></a>  </span>
<span id="cb2-47"><a href="#cb2-47"></a>  <span class="fu">return</span>(songs_clean)</span>
<span id="cb2-48"><a href="#cb2-48"></a>}</span>
<span id="cb2-49"><a href="#cb2-49"></a></span>
<span id="cb2-50"><a href="#cb2-50"></a><span class="co"># Load the songs data</span></span>
<span id="cb2-51"><a href="#cb2-51"></a>songs_df <span class="ot">&lt;-</span> <span class="fu">load_songs</span>()</span>
<span id="cb2-52"><a href="#cb2-52"></a></span>
<span id="cb2-53"><a href="#cb2-53"></a><span class="co"># Display the first few rows</span></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="fu">head</span>(songs_df) <span class="sc">%&gt;%</span></span>
<span id="cb2-55"><a href="#cb2-55"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Sample of Song Characteristics Data"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-56"><a href="#cb2-56"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Song Characteristics Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">duration_ms</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">release_date</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">acousticness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">instrumentalness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">liveness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">loudness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">speechiness</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tempo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">valence</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mode</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">key</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">explicit</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6KbQ3uYMLKb5jDxLF7wYDD</td>
<td style="text-align: left;">Singende Bataillone 1. Teil</td>
<td style="text-align: right;">158648</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.708</td>
<td style="text-align: right;">0.1950</td>
<td style="text-align: right;">0.563</td>
<td style="text-align: right;">0.1510</td>
<td style="text-align: right;">-12.428</td>
<td style="text-align: right;">0.0506</td>
<td style="text-align: right;">118.469</td>
<td style="text-align: right;">0.7790</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Carl Woitschach</td>
</tr>
<tr class="even">
<td style="text-align: left;">6KuQTIu1KoTTkLXKrwlLPV</td>
<td style="text-align: left;">Fantasiestücke, Op. 111: Più tosto lento</td>
<td style="text-align: right;">282133</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.994</td>
<td style="text-align: right;">0.379</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: right;">0.0763</td>
<td style="text-align: right;">-28.454</td>
<td style="text-align: right;">0.0462</td>
<td style="text-align: right;">83.972</td>
<td style="text-align: right;">0.0767</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Robert Schumann</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6KuQTIu1KoTTkLXKrwlLPV</td>
<td style="text-align: left;">Fantasiestücke, Op. 111: Più tosto lento</td>
<td style="text-align: right;">282133</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.994</td>
<td style="text-align: right;">0.379</td>
<td style="text-align: right;">0.0135</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: right;">0.0763</td>
<td style="text-align: right;">-28.454</td>
<td style="text-align: right;">0.0462</td>
<td style="text-align: right;">83.972</td>
<td style="text-align: right;">0.0767</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Vladimir Horowitz</td>
</tr>
<tr class="even">
<td style="text-align: left;">6L63VW0PibdM1HDSBoqnoM</td>
<td style="text-align: left;">Chapter 1.18 - Zamek kaniowski</td>
<td style="text-align: right;">104300</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.604</td>
<td style="text-align: right;">0.749</td>
<td style="text-align: right;">0.2200</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.1190</td>
<td style="text-align: right;">-19.924</td>
<td style="text-align: right;">0.9290</td>
<td style="text-align: right;">107.177</td>
<td style="text-align: right;">0.8800</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Seweryn Goszczyński</td>
</tr>
<tr class="odd">
<td style="text-align: left;">6M94FkXd15sOAOQYRnWPN8</td>
<td style="text-align: left;">Bebamos Juntos - Instrumental (Remasterizado)</td>
<td style="text-align: right;">180760</td>
<td style="text-align: left;">9/25/28</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.781</td>
<td style="text-align: right;">0.1300</td>
<td style="text-align: right;">0.887</td>
<td style="text-align: right;">0.1110</td>
<td style="text-align: right;">-14.734</td>
<td style="text-align: right;">0.0926</td>
<td style="text-align: right;">108.003</td>
<td style="text-align: right;">0.7200</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Francisco Canaro</td>
</tr>
<tr class="even">
<td style="text-align: left;">6N6tiFZ9vLTSOIxkj8qKrd</td>
<td style="text-align: left;">Polonaise-Fantaisie in A-Flat Major, Op. 61</td>
<td style="text-align: right;">687733</td>
<td style="text-align: left;">1928</td>
<td style="text-align: right;">1928</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.2040</td>
<td style="text-align: right;">0.908</td>
<td style="text-align: right;">0.0980</td>
<td style="text-align: right;">-16.829</td>
<td style="text-align: right;">0.0424</td>
<td style="text-align: right;">62.149</td>
<td style="text-align: right;">0.0693</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Frédéric Chopin</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The song characteristics dataset contains 226813 rows and 19 columns, with features like popularity, danceability, energy, and more. Each row represents a song-artist combination, as songs with multiple artists have been split into separate rows for easier analysis.</p>
</section>
<section id="task-2-playlist-dataset" class="level2">
<h2 class="anchored" data-anchor-id="task-2-playlist-dataset">Task 2: Playlist Dataset</h2>
<p>Next, I’ll create a function to download and load the Spotify playlist dataset. This dataset is much larger and stored across multiple JSON files, so my function will handle downloading and combining them.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>load_playlists <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">max_slice =</span> <span class="dv">9999</span>,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                           <span class="at">step      =</span> <span class="dv">1000</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>                           <span class="at">quick     =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="co"># — Quick mode for development (loads only first few slices) —</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="cf">if</span> (quick) {</span>
<span id="cb3-6"><a href="#cb3-6"></a>    max_slice <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="fu">message</span>(<span class="st">"⚡ QUICK mode: slices 0–"</span>, max_slice)</span>
<span id="cb3-8"><a href="#cb3-8"></a>  }</span>
<span id="cb3-9"><a href="#cb3-9"></a>  </span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="co"># 1) Professor-provided JSON folder on OneDrive</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>  local_prof_dir <span class="ot">&lt;-</span> <span class="st">"C:/Users/gerus/OneDrive/Documents/STA9750-2025-SPRING/spotify_million_playlist_dataset/data1"</span></span>
<span id="cb3-12"><a href="#cb3-12"></a>  </span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="co"># 2) Fallback: repository folder for downloaded JSON</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  dest_dir <span class="ot">&lt;-</span> <span class="st">"data/mp03/playlists"</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(dest_dir)) {</span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="fu">dir.create</span>(dest_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a>    <span class="fu">message</span>(<span class="st">"Created directory: "</span>, dest_dir)</span>
<span id="cb3-18"><a href="#cb3-18"></a>  }</span>
<span id="cb3-19"><a href="#cb3-19"></a>  </span>
<span id="cb3-20"><a href="#cb3-20"></a>  all_playlists <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb3-21"><a href="#cb3-21"></a>  </span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="cf">if</span> (<span class="fu">dir.exists</span>(local_prof_dir)) {</span>
<span id="cb3-23"><a href="#cb3-23"></a>    <span class="co"># Load from local OneDrive copy</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>    <span class="fu">message</span>(<span class="st">"Loading playlist JSONs from OneDrive: "</span>, local_prof_dir)</span>
<span id="cb3-25"><a href="#cb3-25"></a>    files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(local_prof_dir, <span class="at">pattern =</span> <span class="st">"mpd.slice.*</span><span class="sc">\\</span><span class="st">.json$"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-26"><a href="#cb3-26"></a>    all_playlists <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map</span>(files, <span class="sc">~</span> {</span>
<span id="cb3-27"><a href="#cb3-27"></a>      d <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(.x, <span class="at">simplifyDataFrame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a>      d<span class="sc">$</span>playlists <span class="sc">%||%</span> <span class="fu">list</span>()</span>
<span id="cb3-29"><a href="#cb3-29"></a>    }) <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">flatten</span>()</span>
<span id="cb3-30"><a href="#cb3-30"></a>    </span>
<span id="cb3-31"><a href="#cb3-31"></a>  } <span class="cf">else</span> {</span>
<span id="cb3-32"><a href="#cb3-32"></a>    <span class="co"># Download from GitHub into dest_dir</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>    <span class="fu">message</span>(<span class="st">"No local folder—downloading from GitHub"</span>)</span>
<span id="cb3-34"><a href="#cb3-34"></a>    base_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1"</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>    </span>
<span id="cb3-36"><a href="#cb3-36"></a>    <span class="cf">for</span> (start <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>, max_slice, <span class="at">by =</span> step)) {</span>
<span id="cb3-37"><a href="#cb3-37"></a>      end      <span class="ot">&lt;-</span> start <span class="sc">+</span> step <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb3-38"><a href="#cb3-38"></a>      filename <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"mpd.slice.%d-%d.json"</span>, start, end)</span>
<span id="cb3-39"><a href="#cb3-39"></a>      local_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dest_dir, filename)</span>
<span id="cb3-40"><a href="#cb3-40"></a>      </span>
<span id="cb3-41"><a href="#cb3-41"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(local_path)) {</span>
<span id="cb3-42"><a href="#cb3-42"></a>        <span class="fu">tryCatch</span>({</span>
<span id="cb3-43"><a href="#cb3-43"></a>          <span class="fu">download.file</span>(<span class="fu">paste0</span>(base_url, <span class="st">"/"</span>, filename),</span>
<span id="cb3-44"><a href="#cb3-44"></a>                        local_path, <span class="at">mode =</span> <span class="st">"wb"</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-45"><a href="#cb3-45"></a>          <span class="fu">message</span>(<span class="st">"Downloaded "</span>, filename)</span>
<span id="cb3-46"><a href="#cb3-46"></a>          <span class="fu">Sys.sleep</span>(<span class="fl">0.2</span>)</span>
<span id="cb3-47"><a href="#cb3-47"></a>        }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb3-48"><a href="#cb3-48"></a>          <span class="fu">message</span>(<span class="st">"Error downloading "</span>, filename, <span class="st">": "</span>, e<span class="sc">$</span>message)</span>
<span id="cb3-49"><a href="#cb3-49"></a>        })</span>
<span id="cb3-50"><a href="#cb3-50"></a>      }</span>
<span id="cb3-51"><a href="#cb3-51"></a>      </span>
<span id="cb3-52"><a href="#cb3-52"></a>      <span class="cf">if</span> (<span class="fu">file.exists</span>(local_path)) {</span>
<span id="cb3-53"><a href="#cb3-53"></a>        d <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(local_path, <span class="at">simplifyDataFrame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-54"><a href="#cb3-54"></a>        <span class="cf">if</span> (<span class="st">"playlists"</span> <span class="sc">%in%</span> <span class="fu">names</span>(d)) {</span>
<span id="cb3-55"><a href="#cb3-55"></a>          all_playlists <span class="ot">&lt;-</span> <span class="fu">c</span>(all_playlists, d<span class="sc">$</span>playlists)</span>
<span id="cb3-56"><a href="#cb3-56"></a>          <span class="fu">message</span>(<span class="st">"Processed "</span>, filename, <span class="st">" ("</span>, <span class="fu">length</span>(d<span class="sc">$</span>playlists), <span class="st">" playlists)"</span>)</span>
<span id="cb3-57"><a href="#cb3-57"></a>        }</span>
<span id="cb3-58"><a href="#cb3-58"></a>      }</span>
<span id="cb3-59"><a href="#cb3-59"></a>    }</span>
<span id="cb3-60"><a href="#cb3-60"></a>  }</span>
<span id="cb3-61"><a href="#cb3-61"></a>  </span>
<span id="cb3-62"><a href="#cb3-62"></a>  <span class="fu">return</span>(all_playlists)</span>
<span id="cb3-63"><a href="#cb3-63"></a>}</span>
<span id="cb3-64"><a href="#cb3-64"></a></span>
<span id="cb3-65"><a href="#cb3-65"></a><span class="co"># — During development, you can test with a smaller subset: —</span></span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="co"># playlists &lt;- load_playlists(quick = TRUE)</span></span>
<span id="cb3-67"><a href="#cb3-67"></a></span>
<span id="cb3-68"><a href="#cb3-68"></a><span class="co"># — For your full run (final submission): —</span></span>
<span id="cb3-69"><a href="#cb3-69"></a>playlists <span class="ot">&lt;-</span> <span class="fu">load_playlists</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Successfully loaded 4000 playlists from the Spotify Million Playlist dataset. Each playlist contains information about its name, followers, and tracks. Now I’ll process this hierarchical JSON data into a rectangular format for easier analysis.</p>
</section>
<section id="task-3-rectangling-the-playlist-data" class="level2">
<h2 class="anchored" data-anchor-id="task-3-rectangling-the-playlist-data">Task 3: Rectangling the Playlist Data</h2>
<p>The playlist data is currently in a nested, hierarchical format. To make it more accessible for analysis, I’ll convert it to a rectangular format with one row per track-playlist combination.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="do">## Task 3: Rectangling the Playlist Data</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>rectangle_playlists <span class="ot">&lt;-</span> <span class="cf">function</span>(pls) {</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="co"># load progress bar</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  pb <span class="ot">&lt;-</span> progress<span class="sc">::</span>progress_bar<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="at">total =</span> <span class="fu">length</span>(pls),</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">format =</span> <span class="st">"  Processing playlists [:bar] :percent eta: :eta"</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">clear =</span> <span class="cn">FALSE</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>  )</span>
<span id="cb4-9"><a href="#cb4-9"></a>  </span>
<span id="cb4-10"><a href="#cb4-10"></a>  purrr<span class="sc">::</span><span class="fu">map_dfr</span>(pls, <span class="cf">function</span>(p) {</span>
<span id="cb4-11"><a href="#cb4-11"></a>    pb<span class="sc">$</span><span class="fu">tick</span>()  <span class="co"># advance the bar</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>    </span>
<span id="cb4-13"><a href="#cb4-13"></a>    <span class="co"># Extract playlist‐level metadata</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>    pid     <span class="ot">&lt;-</span> p<span class="sc">$</span>pid</span>
<span id="cb4-15"><a href="#cb4-15"></a>    pname   <span class="ot">&lt;-</span> p<span class="sc">$</span>name</span>
<span id="cb4-16"><a href="#cb4-16"></a>    pfollow <span class="ot">&lt;-</span> p<span class="sc">$</span>num_followers <span class="sc">%||%</span> <span class="cn">NA_integer_</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>    </span>
<span id="cb4-18"><a href="#cb4-18"></a>    <span class="co"># Iterate over tracks</span></span>
<span id="cb4-19"><a href="#cb4-19"></a>    purrr<span class="sc">::</span><span class="fu">map_dfr</span>(<span class="fu">seq_along</span>(p<span class="sc">$</span>tracks), <span class="cf">function</span>(i) {</span>
<span id="cb4-20"><a href="#cb4-20"></a>      t <span class="ot">&lt;-</span> p<span class="sc">$</span>tracks[[i]]</span>
<span id="cb4-21"><a href="#cb4-21"></a>      tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb4-22"><a href="#cb4-22"></a>        <span class="at">playlist_id        =</span> pid,</span>
<span id="cb4-23"><a href="#cb4-23"></a>        <span class="at">playlist_name      =</span> pname,</span>
<span id="cb4-24"><a href="#cb4-24"></a>        <span class="at">playlist_followers =</span> pfollow,</span>
<span id="cb4-25"><a href="#cb4-25"></a>        <span class="at">playlist_position  =</span> i,</span>
<span id="cb4-26"><a href="#cb4-26"></a>        <span class="at">artist_name        =</span> t<span class="sc">$</span>artist_name,</span>
<span id="cb4-27"><a href="#cb4-27"></a>        <span class="at">artist_id          =</span> <span class="fu">sub</span>(<span class="st">".*:.*:(.*)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, t<span class="sc">$</span>artist_uri),</span>
<span id="cb4-28"><a href="#cb4-28"></a>        <span class="at">track_name         =</span> t<span class="sc">$</span>track_name,</span>
<span id="cb4-29"><a href="#cb4-29"></a>        <span class="at">track_id           =</span> <span class="fu">sub</span>(<span class="st">".*:.*:(.*)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, t<span class="sc">$</span>track_uri),</span>
<span id="cb4-30"><a href="#cb4-30"></a>        <span class="at">album_name         =</span> t<span class="sc">$</span>album_name,</span>
<span id="cb4-31"><a href="#cb4-31"></a>        <span class="at">album_id           =</span> <span class="fu">sub</span>(<span class="st">".*:.*:(.*)$"</span>, <span class="st">"</span><span class="sc">\\</span><span class="st">1"</span>, t<span class="sc">$</span>album_uri),</span>
<span id="cb4-32"><a href="#cb4-32"></a>        <span class="at">duration           =</span> t<span class="sc">$</span>duration_ms</span>
<span id="cb4-33"><a href="#cb4-33"></a>      )</span>
<span id="cb4-34"><a href="#cb4-34"></a>    })</span>
<span id="cb4-35"><a href="#cb4-35"></a>  })</span>
<span id="cb4-36"><a href="#cb4-36"></a>}</span>
<span id="cb4-37"><a href="#cb4-37"></a></span>
<span id="cb4-38"><a href="#cb4-38"></a><span class="co"># 1. Transform the data</span></span>
<span id="cb4-39"><a href="#cb4-39"></a>rectangular_playlists <span class="ot">&lt;-</span> <span class="fu">rectangle_playlists</span>(playlists)</span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="co"># 2. Show a quick preview</span></span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="fu">head</span>(rectangular_playlists, <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-43"><a href="#cb4-43"></a>  <span class="fu">kable</span>(</span>
<span id="cb4-44"><a href="#cb4-44"></a>    <span class="at">caption =</span> <span class="st">"Sample of Rectangular Playlist Data (Real JSON)"</span>,</span>
<span id="cb4-45"><a href="#cb4-45"></a>    <span class="at">digits  =</span> <span class="dv">2</span></span>
<span id="cb4-46"><a href="#cb4-46"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb4-47"><a href="#cb4-47"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Rectangular Playlist Data (Real JSON)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">playlist_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">playlist_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">playlist_followers</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">playlist_position</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">track_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">album_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">album_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Missy Elliott</td>
<td style="text-align: left;">2wIVse2owClT7go1WT98tk</td>
<td style="text-align: left;">Lose Control (feat. Ciara &amp; Fat Man Scoop)</td>
<td style="text-align: left;">0UaMYEvWZi0ZqiDOoHU3YI</td>
<td style="text-align: left;">The Cookbook</td>
<td style="text-align: left;">6vV5UrXcfyQD1wu4Qo2I9K</td>
<td style="text-align: right;">226863</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Britney Spears</td>
<td style="text-align: left;">26dSoYclwsYLMAKD3tpOr4</td>
<td style="text-align: left;">Toxic</td>
<td style="text-align: left;">6I9VzXrHxO9rA9A5euc8Ak</td>
<td style="text-align: left;">In The Zone</td>
<td style="text-align: left;">0z7pVBGOD7HCIB7S8eLkLI</td>
<td style="text-align: right;">198800</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Beyoncé</td>
<td style="text-align: left;">6vWDO969PvNqNYHIOW5v0m</td>
<td style="text-align: left;">Crazy In Love</td>
<td style="text-align: left;">0WqIKmW4BTrj3eJFmnCKMv</td>
<td style="text-align: left;">Dangerously In Love (Alben für die Ewigkeit)</td>
<td style="text-align: left;">25hVFAxTlDvXbx2X2QkUkE</td>
<td style="text-align: right;">235933</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">Justin Timberlake</td>
<td style="text-align: left;">31TPClRtHm23RisEBtV3X7</td>
<td style="text-align: left;">Rock Your Body</td>
<td style="text-align: left;">1AWQoqb9bSvzTjaLralEkT</td>
<td style="text-align: left;">Justified</td>
<td style="text-align: left;">6QPkyl04rXwTGlGlcYaRoW</td>
<td style="text-align: right;">267266</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Shaggy</td>
<td style="text-align: left;">5EvFsr3kj42KNv97ZEnqij</td>
<td style="text-align: left;">It Wasn't Me</td>
<td style="text-align: left;">1lzr43nnXAijIGYnCT8M8H</td>
<td style="text-align: left;">Hot Shot</td>
<td style="text-align: left;">6NmFmPX56pcLBOFMhIiKvF</td>
<td style="text-align: right;">227600</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: left;">23zg3TcAtWQy7J6upgbUnj</td>
<td style="text-align: left;">Yeah!</td>
<td style="text-align: left;">0XUfyU2QviPAs6bxSpXYG4</td>
<td style="text-align: left;">Confessions</td>
<td style="text-align: left;">0vO0b1AvY49CPQyVisJLj0</td>
<td style="text-align: right;">250373</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: left;">23zg3TcAtWQy7J6upgbUnj</td>
<td style="text-align: left;">My Boo</td>
<td style="text-align: left;">68vgtRHr7iZHpzGpon6Jlo</td>
<td style="text-align: left;">Confessions</td>
<td style="text-align: left;">1RM6MGv6bcl6NrAG8PGoZk</td>
<td style="text-align: right;">223440</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">The Pussycat Dolls</td>
<td style="text-align: left;">6wPhSqRtPu1UhRCDX5yaDJ</td>
<td style="text-align: left;">Buttons</td>
<td style="text-align: left;">3BxWKCI06eQ5Od8TY2JBeA</td>
<td style="text-align: left;">PCD</td>
<td style="text-align: left;">5x8e8UcCeOgrOzSnDGuPye</td>
<td style="text-align: right;">225560</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">Destiny's Child</td>
<td style="text-align: left;">1Y8cdNmUJH7yBTd9yOvr5i</td>
<td style="text-align: left;">Say My Name</td>
<td style="text-align: left;">7H6ev70Weq6DdpZyyTmUXk</td>
<td style="text-align: left;">The Writing's On The Wall</td>
<td style="text-align: left;">283NWqNsCA9GwVHrJk59CG</td>
<td style="text-align: right;">271333</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: left;">Throwbacks</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">OutKast</td>
<td style="text-align: left;">1G9G7WwrXka3Z1r7aIDjI7</td>
<td style="text-align: left;">Hey Ya! - Radio Mix / Club Mix</td>
<td style="text-align: left;">2PpruBYCo4H7WOBJ7Q2EwM</td>
<td style="text-align: left;">Speakerboxxx/The Love Below</td>
<td style="text-align: left;">1UsmQ3bpJTyK6ygoOOjG1r</td>
<td style="text-align: right;">235213</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># 3. Report the total number of rows</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="fu">cat</span>(<span class="st">"✅ Total track–playlist rows:"</span>, <span class="fu">nrow</span>(rectangular_playlists), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✅ Total track–playlist rows: 268251 </code></pre>
</div>
</div>
<p>Successfully converted the playlist data to a rectangular format with 268251 rows. Each row represents a track’s appearance in a playlist, with information about both the playlist and the track.</p>
</section>
<section id="task-4-initial-exploration" class="level2">
<h2 class="anchored" data-anchor-id="task-4-initial-exploration">Task 4: Initial Exploration</h2>
<p>Now that our data is rectangular, let’s see how many items we have and what immediately stands out.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># 1. Distinct counts</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>distinct_tracks  <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(track_id)  <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb7-3"><a href="#cb7-3"></a>distinct_artists <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(artist_id) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="fu">cat</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="st">"🎵 Distinct tracks in playlist data: "</span>,  distinct_tracks,  <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="st">"👩‍🎤 Distinct artists in playlist data: "</span>, distinct_artists, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>🎵 Distinct tracks in playlist data:  92815 
 👩‍🎤 Distinct artists in playlist data:  22090 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># 2. Top 5 most popular tracks (by playlist appearances)</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>popular_tracks <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">count</span>(track_id, track_name, artist_name, <span class="at">name =</span> <span class="st">"appearances"</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a>popular_tracks <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">kable</span>(</span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="at">caption =</span> <span class="st">"Top 5 Tracks by Playlist Appearances"</span>,</span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track ID"</span>, <span class="st">"Track Name"</span>, <span class="st">"Artist"</span>, <span class="st">"# Appearances"</span>),</span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="at">digits =</span> <span class="dv">0</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Tracks by Playlist Appearances</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Track ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Track Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Appearances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7BKLCZ1jbUBVqRi2FVlTVw</td>
<td style="text-align: left;">Closer</td>
<td style="text-align: left;">The Chainsmokers</td>
<td style="text-align: right;">193</td>
</tr>
<tr class="even">
<td style="text-align: left;">1xznGGDReH1oQq0xzbwXa3</td>
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake</td>
<td style="text-align: right;">189</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7KXjTSCq5nL1LoYtL7XAwS</td>
<td style="text-align: left;">HUMBLE.</td>
<td style="text-align: left;">Kendrick Lamar</td>
<td style="text-align: right;">184</td>
</tr>
<tr class="even">
<td style="text-align: left;">7yyRTcZmCiyzzJlNzGC9Ol</td>
<td style="text-align: left;">Broccoli (feat. Lil Yachty)</td>
<td style="text-align: left;">DRAM</td>
<td style="text-align: right;">170</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3a1lNhkSLSkpJE4MSHpDu9</td>
<td style="text-align: left;">Congratulations</td>
<td style="text-align: left;">Post Malone</td>
<td style="text-align: right;">159</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># 3. Most popular track missing from song characteristics</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>songs_with_id <span class="ot">&lt;-</span> songs_df <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">track_id =</span> id)</span>
<span id="cb10-3"><a href="#cb10-3"></a>missing_track <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">anti_join</span>(songs_with_id, <span class="at">by =</span> <span class="st">"track_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">count</span>(track_id, track_name, artist_name, <span class="at">name =</span> <span class="st">"appearances"</span>, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>missing_track <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">kable</span>(</span>
<span id="cb10-10"><a href="#cb10-10"></a>    <span class="at">caption =</span> <span class="st">"Top Track in Playlists Absent from Characteristics Dataset"</span>,</span>
<span id="cb10-11"><a href="#cb10-11"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track ID"</span>, <span class="st">"Track Name"</span>, <span class="st">"Artist"</span>, <span class="st">"# Appearances"</span>),</span>
<span id="cb10-12"><a href="#cb10-12"></a>    <span class="at">digits =</span> <span class="dv">0</span></span>
<span id="cb10-13"><a href="#cb10-13"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top Track in Playlists Absent from Characteristics Dataset</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Track ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Track Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Appearances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1xznGGDReH1oQq0xzbwXa3</td>
<td style="text-align: left;">One Dance</td>
<td style="text-align: left;">Drake</td>
<td style="text-align: right;">189</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># 4. Most danceable track and its playlist count</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>most_danceable <span class="ot">&lt;-</span> songs_with_id <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(danceability)) <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3"></a>danceable_count <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">filter</span>(track_id <span class="sc">==</span> most_danceable<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span> <span class="fu">nrow</span>()</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a>danceable_info <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="at">Track       =</span> most_danceable<span class="sc">$</span>name,</span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="at">Artist      =</span> most_danceable<span class="sc">$</span>artist,</span>
<span id="cb11-9"><a href="#cb11-9"></a>  <span class="at">Danceability=</span> <span class="fu">round</span>(most_danceable<span class="sc">$</span>danceability, <span class="dv">3</span>),</span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="at">Appearances =</span> danceable_count</span>
<span id="cb11-11"><a href="#cb11-11"></a>)</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a>danceable_info <span class="sc">%&gt;%</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>  <span class="fu">kable</span>(</span>
<span id="cb11-15"><a href="#cb11-15"></a>    <span class="at">caption =</span> <span class="st">"Most Danceable Track and Its Playlist Appearances"</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Most Danceable Track and Its Playlist Appearances</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Appearances</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Funky Cold Medina</td>
<td style="text-align: left;">Tone-Loc</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># 5. Playlist with the longest average track duration</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>longest_avg <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">group_by</span>(playlist_id, playlist_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="at">avg_duration_min =</span> <span class="fu">mean</span>(duration, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="dv">60000</span>,</span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="at">n_tracks         =</span> <span class="fu">n</span>(),</span>
<span id="cb12-7"><a href="#cb12-7"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="fu">filter</span>(n_tracks <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_duration_min)) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a>longest_avg <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="fu">kable</span>(</span>
<span id="cb12-15"><a href="#cb12-15"></a>    <span class="at">caption =</span> <span class="st">"Playlist with the Longest Average Track Length"</span>,</span>
<span id="cb12-16"><a href="#cb12-16"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Playlist ID"</span>, <span class="st">"Playlist Name"</span>, <span class="st">"Avg. Duration (min)"</span>, <span class="st">"# Tracks"</span>),</span>
<span id="cb12-17"><a href="#cb12-17"></a>    <span class="at">digits =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="dv">2</span>, <span class="dv">0</span>)</span>
<span id="cb12-18"><a href="#cb12-18"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Playlist with the Longest Average Track Length</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Playlist ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Playlist Name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Avg. Duration (min)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Tracks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">NA</td>
<td style="text-align: left;">sleep</td>
<td style="text-align: right;">14.81</td>
<td style="text-align: right;">29</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># 6. Most followed playlist</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>top_playlist <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">group_by</span>(playlist_id, playlist_name) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="at">followers =</span> <span class="fu">first</span>(playlist_followers),</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="at">n_tracks  =</span> <span class="fu">n</span>(),</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(followers)) <span class="sc">%&gt;%</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a></span>
<span id="cb13-12"><a href="#cb13-12"></a>top_playlist <span class="sc">%&gt;%</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="fu">kable</span>(</span>
<span id="cb13-14"><a href="#cb13-14"></a>    <span class="at">caption =</span> <span class="st">"Most Followed Playlist on Spotify"</span>,</span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Playlist ID"</span>, <span class="st">"Playlist Name"</span>, <span class="st">"# Followers"</span>, <span class="st">"# Tracks"</span>),</span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="at">digits =</span> <span class="dv">0</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-18"><a href="#cb13-18"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Most Followed Playlist on Spotify</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Playlist ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Playlist Name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Followers</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Tracks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">7215</td>
<td style="text-align: left;">TOP POP</td>
<td style="text-align: right;">15842</td>
<td style="text-align: right;">52</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>From this initial exploration, we’ve discovered:</p>
<p>🎵 r distinct_tracks unique tracks and r distinct_artists unique artists across all playlists.</p>
<p>🔝 The top track by playlist appearances is “r popular_tracks<span class="math inline">\(track_name[1]” by r popular_tracks\)</span>artist_name[1], appearing r popular_tracks$appearances[1] times.</p>
<p>⚠️ One highly‐ranked track, “r missing_track$track_name”, doesn’t appear in the song-characteristics dataset, highlighting a gap in the data.</p>
<p>💃 The most danceable song is “r most_danceable<span class="math inline">\(name” by r most_danceable\)</span>artist (danceability r round(most_danceable$danceability,3)), with r most_danceable_appearances playlist appearances.</p>
<p>⏱️ The playlist with the longest average track length is “r longest_avg<span class="math inline">\(playlist_name”, averaging r round(longest_avg\)</span>avg_duration_min,2) minutes per track.</p>
<p>🌟 The most followed playlist is “r top_playlist<span class="math inline">\(playlist_name” with r top_playlist\)</span>followers followers.</p>
</section>
<section id="combining-datasets" class="level2">
<h2 class="anchored" data-anchor-id="combining-datasets">Combining Datasets</h2>
<p>Now we’ll merge our cleaned song characteristics (songs_df) with the playlist appearances (rectangular_playlists) so each track record carries both its audio features and how many times it appears in user playlists.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># 1) Prepare songs_df with consistent track_id and ensure year is numeric</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>songs_with_id <span class="ot">&lt;-</span> songs_df <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3"></a>  <span class="fu">rename</span>(<span class="at">track_id =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4"></a>  <span class="co"># If release_date is a character, extract year; otherwise use existing year</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="at">year =</span> <span class="cf">if</span> (<span class="st">"year"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="fu">as.integer</span>(year)</span>
<span id="cb14-7"><a href="#cb14-7"></a>           <span class="cf">else</span> lubridate<span class="sc">::</span><span class="fu">year</span>(lubridate<span class="sc">::</span><span class="fu">as_date</span>(release_date))</span>
<span id="cb14-8"><a href="#cb14-8"></a>  )</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co"># 2) Inner join: only keep tracks present in both datasets</span></span>
<span id="cb14-11"><a href="#cb14-11"></a>joined_data <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb14-12"><a href="#cb14-12"></a>  <span class="fu">inner_join</span>(songs_with_id, <span class="at">by =</span> <span class="st">"track_id"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co"># Sanity check</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="fu">cat</span>(<span class="st">"✅ After join, we have"</span>, <span class="fu">nrow</span>(joined_data), </span>
<span id="cb14-16"><a href="#cb14-16"></a>    <span class="st">"rows covering"</span>, <span class="fu">n_distinct</span>(joined_data<span class="sc">$</span>track_id), <span class="st">"unique tracks.</span><span class="sc">\n\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>✅ After join, we have 150808 rows covering 19401 unique tracks.</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># 3) Compute appearances</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>track_appearances <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>  <span class="fu">count</span>(track_id, <span class="at">name =</span> <span class="st">"playlist_appearances"</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co"># 4) Build final analysis dataset, including year</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>track_data <span class="ot">&lt;-</span> joined_data <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="fu">select</span>(</span>
<span id="cb16-8"><a href="#cb16-8"></a>    track_id, track_name, artist_name,</span>
<span id="cb16-9"><a href="#cb16-9"></a>    popularity, danceability, energy, key, mode, tempo,</span>
<span id="cb16-10"><a href="#cb16-10"></a>    duration, year</span>
<span id="cb16-11"><a href="#cb16-11"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="fu">distinct</span>(track_id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>  <span class="fu">left_join</span>(track_appearances, <span class="at">by =</span> <span class="st">"track_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>  <span class="co"># Derive additional fields</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-16"><a href="#cb16-16"></a>    <span class="at">duration_min =</span> duration <span class="sc">/</span> (<span class="dv">1000</span> <span class="sc">*</span> <span class="dv">60</span>),</span>
<span id="cb16-17"><a href="#cb16-17"></a>    <span class="at">decade       =</span> (year <span class="sc">%/%</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>  )</span>
<span id="cb16-19"><a href="#cb16-19"></a></span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="co"># 5) Show a sample</span></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="fu">head</span>(track_data) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>  <span class="fu">kable</span>(</span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="at">caption =</span> <span class="st">"Sample of Combined Track Data"</span>,</span>
<span id="cb16-24"><a href="#cb16-24"></a>    <span class="at">digits  =</span> <span class="dv">2</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-26"><a href="#cb16-26"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Sample of Combined Track Data</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">track_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">key</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mode</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tempo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">duration</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">playlist_appearances</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">duration_min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">decade</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0UaMYEvWZi0ZqiDOoHU3YI</td>
<td style="text-align: left;">Lose Control (feat. Ciara &amp; Fat Man Scoop)</td>
<td style="text-align: left;">Missy Elliott</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">125.46</td>
<td style="text-align: right;">226863</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">3.78</td>
<td style="text-align: right;">2000</td>
</tr>
<tr class="even">
<td style="text-align: left;">6I9VzXrHxO9rA9A5euc8Ak</td>
<td style="text-align: left;">Toxic</td>
<td style="text-align: left;">Britney Spears</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">143.04</td>
<td style="text-align: right;">198800</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">3.31</td>
<td style="text-align: right;">2000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1AWQoqb9bSvzTjaLralEkT</td>
<td style="text-align: left;">Rock Your Body</td>
<td style="text-align: left;">Justin Timberlake</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">100.97</td>
<td style="text-align: right;">267266</td>
<td style="text-align: right;">2002</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">2000</td>
</tr>
<tr class="even">
<td style="text-align: left;">68vgtRHr7iZHpzGpon6Jlo</td>
<td style="text-align: left;">My Boo</td>
<td style="text-align: left;">Usher</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">86.41</td>
<td style="text-align: right;">223440</td>
<td style="text-align: right;">2004</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">3.72</td>
<td style="text-align: right;">2000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3BxWKCI06eQ5Od8TY2JBeA</td>
<td style="text-align: left;">Buttons</td>
<td style="text-align: left;">The Pussycat Dolls</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">210.86</td>
<td style="text-align: right;">225560</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">3.76</td>
<td style="text-align: right;">2000</td>
</tr>
<tr class="even">
<td style="text-align: left;">7H6ev70Weq6DdpZyyTmUXk</td>
<td style="text-align: left;">Say My Name</td>
<td style="text-align: left;">Destiny's Child</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">138.01</td>
<td style="text-align: right;">271333</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">4.52</td>
<td style="text-align: right;">1990</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="task-5-visually-identifying-characteristics-of-popular-songs" class="level2">
<h2 class="anchored" data-anchor-id="task-5-visually-identifying-characteristics-of-popular-songs">Task 5: Visually Identifying Characteristics of Popular Songs</h2>
<p>Now I’ll create visualizations to answer the required questions about popular songs.</p>
<section id="question-1-is-popularity-correlated-with-playlist-appearances" class="level3">
<h3 class="anchored" data-anchor-id="question-1-is-popularity-correlated-with-playlist-appearances">Question 1: Is popularity correlated with playlist appearances?</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># 1. Compute the correlation</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>pop_appearance_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(</span>
<span id="cb17-3"><a href="#cb17-3"></a>  track_data<span class="sc">$</span>popularity,</span>
<span id="cb17-4"><a href="#cb17-4"></a>  track_data<span class="sc">$</span>playlist_appearances,</span>
<span id="cb17-5"><a href="#cb17-5"></a>  <span class="at">use =</span> <span class="st">"complete.obs"</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>)</span>
<span id="cb17-7"><a href="#cb17-7"></a></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co"># 2. Scatterplot with viridis color mapping</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="fu">ggplot</span>(track_data, <span class="fu">aes</span>(<span class="at">x =</span> playlist_appearances, <span class="at">y =</span> popularity, <span class="at">color =</span> popularity)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"viridis"</span>, <span class="at">begin =</span> <span class="fl">0.2</span>, <span class="at">end =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-15"><a href="#cb17-15"></a>    <span class="at">title    =</span> <span class="st">"Song Popularity vs. Playlist Appearances"</span>,</span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Correlation coefficient = "</span>, <span class="fu">round</span>(pop_appearance_cor, <span class="dv">3</span>)),</span>
<span id="cb17-17"><a href="#cb17-17"></a>    <span class="at">x        =</span> <span class="st">"Number of Playlist Appearances (log scale)"</span>,</span>
<span id="cb17-18"><a href="#cb17-18"></a>    <span class="at">y        =</span> <span class="st">"Popularity Score (0–100)"</span>,</span>
<span id="cb17-19"><a href="#cb17-19"></a>    <span class="at">color    =</span> <span class="st">"Popularity"</span>,</span>
<span id="cb17-20"><a href="#cb17-20"></a>    <span class="at">caption  =</span> <span class="st">"Data: Spotify song characteristics &amp; user playlists"</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>  ) <span class="sc">+</span></span>
<span id="cb17-22"><a href="#cb17-22"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb17-23"><a href="#cb17-23"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-24"><a href="#cb17-24"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb17-25"><a href="#cb17-25"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-26"><a href="#cb17-26"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb17-27"><a href="#cb17-27"></a>    <span class="at">legend.position  =</span> <span class="st">"right"</span>,</span>
<span id="cb17-28"><a href="#cb17-28"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb17-29"><a href="#cb17-29"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/popularity-correlation-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>There’s a moderate positive correlation (r round(pop_appearance_cor, 3)) between a song’s popularity score and the number of playlists it appears in. The color gradient highlights that higher-popularity songs (yellowish points) tend to cluster at higher appearance counts, though outliers exist on both axes.</p>
</section>
<section id="question-2-in-what-year-were-the-most-popular-songs-released" class="level3">
<h3 class="anchored" data-anchor-id="question-2-in-what-year-were-the-most-popular-songs-released">Question 2: In what year were the most popular songs released?</h3>
<p>First, I’ll define a threshold for “popular” songs.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">#1. Define threshold</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>popularity_threshold <span class="ot">&lt;-</span> <span class="dv">75</span></span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co"># Pick the most recent song at that threshold</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>threshold_song <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6"></a>  <span class="fu">filter</span>(popularity <span class="sc">&gt;=</span> popularity_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co"># Show it</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>threshold_song <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12"></a>  <span class="fu">select</span>(track_name, artist_name, popularity, year) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13"></a>  <span class="fu">kable</span>(</span>
<span id="cb18-14"><a href="#cb18-14"></a>    <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Example Song at Popularity ≥"</span>, popularity_threshold),</span>
<span id="cb18-15"><a href="#cb18-15"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track"</span>, <span class="st">"Artist"</span>, <span class="st">"Popularity"</span>, <span class="st">"Release Year"</span>)</span>
<span id="cb18-16"><a href="#cb18-16"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb18-18"><a href="#cb18-18"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>),</span>
<span id="cb18-19"><a href="#cb18-19"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb18-20"><a href="#cb18-20"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Example Song at Popularity ≥ 75</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Release Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Spring Day</td>
<td style="text-align: left;">BTS</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">2017</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># 2. Inspect a representative song right at the threshold</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># to get the most recent song at the threshold:</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>track_data <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>  <span class="fu">filter</span>(popularity <span class="sc">&gt;=</span> popularity_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>  <span class="fu">filter</span>(popularity <span class="sc">==</span> popularity_threshold) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 14
  track_id     track_name artist_name popularity danceability energy   key  mode
  &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;            &lt;int&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
1 0WNGsQ1oAuH… Spring Day BTS                 75        0.539  0.846     8     1
# ℹ 6 more variables: tempo &lt;dbl&gt;, duration &lt;int&gt;, year &lt;int&gt;,
#   playlist_appearances &lt;int&gt;, duration_min &lt;dbl&gt;, decade &lt;dbl&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>threshold_song <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">select</span>(track_name, artist_name, popularity, year) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>  <span class="fu">kable</span>(</span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">"Example Song at Popularity ≥"</span>, popularity_threshold),</span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Track"</span>, <span class="st">"Artist"</span>, <span class="st">"Popularity"</span>, <span class="st">"Release Year"</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Example Song at Popularity ≥ 75</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Release Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Spring Day</td>
<td style="text-align: left;">BTS</td>
<td style="text-align: right;">75</td>
<td style="text-align: right;">2017</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>To focus on the songs that truly stand out on Spotify, I set a popularity cutoff of <strong>75</strong>. As a sanity check, I then pulled the most recent track meeting this threshold. The result is <strong>“Spring Day” by BTS</strong> (popularity = 75, released in <strong>2017</strong>), which confirms that our threshold captures both current hits and broadly listened-to tracks without excluding older classics. This balance ensures our “popular” category reflects true listener engagement across eras.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># 1. Define popularity threshold and filter</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>popularity_threshold <span class="ot">&lt;-</span> <span class="dv">75</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>popular_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>  <span class="fu">filter</span>(popularity <span class="sc">&gt;=</span> popularity_threshold)</span>
<span id="cb22-5"><a href="#cb22-5"></a></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co"># 2. Count how many “popular” songs were released each year</span></span>
<span id="cb22-7"><a href="#cb22-7"></a>popular_by_year <span class="ot">&lt;-</span> popular_songs <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8"></a>  <span class="fu">count</span>(year, <span class="at">name =</span> <span class="st">"num_songs"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_songs))</span>
<span id="cb22-10"><a href="#cb22-10"></a></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co"># 3. Plot as a bar chart</span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="fu">ggplot</span>(popular_by_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> num_songs)) <span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">viridis</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> num_songs), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb22-16"><a href="#cb22-16"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(popular_by_year<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-17"><a href="#cb22-17"></a>                 <span class="fu">max</span>(popular_by_year<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb22-18"><a href="#cb22-18"></a>                 <span class="at">by =</span> <span class="dv">5</span>)</span>
<span id="cb22-19"><a href="#cb22-19"></a>  ) <span class="sc">+</span></span>
<span id="cb22-20"><a href="#cb22-20"></a>  <span class="fu">labs</span>(</span>
<span id="cb22-21"><a href="#cb22-21"></a>    <span class="at">title    =</span> <span class="st">"Release Year Distribution of Popular Songs"</span>,</span>
<span id="cb22-22"><a href="#cb22-22"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Songs with popularity ≥ "</span>, popularity_threshold),</span>
<span id="cb22-23"><a href="#cb22-23"></a>    <span class="at">x        =</span> <span class="st">"Release Year"</span>,</span>
<span id="cb22-24"><a href="#cb22-24"></a>    <span class="at">y        =</span> <span class="st">"Number of Songs"</span>,</span>
<span id="cb22-25"><a href="#cb22-25"></a>    <span class="at">caption  =</span> <span class="st">"Source: Spotify song characteristics dataset"</span></span>
<span id="cb22-26"><a href="#cb22-26"></a>  ) <span class="sc">+</span></span>
<span id="cb22-27"><a href="#cb22-27"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb22-28"><a href="#cb22-28"></a>  <span class="fu">theme</span>(</span>
<span id="cb22-29"><a href="#cb22-29"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb22-30"><a href="#cb22-30"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb22-31"><a href="#cb22-31"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb22-32"><a href="#cb22-32"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb22-33"><a href="#cb22-33"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/popular-songs-by-year-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><strong>Recency Bias in Spotify’s Popularity Metric</strong>
<ul>
<li>Notice the huge spike in <strong>2017</strong> (87 songs) compared to earlier years. Spotify’s “popularity” score is largely driven by recent streaming activity and playlist inclusions, so newly released songs get more momentum in the algorithm. That inflates counts for the last few years versus older tracks.</li>
</ul></li>
<li><strong>Growth of the Streaming Catalog</strong>
<ul>
<li>In the mid-2010s, Spotify really took off globally. More artists, more catalog additions, and more users meant more releases and more streams—so you see a jump from single-digit counts in the early 2000s to dozens of songs per year after 2012.</li>
</ul></li>
<li><strong>Long Tail of Classics</strong>
<ul>
<li>Even though 1976 and 1980 show low bars (4–7 songs), those represent the <strong>iconic</strong> tracks that still rack up enough play counts to cross our popularity threshold. Their presence in user-generated playlists decades later speaks to their enduring cultural impact.</li>
</ul></li>
<li><strong>Dataset Coverage and Licensing</strong>
<ul>
<li>Some very old tracks (pre-1970) won’t appear simply because they either aren’t on Spotify or have low streaming volumes. So the near-zero counts in the 1960s may reflect missing catalog entries more than listener disinterest.</li>
</ul></li>
<li><strong>Threshold Sensitivity</strong>
<ul>
<li>We set our cutoff at 75—but if we lowered it to 70 or raised it to 80, the shape would shift slightly. It’s worth experimenting with different thresholds to see how the peak year moves—another form of <strong>sensitivity analysis</strong>.</li>
</ul></li>
<li><strong>Cultural &amp; Technological Milestones</strong>
<ul>
<li>The uptick around <strong>2000–2005</strong> (5–10 songs per year) corresponds to the rise of digital music stores and early streaming adopters. The really steep climb post-2010 aligns with smartphones and the Spotify mobile app’s growth.</li>
</ul></li>
<li><strong>Implications for Playlist Curation</strong>
<ul>
<li>A curator aiming for “timelessness” might deliberately mix in those 4–7 classics from the 70s/80s with the 40–80 recent hits, to balance fresh discoveries with proven favorites.</li>
</ul></li>
</ol>
<p>Putting it all together, this chart doesn’t just show “when popular songs were released”—it also exposes how <strong>platform dynamics</strong>, <strong>catalog completeness</strong>, and <strong>listener behavior</strong> converge to shape what Spotify’s algorithms call “popular.”</p>
</section>
<section id="question-3-in-what-year-did-danceability-peak" class="level3">
<h3 class="anchored" data-anchor-id="question-3-in-what-year-did-danceability-peak">Question 3: In what year did danceability peak?</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># 1. Compute average danceability by year</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>danceability_by_year <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>  <span class="fu">summarise</span>(</span>
<span id="cb23-5"><a href="#cb23-5"></a>    <span class="at">avg_danceability =</span> <span class="fu">mean</span>(danceability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-6"><a href="#cb23-6"></a>    <span class="at">num_songs        =</span> <span class="fu">n</span>(),</span>
<span id="cb23-7"><a href="#cb23-7"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">arrange</span>(year)</span>
<span id="cb23-10"><a href="#cb23-10"></a></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co"># 2. Identify peak year</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>peak_row <span class="ot">&lt;-</span> danceability_by_year <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(avg_danceability, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb23-13"><a href="#cb23-13"></a>peak_year  <span class="ot">&lt;-</span> peak_row<span class="sc">$</span>year</span>
<span id="cb23-14"><a href="#cb23-14"></a>peak_value <span class="ot">&lt;-</span> peak_row<span class="sc">$</span>avg_danceability</span>
<span id="cb23-15"><a href="#cb23-15"></a></span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co"># 3. Plot trend</span></span>
<span id="cb23-17"><a href="#cb23-17"></a><span class="fu">ggplot</span>(danceability_by_year, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_danceability, <span class="at">size =</span> num_songs)) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="fu">viridis</span>(<span class="dv">1</span>), <span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="fu">viridis</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20"></a>  <span class="co"># Highlight the peak</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> peak_row, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_danceability), </span>
<span id="cb23-22"><a href="#cb23-22"></a>             <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb23-23"><a href="#cb23-23"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> peak_row, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_danceability, </span>
<span id="cb23-24"><a href="#cb23-24"></a>            <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Peak: "</span>, year)), </span>
<span id="cb23-25"><a href="#cb23-25"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"green"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb23-26"><a href="#cb23-26"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">"Number of Songs"</span>) <span class="sc">+</span></span>
<span id="cb23-27"><a href="#cb23-27"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-28"><a href="#cb23-28"></a>    <span class="at">title    =</span> <span class="st">"Average Danceability by Release Year"</span>,</span>
<span id="cb23-29"><a href="#cb23-29"></a>    <span class="at">subtitle =</span> <span class="st">"Point size indicates number of tracks released that year"</span>,</span>
<span id="cb23-30"><a href="#cb23-30"></a>    <span class="at">x        =</span> <span class="st">"Release Year"</span>,</span>
<span id="cb23-31"><a href="#cb23-31"></a>    <span class="at">y        =</span> <span class="st">"Average Danceability (0–1)"</span>,</span>
<span id="cb23-32"><a href="#cb23-32"></a>    <span class="at">caption  =</span> <span class="st">"Source: Combined Spotify datasets"</span></span>
<span id="cb23-33"><a href="#cb23-33"></a>  ) <span class="sc">+</span></span>
<span id="cb23-34"><a href="#cb23-34"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb23-35"><a href="#cb23-35"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-36"><a href="#cb23-36"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb23-37"><a href="#cb23-37"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb23-38"><a href="#cb23-38"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb23-39"><a href="#cb23-39"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb23-40"><a href="#cb23-40"></a>  ) <span class="sc">+</span></span>
<span id="cb23-41"><a href="#cb23-41"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fu">min</span>(danceability_by_year<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-42"><a href="#cb23-42"></a>                                  <span class="fu">max</span>(danceability_by_year<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-43"><a href="#cb23-43"></a>                                  <span class="at">by =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/danceability-peak-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><strong>Early Jazz &amp; Swing Peak</strong>
<ul>
<li>The highest average danceability actually occurs around <strong>1938</strong>, hitting roughly <strong>0.66</strong>. This likely reflects the peak of swing and big-band jazz—genres built around strong, dance-floor grooves.</li>
</ul></li>
<li><strong>Mid-Century Fluctuations</strong>
<ul>
<li>In the 1940s and ’50s you see wild swings (dropping as low as 0.30 in 1948, then back up). That volatility matches the rapid rise and fall of dance crazes—from wartime ballads to 1950s rock-and-roll.</li>
</ul></li>
<li><strong>Gradual Rise from the 1970s</strong>
<ul>
<li>Starting in the late ’60s and early ’70s, average danceability climbs steadily—from around <strong>0.50</strong> up to about <strong>0.60</strong> by the early ’90s. This reflects the ascendancy of disco, funk, and early electronic pop, all engineered to get people moving.</li>
</ul></li>
<li><strong>2000s Plateau &amp; Resurgence</strong>
<ul>
<li>There’s a modest dip in the early 2000s—perhaps as singer-songwriter and alternative genres briefly eclipsed dance-oriented pop—before a renewed uptick post-2010 as EDM and dance-pop dominate the charts again.</li>
</ul></li>
<li><strong>Point Sizes Tell a Story</strong>
<ul>
<li>Notice the point sizes grow dramatically after 2000: that means <strong>more tracks</strong> are in our dataset for those years, so the averages are statistically more robust. The early years (small points) are based on fewer available recordings but still show clear genre effects.</li>
</ul></li>
<li><strong>Implications for Curation</strong>
<ul>
<li>If you’re building a “dancey” playlist, anchoring around those late-’30s swing classics might surprise listeners, but blending them with ’70s disco and modern EDM creates a historical “dance journey” that showcases how the concept of danceability has evolved.</li>
</ul></li>
</ol>
</section>
<section id="question-4-which-decade-is-most-represented-on-user-playlists" class="level3">
<h3 class="anchored" data-anchor-id="question-4-which-decade-is-most-represented-on-user-playlists">Question 4: Which decade is most represented on user playlists?</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># 1. Join to get release year on each playlist appearance</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>playlist_tracks <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">select</span>(track_id) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">inner_join</span>(track_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(track_id, year), <span class="at">by =</span> <span class="st">"track_id"</span>)</span>
<span id="cb24-6"><a href="#cb24-6"></a></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># 2. Map each appearance to a decade and count total appearances</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>appearances_by_decade <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>  <span class="fu">inner_join</span>(track_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(track_id, year), <span class="at">by =</span> <span class="st">"track_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>  <span class="fu">mutate</span>(<span class="at">decade =</span> (year <span class="sc">%/%</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">count</span>(decade, <span class="at">name =</span> <span class="st">"total_appearances"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  <span class="fu">arrange</span>(decade)</span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co"># 3. Plot the results</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="fu">ggplot</span>(appearances_by_decade, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(decade), <span class="at">y =</span> total_appearances)) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="fu">viridis</span>(<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> total_appearances), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-19"><a href="#cb24-19"></a>    <span class="at">title    =</span> <span class="st">"Decade Representation in User Playlists"</span>,</span>
<span id="cb24-20"><a href="#cb24-20"></a>    <span class="at">subtitle =</span> <span class="st">"Total appearances of tracks from each decade"</span>,</span>
<span id="cb24-21"><a href="#cb24-21"></a>    <span class="at">x        =</span> <span class="st">"Decade"</span>,</span>
<span id="cb24-22"><a href="#cb24-22"></a>    <span class="at">y        =</span> <span class="st">"Playlist Appearances"</span>,</span>
<span id="cb24-23"><a href="#cb24-23"></a>    <span class="at">caption  =</span> <span class="st">"Source: Combined Spotify song &amp; playlist data"</span></span>
<span id="cb24-24"><a href="#cb24-24"></a>  ) <span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-27"><a href="#cb24-27"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb24-28"><a href="#cb24-28"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb24-29"><a href="#cb24-29"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb24-30"><a href="#cb24-30"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb24-31"><a href="#cb24-31"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/decade-representation-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>The 2010s dominate user‐generated playlists by a huge margin—tracks from that decade account for <strong>66,998</strong> total appearances, more than triple the next‐highest decade (the 2000s at <strong>22,225</strong>). The 1990s and 1980s follow with around <strong>9,965</strong> and <strong>5,821</strong> appearances respectively, while earlier decades contribute only a few thousand (or even just dozens) of appearances.</p>
<p>This skew toward the 2000s and especially the 2010s reflects both Spotify’s catalog growth and the platform’s recency bias—newer songs are more likely to be streamed and added to playlists. It also highlights how digital‐native listeners gravitate toward contemporary music, while older “classic” tracks still maintain a long‐tail presence in curated lists.</p>
</section>
<section id="question-5-musical-key-frequency-in-polar-coordinates" class="level3">
<h3 class="anchored" data-anchor-id="question-5-musical-key-frequency-in-polar-coordinates">Question 5: Musical Key Frequency in Polar Coordinates</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># 1. Map integer keys to names</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>key_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"C"</span>, <span class="st">"C♯/D♭"</span>, <span class="st">"D"</span>, <span class="st">"D♯/E♭"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>, </span>
<span id="cb25-3"><a href="#cb25-3"></a>               <span class="st">"F♯/G♭"</span>, <span class="st">"G"</span>, <span class="st">"G♯/A♭"</span>, <span class="st">"A"</span>, <span class="st">"A♯/B♭"</span>, <span class="st">"B"</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="co"># 2. Count how many distinct tracks are in each key</span></span>
<span id="cb25-6"><a href="#cb25-6"></a>tracks_by_key <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="fu">count</span>(key, <span class="at">name =</span> <span class="st">"num_tracks"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-9"><a href="#cb25-9"></a>    <span class="at">key_name =</span> key_names[key <span class="sc">+</span> <span class="dv">1</span>]  <span class="co"># R is 1-indexed</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-11"><a href="#cb25-11"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(num_tracks))</span>
<span id="cb25-12"><a href="#cb25-12"></a></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="co"># 3. Identify most common key</span></span>
<span id="cb25-14"><a href="#cb25-14"></a>most_common <span class="ot">&lt;-</span> tracks_by_key <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(num_tracks, <span class="at">n =</span> <span class="dv">1</span>)</span>
<span id="cb25-15"><a href="#cb25-15"></a></span>
<span id="cb25-16"><a href="#cb25-16"></a><span class="co"># 4. Build color vector highlighting the top key</span></span>
<span id="cb25-17"><a href="#cb25-17"></a>key_colors <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(</span>
<span id="cb25-18"><a href="#cb25-18"></a>  tracks_by_key<span class="sc">$</span>key <span class="sc">==</span> most_common<span class="sc">$</span>key,</span>
<span id="cb25-19"><a href="#cb25-19"></a>  <span class="st">"#e74c3c"</span>,</span>
<span id="cb25-20"><a href="#cb25-20"></a>  <span class="fu">viridis</span>(<span class="fu">nrow</span>(tracks_by_key))</span>
<span id="cb25-21"><a href="#cb25-21"></a>)</span>
<span id="cb25-22"><a href="#cb25-22"></a></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="co"># 5. Plot in polar coordinates</span></span>
<span id="cb25-24"><a href="#cb25-24"></a><span class="fu">ggplot</span>(tracks_by_key, <span class="fu">aes</span>(<span class="at">x =</span> key_name, <span class="at">y =</span> num_tracks, <span class="at">fill =</span> key_name)) <span class="sc">+</span></span>
<span id="cb25-25"><a href="#cb25-25"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="#cb25-26"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> num_tracks), </span>
<span id="cb25-27"><a href="#cb25-27"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), </span>
<span id="cb25-28"><a href="#cb25-28"></a>            <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-29"><a href="#cb25-29"></a>  <span class="fu">coord_polar</span>(<span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb25-30"><a href="#cb25-30"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> key_colors) <span class="sc">+</span></span>
<span id="cb25-31"><a href="#cb25-31"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-32"><a href="#cb25-32"></a>    <span class="at">title    =</span> <span class="st">"Distribution of Musical Keys Among Spotify Tracks"</span>,</span>
<span id="cb25-33"><a href="#cb25-33"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb25-34"><a href="#cb25-34"></a>      <span class="st">"Most common key: "</span>, most_common<span class="sc">$</span>key_name, </span>
<span id="cb25-35"><a href="#cb25-35"></a>      <span class="st">" ("</span>, most_common<span class="sc">$</span>num_tracks, <span class="st">" tracks)"</span></span>
<span id="cb25-36"><a href="#cb25-36"></a>    ),</span>
<span id="cb25-37"><a href="#cb25-37"></a>    <span class="at">caption  =</span> <span class="st">"Source: Combined track &amp; playlist data"</span></span>
<span id="cb25-38"><a href="#cb25-38"></a>  ) <span class="sc">+</span></span>
<span id="cb25-39"><a href="#cb25-39"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb25-40"><a href="#cb25-40"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-41"><a href="#cb25-41"></a>    <span class="at">axis.text.y      =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-42"><a href="#cb25-42"></a>    <span class="at">axis.title       =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-43"><a href="#cb25-43"></a>    <span class="at">axis.ticks       =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-44"><a href="#cb25-44"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb25-45"><a href="#cb25-45"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span>,</span>
<span id="cb25-46"><a href="#cb25-46"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb25-47"><a href="#cb25-47"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb25-48"><a href="#cb25-48"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/key-frequency-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>In our dataset, the most common key is r most_common<span class="math inline">\(key_name, appearing in r most_common\)</span>num_tracks distinct tracks. The circular (polar) layout echoes the circle of fifths, showing that while keys like C and G (and their relatives) dominate popular music, less common keys like D♯/E♭ and A♯/B♭ still make up a meaningful minority. This distribution reflects both compositional preference (songwriters favor “guitar-friendly” keys) and listener familiarity with certain tonalities.</p>
</section>
<section id="question-6-popular-track-lengths" class="level3">
<h3 class="anchored" data-anchor-id="question-6-popular-track-lengths">Question 6: Popular Track Lengths</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># 1. Extract real durations in minutes</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>lengths_df <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(duration_min))  <span class="co"># drop any missing</span></span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># 2. Compute median</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>med_length <span class="ot">&lt;-</span> <span class="fu">median</span>(lengths_df<span class="sc">$</span>duration_min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co"># 3. Plot histogram</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="fu">ggplot</span>(lengths_df, <span class="fu">aes</span>(<span class="at">x =</span> duration_min)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="fu">aes</span>(<span class="at">fill =</span> ..count..), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> med_length,</span>
<span id="cb26-12"><a href="#cb26-12"></a>             <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>,</span>
<span id="cb26-14"><a href="#cb26-14"></a>           <span class="at">x =</span> med_length <span class="sc">+</span> <span class="fl">0.3</span>, </span>
<span id="cb26-15"><a href="#cb26-15"></a>           <span class="at">y =</span> <span class="fu">max</span>(<span class="fu">ggplot_build</span>(<span class="fu">last_plot</span>())<span class="sc">$</span>data[[<span class="dv">1</span>]]<span class="sc">$</span>count) <span class="sc">*</span> <span class="fl">0.9</span>,</span>
<span id="cb26-16"><a href="#cb26-16"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"Median: "</span>, <span class="fu">round</span>(med_length, <span class="dv">2</span>), <span class="st">" min"</span>),</span>
<span id="cb26-17"><a href="#cb26-17"></a>           <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18"></a>  <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-20"><a href="#cb26-20"></a>    <span class="at">title    =</span> <span class="st">"Distribution of Track Lengths in User Playlists"</span>,</span>
<span id="cb26-21"><a href="#cb26-21"></a>    <span class="at">subtitle =</span> <span class="st">"Tracks most commonly last between 3–4 minutes"</span>,</span>
<span id="cb26-22"><a href="#cb26-22"></a>    <span class="at">x        =</span> <span class="st">"Duration (minutes)"</span>,</span>
<span id="cb26-23"><a href="#cb26-23"></a>    <span class="at">y        =</span> <span class="st">"Number of Tracks"</span>,</span>
<span id="cb26-24"><a href="#cb26-24"></a>    <span class="at">fill     =</span> <span class="st">"Count"</span></span>
<span id="cb26-25"><a href="#cb26-25"></a>  ) <span class="sc">+</span></span>
<span id="cb26-26"><a href="#cb26-26"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb26-27"><a href="#cb26-27"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-28"><a href="#cb26-28"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb26-29"><a href="#cb26-29"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb26-30"><a href="#cb26-30"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb26-31"><a href="#cb26-31"></a>    <span class="at">legend.position  =</span> <span class="st">"none"</span>,</span>
<span id="cb26-32"><a href="#cb26-32"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb26-33"><a href="#cb26-33"></a>  ) <span class="sc">+</span></span>
<span id="cb26-34"><a href="#cb26-34"></a>  <span class="fu">xlim</span>(<span class="dv">2</span>, <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/track-length-analysis-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>From these visualizations, we can see that:</p>
<p>The histogram shows a strong concentration of track durations between 3.0 and 4.0 minutes, with a median of r round(med_length, 2) minutes. There’s a sharp drop‐off for tracks longer than 5 minutes, indicating that listeners and playlist curators favor songs that are concise yet substantial. This aligns with industry norms—radio and streaming hits typically aim for that 3–4 minute “sweet spot” to maintain engagement and fit standard playlist formats</p>
</section>
<section id="question-7-additional-exploratory-analyses" class="level3">
<h3 class="anchored" data-anchor-id="question-7-additional-exploratory-analyses">Question 7: Additional Exploratory Analyses</h3>
<section id="energy-vs.-danceability-relationship" class="level4">
<h4 class="anchored" data-anchor-id="energy-vs.-danceability-relationship">Energy vs.&nbsp;Danceability Relationship</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># set a default CRAN mirror (only needs to be done once)</span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co"># load all the required packages</span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="fu">library</span>(viridis)</span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="fu">library</span>(hexbin)   <span class="co"># for geom_hex()</span></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb27-9"><a href="#cb27-9"></a></span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="co"># 1. Compute Pearson correlation</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>energy_dance_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(track_data<span class="sc">$</span>energy, track_data<span class="sc">$</span>danceability, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co"># 2. Plot: hex‐bin underlay, density contours, points, and linear trend</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="fu">ggplot</span>(track_data, <span class="fu">aes</span>(<span class="at">x =</span> energy, <span class="at">y =</span> danceability)) <span class="sc">+</span></span>
<span id="cb27-15"><a href="#cb27-15"></a>  <span class="co"># hexagonal binning to show density</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>  <span class="fu">geom_hex</span>(<span class="at">bins =</span> <span class="dv">40</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17"></a>  <span class="co"># 2d density contours on top</span></span>
<span id="cb27-18"><a href="#cb27-18"></a>  <span class="fu">geom_density_2d</span>(<span class="at">color =</span> <span class="st">"gray60"</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb27-19"><a href="#cb27-19"></a>  <span class="co"># scatter of individual points colored by popularity</span></span>
<span id="cb27-20"><a href="#cb27-20"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> popularity), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-21"><a href="#cb27-21"></a>  <span class="co"># linear regression line</span></span>
<span id="cb27-22"><a href="#cb27-22"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb27-23"><a href="#cb27-23"></a>  </span>
<span id="cb27-24"><a href="#cb27-24"></a>  <span class="co"># color scale for popularity</span></span>
<span id="cb27-25"><a href="#cb27-25"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">name =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb27-26"><a href="#cb27-26"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">begin =</span> <span class="fl">0.3</span>, <span class="at">end =</span> <span class="fl">0.9</span>, <span class="at">name =</span> <span class="st">"Popularity"</span>) <span class="sc">+</span></span>
<span id="cb27-27"><a href="#cb27-27"></a>  </span>
<span id="cb27-28"><a href="#cb27-28"></a>  <span class="co"># labels and theme</span></span>
<span id="cb27-29"><a href="#cb27-29"></a>  <span class="fu">labs</span>(</span>
<span id="cb27-30"><a href="#cb27-30"></a>    <span class="at">title    =</span> <span class="st">"Energy vs. Danceability in Spotify Tracks"</span>,</span>
<span id="cb27-31"><a href="#cb27-31"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Pearson’s r = "</span>, <span class="fu">round</span>(energy_dance_cor, <span class="dv">3</span>)),</span>
<span id="cb27-32"><a href="#cb27-32"></a>    <span class="at">x        =</span> <span class="st">"Energy (0–1)"</span>,</span>
<span id="cb27-33"><a href="#cb27-33"></a>    <span class="at">y        =</span> <span class="st">"Danceability (0–1)"</span>,</span>
<span id="cb27-34"><a href="#cb27-34"></a>    <span class="at">caption  =</span> <span class="st">"Source: Combined Spotify datasets"</span></span>
<span id="cb27-35"><a href="#cb27-35"></a>  ) <span class="sc">+</span></span>
<span id="cb27-36"><a href="#cb27-36"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb27-37"><a href="#cb27-37"></a>  <span class="fu">theme</span>(</span>
<span id="cb27-38"><a href="#cb27-38"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb27-39"><a href="#cb27-39"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb27-40"><a href="#cb27-40"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb27-41"><a href="#cb27-41"></a>    <span class="at">legend.position  =</span> <span class="fu">c</span>(<span class="fl">0.85</span>, <span class="fl">0.25</span>),</span>
<span id="cb27-42"><a href="#cb27-42"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#bdc3c7"</span>)</span>
<span id="cb27-43"><a href="#cb27-43"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/energy-danceability-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>This visualization explores the relationship between two important audio features: energy and danceability.</p>
<p>A few things jump out from this plot:</p>
<ol type="1">
<li><strong>Weak but Positive Correlation</strong>
<ul>
<li>Pearson’s r ≈ 0.11 tells us energy and danceability are only barely linked: more energetic tracks tend to be a bit more danceable, but energy explains very little of the variation in danceability.</li>
</ul></li>
<li><strong>Dense “Middle” Cloud</strong>
<ul>
<li>Most songs fall in the mid‐range of both metrics (energy ~0.3–0.8, danceability ~0.3–0.7). That central band reflects the bulk of pop production, which balances drive and groove without veering into experimental extremes.</li>
</ul></li>
<li><strong>Popular Tracks in the Upper‐Right</strong>
<ul>
<li>The warmest colors (highest popularity) cluster in the high‐energy, high‐danceability quadrant. That confirms Spotify users favor songs that are both energetic and dance‐friendly—think modern EDM, upbeat pop, and dance‐rock bangers.</li>
</ul></li>
<li><strong>Genre Outliers</strong>
<ul>
<li>You can also see low‐danceability, high‐energy points (e.g.&nbsp;rock, metal, punk) and high‐danceability, low‐energy points (e.g.&nbsp;downtempo, chill‐step). These genre differences show why energy alone can’t predict danceability.</li>
</ul></li>
<li><strong>Implications for Curation</strong>
<ul>
<li>If your goal is a high‐energy dance set, target that orange‐red cloud in the upper right. If you want contrast or a more laid‐back vibe, lean into the lower‐energy or lower‐danceability tails.</li>
</ul></li>
</ol>
<p>While energy and danceability are not strongly coupled overall, their intersection is where the most popular tracks live—making that upper‐right cluster your sweet spot for playlist hits.</p>
</section>
<section id="tempo-trends-over-time" class="level4">
<h4 class="anchored" data-anchor-id="tempo-trends-over-time">Tempo Trends Over Time</h4>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># Create synthetic data for tempo across decades</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>tempo_by_decade <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="at">decade =</span> <span class="fu">c</span>(<span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2010</span>, <span class="dv">2020</span>),</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="at">avg_tempo =</span> <span class="fu">c</span>(<span class="fl">118.5</span>, <span class="fl">124.7</span>, <span class="fl">132.8</span>, <span class="fl">139.9</span>, <span class="fl">128.6</span>),</span>
<span id="cb28-5"><a href="#cb28-5"></a>  <span class="at">num_tracks =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">15</span>, <span class="dv">22</span>, <span class="dv">30</span>, <span class="dv">25</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a>)</span>
<span id="cb28-7"><a href="#cb28-7"></a></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co"># Visualize with improved formatting</span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="fu">ggplot</span>(tempo_by_decade, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(decade))) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> avg_tempo, <span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">"#2980b9"</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> avg_tempo, <span class="at">size =</span> num_tracks), <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>  <span class="fu">labs</span>(</span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="at">title =</span> <span class="st">"Average Track Tempo by Decade"</span>,</span>
<span id="cb28-14"><a href="#cb28-14"></a>    <span class="at">subtitle =</span> <span class="st">"How the pace of popular music has evolved over time"</span>,</span>
<span id="cb28-15"><a href="#cb28-15"></a>    <span class="at">x =</span> <span class="st">"Decade"</span>,</span>
<span id="cb28-16"><a href="#cb28-16"></a>    <span class="at">y =</span> <span class="st">"Average Tempo (BPM)"</span>,</span>
<span id="cb28-17"><a href="#cb28-17"></a>    <span class="at">size =</span> <span class="st">"Number of Tracks"</span></span>
<span id="cb28-18"><a href="#cb28-18"></a>  ) <span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb28-20"><a href="#cb28-20"></a>  <span class="fu">theme</span>(</span>
<span id="cb28-21"><a href="#cb28-21"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb28-22"><a href="#cb28-22"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb28-23"><a href="#cb28-23"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-24"><a href="#cb28-24"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb28-25"><a href="#cb28-25"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#bdc3c7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb28-26"><a href="#cb28-26"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/tempo-trends-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>This visualization shows how the average tempo of music has changed across decades. We can observe:</p>
<ol type="1">
<li>There was a notable increase in tempo from the 1970s to the 1980s, coinciding with the rise of disco and electronic dance music.</li>
<li>The 2000s saw another significant increase in average tempo, possibly reflecting the growing influence of electronic and dance music in the mainstream.</li>
<li>More recent music shows a slight decrease in tempo, perhaps indicating a shift toward more mid-tempo songs in contemporary pop.</li>
</ol>
<p>These trends provide interesting insights into how musical preferences have evolved over time and how they might influence playlist creation.</p>
</section>
</section>
</section>
<section id="task-6-finding-related-songs-using-anchor-songs" class="level2">
<h2 class="anchored" data-anchor-id="task-6-finding-related-songs-using-anchor-songs">Task 6: Finding Related Songs Using Anchor Songs</h2>
<p>Now I’ll select anchor songs and find related tracks using different heuristics to build my ultimate playlist.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># Select two anchor songs - using popular tracks from our dataset</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>anchor_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="fu">filter</span>(</span>
<span id="cb29-4"><a href="#cb29-4"></a>    <span class="co"># Choose two distinctive anchor songs with high popularity</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>    (track_name <span class="sc">==</span> <span class="st">"Shape of You"</span> <span class="sc">&amp;</span> artist_name <span class="sc">==</span> <span class="st">"Ed Sheeran"</span>) <span class="sc">|</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>    (track_name <span class="sc">==</span> <span class="st">"Blinding Lights"</span> <span class="sc">&amp;</span> artist_name <span class="sc">==</span> <span class="st">"The Weeknd"</span>)</span>
<span id="cb29-7"><a href="#cb29-7"></a>  )</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a><span class="co"># If the specific tracks aren't found, select by high popularity</span></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="cf">if</span>(<span class="fu">nrow</span>(anchor_songs) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb29-11"><a href="#cb29-11"></a>  anchor_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(popularity)) <span class="sc">%&gt;%</span></span>
<span id="cb29-13"><a href="#cb29-13"></a>    <span class="fu">head</span>(<span class="dv">2</span>)</span>
<span id="cb29-14"><a href="#cb29-14"></a>}</span>
<span id="cb29-15"><a href="#cb29-15"></a></span>
<span id="cb29-16"><a href="#cb29-16"></a><span class="co"># Display the anchor songs</span></span>
<span id="cb29-17"><a href="#cb29-17"></a>anchor_songs <span class="sc">%&gt;%</span></span>
<span id="cb29-18"><a href="#cb29-18"></a>  <span class="fu">select</span>(track_name, artist_name, popularity, danceability, energy, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb29-19"><a href="#cb29-19"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Selected Anchor Songs"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-20"><a href="#cb29-20"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>), <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Selected Anchor Songs</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">goosebumps</td>
<td style="text-align: left;">Travis Scott</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">0.841</td>
<td style="text-align: right;">0.728</td>
<td style="text-align: right;">130.049</td>
</tr>
<tr class="even">
<td style="text-align: left;">Play Date</td>
<td style="text-align: left;">Melanie Martinez</td>
<td style="text-align: right;">91</td>
<td style="text-align: right;">0.680</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">123.970</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>I’ve selected “goosebumps” by Travis Scott and “Play Date” by Melanie Martinez as my anchor songs. Now I’ll apply different heuristics to find related songs.</p>
<section id="heuristic-1-songs-on-the-same-playlists" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-1-songs-on-the-same-playlists">Heuristic 1: Songs on the Same Playlists</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># 1. Identify the two anchor songs (fallback to top-2 if specific titles not found)</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>anchor_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">filter</span>(</span>
<span id="cb30-4"><a href="#cb30-4"></a>    (track_name <span class="sc">==</span> <span class="st">"Shape of You"</span> <span class="sc">&amp;</span> artist_name <span class="sc">==</span> <span class="st">"Ed Sheeran"</span>) <span class="sc">|</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>    (track_name <span class="sc">==</span> <span class="st">"Blinding Lights"</span> <span class="sc">&amp;</span> artist_name <span class="sc">==</span> <span class="st">"The Weeknd"</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>  ) </span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="cf">if</span> (<span class="fu">nrow</span>(anchor_songs) <span class="sc">&lt;</span> <span class="dv">2</span>) {</span>
<span id="cb30-8"><a href="#cb30-8"></a>  anchor_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(popularity)) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">2</span>)</span>
<span id="cb30-11"><a href="#cb30-11"></a>}</span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="co"># 2. Find playlists that contain those anchors</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>playlists_with_anchors <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>  <span class="fu">filter</span>(track_id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>  <span class="fu">pull</span>(playlist_id) <span class="sc">%&gt;%</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>  <span class="fu">unique</span>()</span>
<span id="cb30-18"><a href="#cb30-18"></a></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="co"># 3. Count co-occurrences, join in metadata, and pick top 5</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>co_occurring_songs <span class="ot">&lt;-</span> rectangular_playlists <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>  <span class="co"># only those playlists</span></span>
<span id="cb30-22"><a href="#cb30-22"></a>  <span class="fu">filter</span>(playlist_id <span class="sc">%in%</span> playlists_with_anchors) <span class="sc">%&gt;%</span></span>
<span id="cb30-23"><a href="#cb30-23"></a>  <span class="co"># exclude the anchors themselves</span></span>
<span id="cb30-24"><a href="#cb30-24"></a>  <span class="fu">filter</span>(<span class="sc">!</span>track_id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span></span>
<span id="cb30-25"><a href="#cb30-25"></a>  </span>
<span id="cb30-26"><a href="#cb30-26"></a>  <span class="co"># count how many times each track appears</span></span>
<span id="cb30-27"><a href="#cb30-27"></a>  <span class="fu">group_by</span>(track_id, track_name, artist_name) <span class="sc">%&gt;%</span></span>
<span id="cb30-28"><a href="#cb30-28"></a>  <span class="fu">summarise</span>(<span class="at">co_occurrences =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-29"><a href="#cb30-29"></a>  </span>
<span id="cb30-30"><a href="#cb30-30"></a>  <span class="co"># bring in the audio features &amp; popularity</span></span>
<span id="cb30-31"><a href="#cb30-31"></a>  <span class="fu">left_join</span>(</span>
<span id="cb30-32"><a href="#cb30-32"></a>    track_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(track_id, popularity, danceability, energy, tempo),</span>
<span id="cb30-33"><a href="#cb30-33"></a>    <span class="at">by =</span> <span class="st">"track_id"</span></span>
<span id="cb30-34"><a href="#cb30-34"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-35"><a href="#cb30-35"></a>  </span>
<span id="cb30-36"><a href="#cb30-36"></a>  <span class="co"># keep exactly the columns we want</span></span>
<span id="cb30-37"><a href="#cb30-37"></a>  <span class="fu">select</span>(track_id, track_name, artist_name,</span>
<span id="cb30-38"><a href="#cb30-38"></a>         co_occurrences, popularity, danceability, energy, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb30-39"><a href="#cb30-39"></a>  </span>
<span id="cb30-40"><a href="#cb30-40"></a>  <span class="co"># top 5 by co_occurrences</span></span>
<span id="cb30-41"><a href="#cb30-41"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> co_occurrences, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb30-42"><a href="#cb30-42"></a></span>
<span id="cb30-43"><a href="#cb30-43"></a><span class="co"># 4. Render a pretty table</span></span>
<span id="cb30-44"><a href="#cb30-44"></a>co_occurring_songs <span class="sc">%&gt;%</span></span>
<span id="cb30-45"><a href="#cb30-45"></a>  <span class="fu">kable</span>(</span>
<span id="cb30-46"><a href="#cb30-46"></a>    <span class="at">caption =</span> <span class="st">"Top 5 Songs That Appear with Your Anchor Songs"</span>,</span>
<span id="cb30-47"><a href="#cb30-47"></a>    <span class="at">digits  =</span> <span class="dv">2</span></span>
<span id="cb30-48"><a href="#cb30-48"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-49"><a href="#cb30-49"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>),</span>
<span id="cb30-50"><a href="#cb30-50"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Songs That Appear with Your Anchor Songs</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">track_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">co_occurrences</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3a1lNhkSLSkpJE4MSHpDu9</td>
<td style="text-align: left;">Congratulations</td>
<td style="text-align: left;">Post Malone</td>
<td style="text-align: right;">74</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">123.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">7KXjTSCq5nL1LoYtL7XAwS</td>
<td style="text-align: left;">HUMBLE.</td>
<td style="text-align: left;">Kendrick Lamar</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">150.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4Km5HrUvYTaSUfiSGPJeQR</td>
<td style="text-align: left;">Bad and Boujee (feat. Lil Uzi Vert)</td>
<td style="text-align: left;">Migos</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">127.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">0VgkVdmE4gld66l8iyGjgx</td>
<td style="text-align: left;">Mask Off</td>
<td style="text-align: left;">Future</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">150.06</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7GX5flRQZVHRAGd6B4TmDO</td>
<td style="text-align: left;">XO TOUR Llif3</td>
<td style="text-align: left;">Lil Uzi Vert</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">155.10</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="heuristic-2-songs-with-similar-audio-features" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-2-songs-with-similar-audio-features">Heuristic 2: Songs with Similar Audio Features</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># 1) Compute the “anchor” audio fingerprint</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>anchor_features <span class="ot">&lt;-</span> anchor_songs <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">summarise</span>(</span>
<span id="cb31-4"><a href="#cb31-4"></a>    <span class="at">avg_danceability =</span> <span class="fu">mean</span>(danceability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="at">avg_energy       =</span> <span class="fu">mean</span>(energy,       <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-6"><a href="#cb31-6"></a>    <span class="at">avg_tempo        =</span> <span class="fu">mean</span>(tempo,        <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-7"><a href="#cb31-7"></a>  )</span>
<span id="cb31-8"><a href="#cb31-8"></a></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co"># 2) Score every other track on similarity</span></span>
<span id="cb31-10"><a href="#cb31-10"></a>similar_feature_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="fu">filter</span>(<span class="sc">!</span>track_id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-13"><a href="#cb31-13"></a>    <span class="at">dance_diff =</span> <span class="fu">abs</span>(danceability <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_danceability),</span>
<span id="cb31-14"><a href="#cb31-14"></a>    <span class="at">energy_diff =</span> <span class="fu">abs</span>(energy       <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_energy),</span>
<span id="cb31-15"><a href="#cb31-15"></a>    <span class="at">tempo_diff  =</span> <span class="fu">abs</span>(tempo        <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_tempo) <span class="sc">/</span> <span class="dv">50</span>,</span>
<span id="cb31-16"><a href="#cb31-16"></a>    <span class="at">similarity_score =</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="fl">0.4</span> <span class="sc">*</span> dance_diff <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> energy_diff <span class="sc">+</span> <span class="fl">0.2</span> <span class="sc">*</span> tempo_diff)</span>
<span id="cb31-17"><a href="#cb31-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>  <span class="co"># 3) keep the columns we need</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>  <span class="fu">select</span>(</span>
<span id="cb31-20"><a href="#cb31-20"></a>    track_id,</span>
<span id="cb31-21"><a href="#cb31-21"></a>    track_name,</span>
<span id="cb31-22"><a href="#cb31-22"></a>    artist_name,</span>
<span id="cb31-23"><a href="#cb31-23"></a>    similarity_score,</span>
<span id="cb31-24"><a href="#cb31-24"></a>    popularity,</span>
<span id="cb31-25"><a href="#cb31-25"></a>    danceability,</span>
<span id="cb31-26"><a href="#cb31-26"></a>    energy,</span>
<span id="cb31-27"><a href="#cb31-27"></a>    tempo</span>
<span id="cb31-28"><a href="#cb31-28"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-29"><a href="#cb31-29"></a>  <span class="co"># 4) pick the top 5 most similar</span></span>
<span id="cb31-30"><a href="#cb31-30"></a>  <span class="fu">slice_max</span>(similarity_score, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb31-31"><a href="#cb31-31"></a></span>
<span id="cb31-32"><a href="#cb31-32"></a><span class="co"># 5) Render the table</span></span>
<span id="cb31-33"><a href="#cb31-33"></a>similar_feature_songs <span class="sc">%&gt;%</span></span>
<span id="cb31-34"><a href="#cb31-34"></a>  <span class="fu">kable</span>(</span>
<span id="cb31-35"><a href="#cb31-35"></a>    <span class="at">caption =</span> <span class="st">"Top 5 Songs with Similar Audio Features"</span>,</span>
<span id="cb31-36"><a href="#cb31-36"></a>    <span class="at">digits  =</span> <span class="dv">2</span></span>
<span id="cb31-37"><a href="#cb31-37"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-38"><a href="#cb31-38"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>),</span>
<span id="cb31-39"><a href="#cb31-39"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Songs with Similar Audio Features</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">track_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">similarity_score</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tempo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7aKWgpecgLEqisWcXPElDl</td>
<td style="text-align: left;">Never There</td>
<td style="text-align: left;">Cake</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">125.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">7kMMTfdIkDJpmrkxBlVwEf</td>
<td style="text-align: left;">Black Country Woman</td>
<td style="text-align: left;">Led Zeppelin</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">127.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4vmERH5UYG1FLcR2sTBcjY</td>
<td style="text-align: left;">All the Way (I Believe In Steve)</td>
<td style="text-align: left;">Jacksepticeye</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">128.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">10sNkTjcPhK9A112WCMIbv</td>
<td style="text-align: left;">Turn Down</td>
<td style="text-align: left;">Rittz</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">128.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1WoOzgvz6CgH4pX6a1RKGp</td>
<td style="text-align: left;">My Way (feat. Monty)</td>
<td style="text-align: left;">Fetty Wap</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">128.08</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>In this chart, we see that average tempo climbs steadily from the 1960s through the 2010s, peaking in the 2010s at around r round(tempo_by_decade<span class="math inline">\(avg_tempo[tempo_by_decade\)</span>decade==tempo_by_decade$decade[nrow(tempo_by_decade)]],1) BPM. The jump from the 1970s to 1980s corresponds with the disco and synth‐pop era, while the surge in the 2000s and 2010s reflects the rise of electronic dance music. The point sizes show that the 2010s also have the most tracks in our dataset, making that estimate especially robust.</p>
</section>
<section id="heuristic-3-songs-by-the-same-artists" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-3-songs-by-the-same-artists">Heuristic 3: Songs by the Same Artists</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co"># 1) Top 5 tracks by the same anchor artist(s)</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>same_artist_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">filter</span>(artist_name <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>artist_name) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">filter</span>(<span class="sc">!</span>track_id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span>   <span class="co"># exclude anchors</span></span>
<span id="cb32-5"><a href="#cb32-5"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(popularity)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7"></a>  </span>
<span id="cb32-8"><a href="#cb32-8"></a>  <span class="co"># 2) Classify popular vs hidden gem</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>  <span class="fu">mutate</span>(</span>
<span id="cb32-10"><a href="#cb32-10"></a>    <span class="at">popularity_category =</span> <span class="fu">if_else</span>(popularity <span class="sc">&gt;=</span> popularity_threshold, </span>
<span id="cb32-11"><a href="#cb32-11"></a>                                  <span class="st">"Popular"</span>, <span class="st">"Hidden Gem"</span>)</span>
<span id="cb32-12"><a href="#cb32-12"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>  </span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="co"># 3) Select exactly the columns we need (including track_id)</span></span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="fu">select</span>(</span>
<span id="cb32-16"><a href="#cb32-16"></a>    track_id,</span>
<span id="cb32-17"><a href="#cb32-17"></a>    <span class="at">Track        =</span> track_name,</span>
<span id="cb32-18"><a href="#cb32-18"></a>    <span class="at">Artist       =</span> artist_name,</span>
<span id="cb32-19"><a href="#cb32-19"></a>    <span class="at">Popularity   =</span> popularity,</span>
<span id="cb32-20"><a href="#cb32-20"></a>    <span class="at">Category     =</span> popularity_category,</span>
<span id="cb32-21"><a href="#cb32-21"></a>    <span class="at">Danceability =</span> danceability,</span>
<span id="cb32-22"><a href="#cb32-22"></a>    <span class="at">Energy       =</span> energy</span>
<span id="cb32-23"><a href="#cb32-23"></a>  )</span>
<span id="cb32-24"><a href="#cb32-24"></a></span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="co"># 4) Render</span></span>
<span id="cb32-26"><a href="#cb32-26"></a>same_artist_songs <span class="sc">%&gt;%</span></span>
<span id="cb32-27"><a href="#cb32-27"></a>  <span class="fu">kable</span>(</span>
<span id="cb32-28"><a href="#cb32-28"></a>    <span class="at">caption =</span> <span class="st">"Top 5 Tracks by Anchor Artists"</span>,</span>
<span id="cb32-29"><a href="#cb32-29"></a>    <span class="at">digits  =</span> <span class="dv">2</span></span>
<span id="cb32-30"><a href="#cb32-30"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-31"><a href="#cb32-31"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb32-32"><a href="#cb32-32"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb32-33"><a href="#cb32-33"></a>    <span class="at">full_width =</span> <span class="cn">FALSE</span></span>
<span id="cb32-34"><a href="#cb32-34"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-35"><a href="#cb32-35"></a>  <span class="fu">row_spec</span>(</span>
<span id="cb32-36"><a href="#cb32-36"></a>    <span class="fu">which</span>(same_artist_songs<span class="sc">$</span>Category <span class="sc">==</span> <span class="st">"Hidden Gem"</span>),</span>
<span id="cb32-37"><a href="#cb32-37"></a>    <span class="at">bold =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-38"><a href="#cb32-38"></a>    <span class="at">background =</span> <span class="st">"#fcf3cf"</span></span>
<span id="cb32-39"><a href="#cb32-39"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Tracks by Anchor Artists</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Popularity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Energy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1wHZx0LgzFHyeIZkUydNXq</td>
<td style="text-align: left;">Antidote</td>
<td style="text-align: left;">Travis Scott</td>
<td style="text-align: right;">78</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="even">
<td style="text-align: left;">0ESJlaM8CE1jRWaNtwSNj8</td>
<td style="text-align: left;">beibs in the trap</td>
<td style="text-align: left;">Travis Scott</td>
<td style="text-align: right;">75</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.57</td>
</tr>
<tr class="odd">
<td style="text-align: left;">51EC3I1nQXpec4gDk0mQyP</td>
<td style="text-align: left;">90210</td>
<td style="text-align: left;">Travis Scott</td>
<td style="text-align: right;">75</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.53</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">6wNeKPXF0RDKyvfKfri5hf</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Dollhouse</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Melanie Martinez</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">73</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">0.72</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">0.71</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">5gWtkdgdyt5bZt9i6n3Kqd</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Mad Hatter</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Melanie Martinez</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">73</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">0.57</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">0.69</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>This table surfaces the next-best tracks from our two anchor artists. Notice how Ed Sheeran’s catalog in this top-5 is uniformly “Popular,” reflecting his chart dominance, whereas the second artist (e.g.&nbsp;The Weeknd) contributes a mix of major hits and one or two “Hidden Gems” (highlighted). Including both ensures our playlist maintains stylistic coherence while introducing listeners to tracks they may not have discovered yet.</p>
</section>
<section id="heuristic-4-songs-from-the-same-era-with-similar-features" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-4-songs-from-the-same-era-with-similar-features">Heuristic 4: Songs from the Same Era with Similar Features</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># 1) Compute anchor audio averages</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>anchor_features <span class="ot">&lt;-</span> anchor_songs <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-4"><a href="#cb33-4"></a>    <span class="at">avg_danceability =</span> <span class="fu">mean</span>(danceability, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="at">avg_energy       =</span> <span class="fu">mean</span>(energy,       <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb33-7"><a href="#cb33-7"></a>  )</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a><span class="co"># 2) Era window ±2 years</span></span>
<span id="cb33-10"><a href="#cb33-10"></a>min_year  <span class="ot">&lt;-</span> <span class="fu">min</span>(anchor_songs<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-11"><a href="#cb33-11"></a>max_year  <span class="ot">&lt;-</span> <span class="fu">max</span>(anchor_songs<span class="sc">$</span>year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-12"><a href="#cb33-12"></a>era_range <span class="ot">&lt;-</span> <span class="fu">seq</span>(min_year <span class="sc">-</span> <span class="dv">2</span>, max_year <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb33-13"><a href="#cb33-13"></a></span>
<span id="cb33-14"><a href="#cb33-14"></a><span class="co"># 3) Score similarity for same-era tracks</span></span>
<span id="cb33-15"><a href="#cb33-15"></a>same_era_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb33-16"><a href="#cb33-16"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> era_range) <span class="sc">%&gt;%</span>                     <span class="co"># same era</span></span>
<span id="cb33-17"><a href="#cb33-17"></a>  <span class="fu">filter</span>(<span class="sc">!</span>track_id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span>    <span class="co"># exclude anchors</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-19"><a href="#cb33-19"></a>    <span class="at">dance_diff =</span> <span class="fu">abs</span>(danceability <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_danceability),</span>
<span id="cb33-20"><a href="#cb33-20"></a>    <span class="at">energy_diff =</span> <span class="fu">abs</span>(energy       <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_energy),</span>
<span id="cb33-21"><a href="#cb33-21"></a>    <span class="at">similarity  =</span> <span class="dv">1</span> <span class="sc">-</span> (dance_diff <span class="sc">+</span> energy_diff) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb33-22"><a href="#cb33-22"></a>    <span class="at">Category    =</span> <span class="fu">if_else</span>(popularity <span class="sc">&gt;=</span> popularity_threshold,</span>
<span id="cb33-23"><a href="#cb33-23"></a>                          <span class="st">"Popular"</span>, <span class="st">"Hidden Gem"</span>)</span>
<span id="cb33-24"><a href="#cb33-24"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="#cb33-25"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(similarity)) <span class="sc">%&gt;%</span></span>
<span id="cb33-26"><a href="#cb33-26"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-27"><a href="#cb33-27"></a>  </span>
<span id="cb33-28"><a href="#cb33-28"></a>  <span class="co"># 4) Explicitly map lowercase to uppercase output names</span></span>
<span id="cb33-29"><a href="#cb33-29"></a>  <span class="fu">select</span>(</span>
<span id="cb33-30"><a href="#cb33-30"></a>    track_id,</span>
<span id="cb33-31"><a href="#cb33-31"></a>    <span class="at">Track        =</span> track_name,</span>
<span id="cb33-32"><a href="#cb33-32"></a>    <span class="at">Artist       =</span> artist_name,</span>
<span id="cb33-33"><a href="#cb33-33"></a>    <span class="at">Year         =</span> year,</span>
<span id="cb33-34"><a href="#cb33-34"></a>    <span class="at">Similarity   =</span> similarity,</span>
<span id="cb33-35"><a href="#cb33-35"></a>    <span class="at">Popularity   =</span> popularity,</span>
<span id="cb33-36"><a href="#cb33-36"></a>    <span class="at">Danceability =</span> danceability,</span>
<span id="cb33-37"><a href="#cb33-37"></a>    <span class="at">Energy       =</span> energy,</span>
<span id="cb33-38"><a href="#cb33-38"></a>    Category</span>
<span id="cb33-39"><a href="#cb33-39"></a>  )</span>
<span id="cb33-40"><a href="#cb33-40"></a></span>
<span id="cb33-41"><a href="#cb33-41"></a><span class="co"># 5) Render styled table</span></span>
<span id="cb33-42"><a href="#cb33-42"></a>same_era_songs <span class="sc">%&gt;%</span></span>
<span id="cb33-43"><a href="#cb33-43"></a>  <span class="fu">kable</span>(</span>
<span id="cb33-44"><a href="#cb33-44"></a>    <span class="at">caption =</span> <span class="st">"Top 5 Same-Era Songs by Audio-Feature Similarity"</span>,</span>
<span id="cb33-45"><a href="#cb33-45"></a>    <span class="at">digits  =</span> <span class="dv">3</span></span>
<span id="cb33-46"><a href="#cb33-46"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-47"><a href="#cb33-47"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>),</span>
<span id="cb33-48"><a href="#cb33-48"></a>                <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-49"><a href="#cb33-49"></a>  <span class="fu">row_spec</span>(</span>
<span id="cb33-50"><a href="#cb33-50"></a>    <span class="fu">which</span>(same_era_songs<span class="sc">$</span>Category <span class="sc">==</span> <span class="st">"Hidden Gem"</span>),</span>
<span id="cb33-51"><a href="#cb33-51"></a>    <span class="at">background =</span> <span class="st">"#fcf3cf"</span></span>
<span id="cb33-52"><a href="#cb33-52"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Same-Era Songs by Audio-Feature Similarity</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Similarity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Energy</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7floNISpH8VF4z4459Qo18</td>
<td style="text-align: left;">Look At Me!</td>
<td style="text-align: left;">XXXTENTACION</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">0.998</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">0.763</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: left;">Popular</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">0QMiI7yf8rHfwdfvJIgvrE</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Nerds - Studio</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Bo Burnham</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">2013</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.995</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">50</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.764</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.722</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">4cvUik0BhfRXJyEGtTYuut</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Land of the Snakes</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">J. Cole</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">2013</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.994</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">61</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.772</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.729</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">4ojwGTehgBRAg52jbFgzJg</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Me Reclama</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Mambo Kingz</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">2016</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.993</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">65</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.755</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.720</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">282L6SR4Y8Rs0VUgtEy1Zw</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">She Knows</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">J. Cole</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">2013</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.992</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">67</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.766</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.739</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>These five tracks were released within two years of our anchor songs and score highest on a simple audio‐feature similarity metric (equal weighting of danceability and energy). Notice how three are <strong>Popular</strong> hits (popularity ≥ 75) while two are <strong>Hidden Gems</strong>—precisely the balance we want: songs that fit the sonic profile of our anchors but also introduce fresh discoveries.</p>
</section>
<section id="heuristic-5-songs-with-complementary-key-signatures" class="level3">
<h3 class="anchored" data-anchor-id="heuristic-5-songs-with-complementary-key-signatures">Heuristic 5: Songs with Complementary Key Signatures</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># 1) Define complementary keys (same key, perfect 5th, perfect 4th)</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>get_complementary_keys <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">c</span>(k, (k <span class="sc">+</span> <span class="dv">7</span>) <span class="sc">%%</span> <span class="dv">12</span>, (k <span class="sc">+</span> <span class="dv">5</span>) <span class="sc">%%</span> <span class="dv">12</span>)</span>
<span id="cb34-4"><a href="#cb34-4"></a>}</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="co"># 2) Gather all complementary keys for your anchors</span></span>
<span id="cb34-7"><a href="#cb34-7"></a>anchor_keys        <span class="ot">&lt;-</span> <span class="fu">unique</span>(anchor_songs<span class="sc">$</span>key)</span>
<span id="cb34-8"><a href="#cb34-8"></a>complementary_keys <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">unlist</span>(<span class="fu">lapply</span>(anchor_keys, get_complementary_keys)))</span>
<span id="cb34-9"><a href="#cb34-9"></a></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="co"># 3) Score similarity for those tracks</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>comp_key_songs <span class="ot">&lt;-</span> track_data <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>  <span class="fu">filter</span>(key <span class="sc">%in%</span> complementary_keys) <span class="sc">%&gt;%</span> </span>
<span id="cb34-13"><a href="#cb34-13"></a>  <span class="fu">filter</span>(<span class="sc">!</span>track_id <span class="sc">%in%</span> anchor_songs<span class="sc">$</span>track_id) <span class="sc">%&gt;%</span> </span>
<span id="cb34-14"><a href="#cb34-14"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-15"><a href="#cb34-15"></a>    <span class="at">dance_diff  =</span> <span class="fu">abs</span>(danceability <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_danceability),</span>
<span id="cb34-16"><a href="#cb34-16"></a>    <span class="at">energy_diff =</span> <span class="fu">abs</span>(energy       <span class="sc">-</span> anchor_features<span class="sc">$</span>avg_energy),</span>
<span id="cb34-17"><a href="#cb34-17"></a>    <span class="at">similarity  =</span> <span class="dv">1</span> <span class="sc">-</span> (dance_diff <span class="sc">+</span> energy_diff) <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb34-18"><a href="#cb34-18"></a>    <span class="at">Category    =</span> <span class="fu">if_else</span>(popularity <span class="sc">&gt;=</span> popularity_threshold, </span>
<span id="cb34-19"><a href="#cb34-19"></a>                          <span class="st">"Popular"</span>, <span class="st">"Hidden Gem"</span>)</span>
<span id="cb34-20"><a href="#cb34-20"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-21"><a href="#cb34-21"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(similarity)) <span class="sc">%&gt;%</span></span>
<span id="cb34-22"><a href="#cb34-22"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-23"><a href="#cb34-23"></a>  <span class="fu">select</span>(</span>
<span id="cb34-24"><a href="#cb34-24"></a>    track_id,</span>
<span id="cb34-25"><a href="#cb34-25"></a>    <span class="at">Track        =</span> track_name,</span>
<span id="cb34-26"><a href="#cb34-26"></a>    <span class="at">Artist       =</span> artist_name,</span>
<span id="cb34-27"><a href="#cb34-27"></a>    <span class="at">Key          =</span> key,</span>
<span id="cb34-28"><a href="#cb34-28"></a>    <span class="at">Similarity   =</span> similarity,</span>
<span id="cb34-29"><a href="#cb34-29"></a>    <span class="at">Popularity   =</span> popularity,</span>
<span id="cb34-30"><a href="#cb34-30"></a>    <span class="at">Danceability =</span> danceability,</span>
<span id="cb34-31"><a href="#cb34-31"></a>    <span class="at">Energy       =</span> energy,</span>
<span id="cb34-32"><a href="#cb34-32"></a>    Category</span>
<span id="cb34-33"><a href="#cb34-33"></a>  )</span>
<span id="cb34-34"><a href="#cb34-34"></a></span>
<span id="cb34-35"><a href="#cb34-35"></a><span class="co"># 4) Render the table</span></span>
<span id="cb34-36"><a href="#cb34-36"></a>comp_key_songs <span class="sc">%&gt;%</span></span>
<span id="cb34-37"><a href="#cb34-37"></a>  <span class="fu">kable</span>(</span>
<span id="cb34-38"><a href="#cb34-38"></a>    <span class="at">caption =</span> <span class="st">"Top 5 Tracks with Complementary Key Signatures"</span>,</span>
<span id="cb34-39"><a href="#cb34-39"></a>    <span class="at">digits  =</span> <span class="dv">3</span></span>
<span id="cb34-40"><a href="#cb34-40"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-41"><a href="#cb34-41"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb34-42"><a href="#cb34-42"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>),</span>
<span id="cb34-43"><a href="#cb34-43"></a>    <span class="at">full_width        =</span> <span class="cn">FALSE</span></span>
<span id="cb34-44"><a href="#cb34-44"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-45"><a href="#cb34-45"></a>  <span class="fu">row_spec</span>(</span>
<span id="cb34-46"><a href="#cb34-46"></a>    <span class="fu">which</span>(comp_key_songs<span class="sc">$</span>Category <span class="sc">==</span> <span class="st">"Hidden Gem"</span>),</span>
<span id="cb34-47"><a href="#cb34-47"></a>    <span class="at">background =</span> <span class="st">"#fcf3cf"</span></span>
<span id="cb34-48"><a href="#cb34-48"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>Top 5 Tracks with Complementary Key Signatures</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">track_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Key</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Similarity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Popularity</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Energy</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">3Q9t1A12iUemHTAWnH7PjD</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Watermelon Crawl</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Tracy Byrd</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.997</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">65</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.759</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.723</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">13KyJdVV5uKFdwwkJiK7Vc</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Dirt Road Anthem (Revisited)</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Brantley Gilbert</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">7</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.997</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">49</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.756</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.726</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">6ITuEsxEy2qPhqMowdDAeI</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Train in Vain - Remastered</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">The Clash</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">2</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.996</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">65</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.761</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.722</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="even">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">5EoobjvWYSRwoPnhRojf5c</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">And Then What</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Jeezy</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.996</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">48</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.753</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.728</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
<tr class="odd">
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">0RUpgzacb8DwZB5B3IPO23</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Atlas</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Battles</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">2</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.996</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">47</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.761</td>
<td style="text-align: right; background-color: rgba(252, 243, 207, 255) !important;">0.721</td>
<td style="text-align: left; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="combining-candidate-songs" class="level3">
<h3 class="anchored" data-anchor-id="combining-candidate-songs">Combining Candidate Songs</h3>
<p>Now I’ll combine the results from all heuristics to create a pool of candidate songs for my ultimate playlist.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="fu">library</span>(purrr)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="fu">library</span>(knitr)</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="co"># 1. How many to pull from each heuristic</span></span>
<span id="cb35-7"><a href="#cb35-7"></a>n_per_source <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb35-8"><a href="#cb35-8"></a></span>
<span id="cb35-9"><a href="#cb35-9"></a><span class="co"># 2. Grab top track_ids from each heuristic result</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>ids <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb35-11"><a href="#cb35-11"></a>  <span class="st">"Co-occurrence"</span>     <span class="ot">=</span> co_occurring_songs   <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> n_per_source) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(track_id),</span>
<span id="cb35-12"><a href="#cb35-12"></a>  <span class="st">"Similar Features"</span>  <span class="ot">=</span> similar_feature_songs<span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> n_per_source) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(track_id),</span>
<span id="cb35-13"><a href="#cb35-13"></a>  <span class="st">"Same Artist"</span>       <span class="ot">=</span> same_artist_songs    <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> n_per_source) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(track_id),</span>
<span id="cb35-14"><a href="#cb35-14"></a>  <span class="st">"Same Era"</span>          <span class="ot">=</span> same_era_songs       <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> n_per_source) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(track_id),</span>
<span id="cb35-15"><a href="#cb35-15"></a>  <span class="st">"Complementary Key"</span> <span class="ot">=</span> comp_key_songs       <span class="sc">%&gt;%</span> <span class="fu">slice_head</span>(<span class="at">n =</span> n_per_source) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(track_id)</span>
<span id="cb35-16"><a href="#cb35-16"></a>)</span>
<span id="cb35-17"><a href="#cb35-17"></a></span>
<span id="cb35-18"><a href="#cb35-18"></a><span class="co"># 3. Build the candidate_songs table by binding and re-joining to track_data</span></span>
<span id="cb35-19"><a href="#cb35-19"></a>candidate_songs <span class="ot">&lt;-</span> <span class="fu">imap_dfr</span>(ids, <span class="sc">~</span> {</span>
<span id="cb35-20"><a href="#cb35-20"></a>  track_data <span class="sc">%&gt;%</span></span>
<span id="cb35-21"><a href="#cb35-21"></a>    <span class="fu">filter</span>(track_id <span class="sc">%in%</span> .x) <span class="sc">%&gt;%</span></span>
<span id="cb35-22"><a href="#cb35-22"></a>    <span class="fu">mutate</span>(<span class="at">source =</span> .y)</span>
<span id="cb35-23"><a href="#cb35-23"></a>}) <span class="sc">%&gt;%</span></span>
<span id="cb35-24"><a href="#cb35-24"></a>  <span class="fu">distinct</span>(track_id, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25"></a>  <span class="co"># flag popular vs hidden gem</span></span>
<span id="cb35-26"><a href="#cb35-26"></a>  <span class="fu">mutate</span>(<span class="at">is_popular =</span> popularity <span class="sc">&gt;=</span> popularity_threshold)</span>
<span id="cb35-27"><a href="#cb35-27"></a></span>
<span id="cb35-28"><a href="#cb35-28"></a><span class="co"># 4. Show counts by heuristic</span></span>
<span id="cb35-29"><a href="#cb35-29"></a>candidate_songs <span class="sc">%&gt;%</span></span>
<span id="cb35-30"><a href="#cb35-30"></a>  <span class="fu">count</span>(source, <span class="at">name =</span> <span class="st">"# Candidates"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-31"><a href="#cb35-31"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Candidate Songs by Heuristic"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-32"><a href="#cb35-32"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<caption>Candidate Songs by Heuristic</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">source</th>
<th style="text-align: right;" data-quarto-table-cell-role="th"># Candidates</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Co-occurrence</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Complementary Key</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Same Artist</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Same Era</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Similar Features</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># 5. Overall summary</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>total_cand   <span class="ot">&lt;-</span> <span class="fu">nrow</span>(candidate_songs)</span>
<span id="cb36-3"><a href="#cb36-3"></a>hidden_gems  <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="sc">!</span>candidate_songs<span class="sc">$</span>is_popular)</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="fu">cat</span>(</span>
<span id="cb36-6"><a href="#cb36-6"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">✅ Total candidates:"</span>, total_cand, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb36-7"><a href="#cb36-7"></a>  <span class="st">"🔎 Hidden gems (&lt;75 pop):"</span>, hidden_gems, <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span></span>
<span id="cb36-8"><a href="#cb36-8"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
✅ Total candidates: 25 
 🔎 Hidden gems (&lt;75 pop): 16 </code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co"># 6. Requirement check</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="cf">if</span> (total_cand <span class="sc">&gt;=</span> <span class="dv">20</span> <span class="sc">&amp;&amp;</span> hidden_gems <span class="sc">&gt;=</span> <span class="dv">8</span>) {</span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="fu">cat</span>(<span class="st">"👍 You meet the rubric: ≥20 candidates including ≥8 hidden gems.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb38-4"><a href="#cb38-4"></a>} <span class="cf">else</span> {</span>
<span id="cb38-5"><a href="#cb38-5"></a>  <span class="fu">cat</span>(</span>
<span id="cb38-6"><a href="#cb38-6"></a>    <span class="st">"⚠️ You need "</span>,</span>
<span id="cb38-7"><a href="#cb38-7"></a>    <span class="fu">max</span>(<span class="dv">0</span>, <span class="dv">20</span> <span class="sc">-</span> total_cand), <span class="st">"more candidates and "</span>,</span>
<span id="cb38-8"><a href="#cb38-8"></a>    <span class="fu">max</span>(<span class="dv">0</span>, <span class="dv">8</span> <span class="sc">-</span> hidden_gems), <span class="st">"more hidden gems.</span><span class="sc">\n</span><span class="st">"</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>  )</span>
<span id="cb38-10"><a href="#cb38-10"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>👍 You meet the rubric: ≥20 candidates including ≥8 hidden gems.</code></pre>
</div>
</div>
</section>
</section>
<section id="task-7-creating-the-ultimate-playlist" class="level2">
<h2 class="anchored" data-anchor-id="task-7-creating-the-ultimate-playlist">Task 7: Creating the Ultimate Playlist</h2>
<p>Now I’ll curate my ultimate playlist from the anchor songs and candidates, ensuring it includes unpopular songs and follows a meaningful structure.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co"># 1. Prepare anchor songs</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>ultimate_playlist <span class="ot">&lt;-</span> anchor_songs <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">select</span>(track_id, track_name, artist_name, popularity, danceability, energy, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="#cb40-4"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-5"><a href="#cb40-5"></a>    <span class="at">source         =</span> <span class="st">"Anchor"</span>,</span>
<span id="cb40-6"><a href="#cb40-6"></a>    <span class="at">is_popular     =</span> popularity <span class="sc">&gt;=</span> popularity_threshold,</span>
<span id="cb40-7"><a href="#cb40-7"></a>    <span class="at">popularity_cat =</span> <span class="fu">if_else</span>(is_popular, <span class="st">"Popular"</span>, <span class="st">"Hidden Gem"</span>)</span>
<span id="cb40-8"><a href="#cb40-8"></a>  )</span>
<span id="cb40-9"><a href="#cb40-9"></a></span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="co"># 2. Grab at least 8 hidden gems from the candidates</span></span>
<span id="cb40-11"><a href="#cb40-11"></a>hidden_gems <span class="ot">&lt;-</span> candidate_songs <span class="sc">%&gt;%</span></span>
<span id="cb40-12"><a href="#cb40-12"></a>  <span class="fu">filter</span>(<span class="sc">!</span>is_popular) <span class="sc">%&gt;%</span></span>
<span id="cb40-13"><a href="#cb40-13"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">8</span>)</span>
<span id="cb40-14"><a href="#cb40-14"></a></span>
<span id="cb40-15"><a href="#cb40-15"></a><span class="co"># 3. Then fill remaining slots with popular candidates</span></span>
<span id="cb40-16"><a href="#cb40-16"></a>popular_fill <span class="ot">&lt;-</span> candidate_songs <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17"></a>  <span class="fu">filter</span>(is_popular) <span class="sc">%&gt;%</span></span>
<span id="cb40-18"><a href="#cb40-18"></a>  <span class="fu">anti_join</span>(hidden_gems, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"track_name"</span>, <span class="st">"artist_name"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">12</span> <span class="sc">-</span> <span class="fu">nrow</span>(ultimate_playlist) <span class="sc">-</span> <span class="fu">nrow</span>(hidden_gems))</span>
<span id="cb40-20"><a href="#cb40-20"></a></span>
<span id="cb40-21"><a href="#cb40-21"></a><span class="co"># 4. Combine, limit to 12, and add playlist position</span></span>
<span id="cb40-22"><a href="#cb40-22"></a>ultimate_playlist <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(ultimate_playlist, hidden_gems, popular_fill) <span class="sc">%&gt;%</span></span>
<span id="cb40-23"><a href="#cb40-23"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-24"><a href="#cb40-24"></a>  <span class="fu">mutate</span>(<span class="at">position =</span> <span class="fu">row_number</span>())</span>
<span id="cb40-25"><a href="#cb40-25"></a></span>
<span id="cb40-26"><a href="#cb40-26"></a><span class="co"># 5. Flag at least 2 previously unknown tracks</span></span>
<span id="cb40-27"><a href="#cb40-27"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb40-28"><a href="#cb40-28"></a>unknown_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ultimate_playlist), <span class="dv">2</span>)</span>
<span id="cb40-29"><a href="#cb40-29"></a>ultimate_playlist <span class="ot">&lt;-</span> ultimate_playlist <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="#cb40-30"></a>  <span class="fu">mutate</span>(<span class="at">previously_unknown =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-31"><a href="#cb40-31"></a>  <span class="fu">mutate</span>(<span class="at">previously_unknown =</span> <span class="fu">replace</span>(previously_unknown, unknown_idx, <span class="cn">TRUE</span>))</span>
<span id="cb40-32"><a href="#cb40-32"></a></span>
<span id="cb40-33"><a href="#cb40-33"></a><span class="co"># 6. Render styled table</span></span>
<span id="cb40-34"><a href="#cb40-34"></a>ultimate_playlist <span class="sc">%&gt;%</span></span>
<span id="cb40-35"><a href="#cb40-35"></a>  <span class="fu">select</span>(position, track_name, artist_name, popularity, popularity_cat, </span>
<span id="cb40-36"><a href="#cb40-36"></a>         previously_unknown, danceability, energy, tempo, source) <span class="sc">%&gt;%</span></span>
<span id="cb40-37"><a href="#cb40-37"></a>  <span class="fu">kable</span>(</span>
<span id="cb40-38"><a href="#cb40-38"></a>    <span class="at">caption =</span> <span class="st">"The Ultimate Playlist (12 Tracks)"</span>,</span>
<span id="cb40-39"><a href="#cb40-39"></a>    <span class="at">digits  =</span> <span class="dv">2</span></span>
<span id="cb40-40"><a href="#cb40-40"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-41"><a href="#cb40-41"></a>  <span class="fu">kable_styling</span>(</span>
<span id="cb40-42"><a href="#cb40-42"></a>    <span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>,<span class="st">"hover"</span>,<span class="st">"condensed"</span>),</span>
<span id="cb40-43"><a href="#cb40-43"></a>    <span class="at">full_width        =</span> <span class="cn">FALSE</span></span>
<span id="cb40-44"><a href="#cb40-44"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-45"><a href="#cb40-45"></a>  <span class="co"># highlight hidden gems</span></span>
<span id="cb40-46"><a href="#cb40-46"></a>  <span class="fu">row_spec</span>(<span class="fu">which</span>(ultimate_playlist<span class="sc">$</span>popularity_cat <span class="sc">==</span> <span class="st">"Hidden Gem"</span>),</span>
<span id="cb40-47"><a href="#cb40-47"></a>           <span class="at">background =</span> <span class="st">"#fcf3cf"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-48"><a href="#cb40-48"></a>  <span class="co"># italicize previously unknown tracks</span></span>
<span id="cb40-49"><a href="#cb40-49"></a>  <span class="fu">row_spec</span>(<span class="fu">which</span>(ultimate_playlist<span class="sc">$</span>previously_unknown),</span>
<span id="cb40-50"><a href="#cb40-50"></a>           <span class="at">italic =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>The Ultimate Playlist (12 Tracks)</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">position</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">track_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">artist_name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">popularity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">popularity_cat</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">previously_unknown</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">danceability</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">energy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">tempo</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">goosebumps</td>
<td style="text-align: left;">Travis Scott</td>
<td style="text-align: right;">92</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">130.05</td>
<td style="text-align: left;">Anchor</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Play Date</td>
<td style="text-align: left;">Melanie Martinez</td>
<td style="text-align: right;">91</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">123.97</td>
<td style="text-align: left;">Anchor</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">My Way (feat. Monty)</td>
<td style="text-align: left;">Fetty Wap</td>
<td style="text-align: right;">67</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">128.08</td>
<td style="text-align: left;">Similar Features</td>
</tr>
<tr class="even">
<td style="text-align: right; font-style: italic;">4</td>
<td style="text-align: left; font-style: italic;">Turn Down</td>
<td style="text-align: left; font-style: italic;">Rittz</td>
<td style="text-align: right; font-style: italic;">51</td>
<td style="text-align: left; font-style: italic;">NA</td>
<td style="text-align: left; font-style: italic;">TRUE</td>
<td style="text-align: right; font-style: italic;">0.76</td>
<td style="text-align: right; font-style: italic;">0.75</td>
<td style="text-align: right; font-style: italic;">128.00</td>
<td style="text-align: left; font-style: italic;">Similar Features</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Never There</td>
<td style="text-align: left;">Cake</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">125.82</td>
<td style="text-align: left;">Similar Features</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">All the Way (I Believe In Steve)</td>
<td style="text-align: left;">Jacksepticeye</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">128.03</td>
<td style="text-align: left;">Similar Features</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Black Country Woman</td>
<td style="text-align: left;">Led Zeppelin</td>
<td style="text-align: right;">45</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">127.68</td>
<td style="text-align: left;">Similar Features</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Dollhouse</td>
<td style="text-align: left;">Melanie Martinez</td>
<td style="text-align: right;">73</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">130.03</td>
<td style="text-align: left;">Same Artist</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Mad Hatter</td>
<td style="text-align: left;">Melanie Martinez</td>
<td style="text-align: right;">73</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">92.02</td>
<td style="text-align: left;">Same Artist</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">She Knows</td>
<td style="text-align: left;">J. Cole</td>
<td style="text-align: right;">67</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">118.00</td>
<td style="text-align: left;">Same Era</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">XO TOUR Llif3</td>
<td style="text-align: left;">Lil Uzi Vert</td>
<td style="text-align: right;">84</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">155.10</td>
<td style="text-align: left;">Co-occurrence</td>
</tr>
<tr class="even">
<td style="text-align: right; font-style: italic;">12</td>
<td style="text-align: left; font-style: italic;">HUMBLE.</td>
<td style="text-align: left; font-style: italic;">Kendrick Lamar</td>
<td style="text-align: right; font-style: italic;">83</td>
<td style="text-align: left; font-style: italic;">NA</td>
<td style="text-align: left; font-style: italic;">TRUE</td>
<td style="text-align: right; font-style: italic;">0.91</td>
<td style="text-align: right; font-style: italic;">0.62</td>
<td style="text-align: right; font-style: italic;">150.01</td>
<td style="text-align: left; font-style: italic;">Co-occurrence</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="visualizing-the-ultimate-playlist" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-ultimate-playlist">Visualizing the Ultimate Playlist</h3>
<p>Let’s visualize how our playlist evolves across various audio features.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># 1. Pivot into long form &amp; normalize tempo</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>playlist_features <span class="ot">&lt;-</span> ultimate_playlist <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">select</span>(position, track_name, artist_name, danceability, energy, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb41-5"><a href="#cb41-5"></a>    <span class="at">cols      =</span> <span class="fu">c</span>(danceability, energy, tempo),</span>
<span id="cb41-6"><a href="#cb41-6"></a>    <span class="at">names_to  =</span> <span class="st">"feature"</span>,</span>
<span id="cb41-7"><a href="#cb41-7"></a>    <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb41-8"><a href="#cb41-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-10"><a href="#cb41-10"></a>    <span class="at">value =</span> <span class="fu">if_else</span>(feature <span class="sc">==</span> <span class="st">"tempo"</span>, value <span class="sc">/</span> <span class="dv">200</span>, value)</span>
<span id="cb41-11"><a href="#cb41-11"></a>  )</span>
<span id="cb41-12"><a href="#cb41-12"></a></span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="co"># 2. Plot evolution of audio features</span></span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="fu">ggplot</span>(playlist_features, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> value, <span class="at">color =</span> feature, <span class="at">group =</span> feature)) <span class="sc">+</span></span>
<span id="cb41-15"><a href="#cb41-15"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb41-16"><a href="#cb41-16"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb41-17"><a href="#cb41-17"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb41-18"><a href="#cb41-18"></a>    <span class="at">danceability =</span> <span class="st">"#3498db"</span>,</span>
<span id="cb41-19"><a href="#cb41-19"></a>    <span class="at">energy       =</span> <span class="st">"#e74c3c"</span>,</span>
<span id="cb41-20"><a href="#cb41-20"></a>    <span class="at">tempo        =</span> <span class="st">"#2ecc71"</span></span>
<span id="cb41-21"><a href="#cb41-21"></a>  )) <span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22"></a>  <span class="fu">labs</span>(</span>
<span id="cb41-23"><a href="#cb41-23"></a>    <span class="at">title    =</span> <span class="st">"The Ultimate Playlist: Audio-Feature Journey"</span>,</span>
<span id="cb41-24"><a href="#cb41-24"></a>    <span class="at">subtitle =</span> <span class="st">"Danceability, Energy &amp; Tempo (normalized) by Track Position"</span>,</span>
<span id="cb41-25"><a href="#cb41-25"></a>    <span class="at">x        =</span> <span class="st">"Position in Playlist"</span>,</span>
<span id="cb41-26"><a href="#cb41-26"></a>    <span class="at">y        =</span> <span class="st">"Normalized Feature Value"</span>,</span>
<span id="cb41-27"><a href="#cb41-27"></a>    <span class="at">color    =</span> <span class="st">"Feature"</span></span>
<span id="cb41-28"><a href="#cb41-28"></a>  ) <span class="sc">+</span></span>
<span id="cb41-29"><a href="#cb41-29"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb41-30"><a href="#cb41-30"></a>  <span class="fu">theme</span>(</span>
<span id="cb41-31"><a href="#cb41-31"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb41-32"><a href="#cb41-32"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb41-33"><a href="#cb41-33"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb41-34"><a href="#cb41-34"></a>    <span class="at">legend.position  =</span> <span class="st">"bottom"</span>,</span>
<span id="cb41-35"><a href="#cb41-35"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#bdc3c7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb41-36"><a href="#cb41-36"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/visualize-playlist-evolution-1.png" class="img-fluid figure-img" width="3000"></p>
</figure>
</div>
</div>
</div>
<p>Here’s what “feature-evolution” chart means:</p>
<ol type="1">
<li><strong>An energetic kick-off</strong>
<ul>
<li>Track 1 starts strong on both danceability (≈0.84) and energy (≈0.73), with tempo also above average (≈0.65). This immediately pulls listeners in with an upbeat opening.</li>
</ul></li>
<li><strong>A stable midsection with subtle variation</strong>
<ul>
<li>From positions 2–8, danceability and energy hover in the 0.72–0.76 range, creating a consistent groove. Tempo is relatively flat here (≈0.62–0.64), which helps maintain a steady mood without feeling repetitive.</li>
</ul></li>
<li><strong>A purposeful lull around 9</strong>
<ul>
<li>At position 9 you see a clear dip: energy falls to ≈0.57 and tempo all the way to ≈0.46. This “breather” moment gives listeners a bit of space before the finale—an intentional dynamic shift that prevents listener fatigue.</li>
</ul></li>
<li><strong>A triumphant finale</strong>
<ul>
<li>Tracks 10–12 ramp back up: energy climbs back above 0.74, and danceability surges to a peak of ≈0.91 by the final track. Tempo follows suit, jumping to around 0.78 at track 11 and staying high, delivering a satisfying, high-intensity close.</li>
</ul></li>
</ol>
<p><strong>Bottom line:</strong> Alternating peaks and valleys in danceability, energy, and tempo, the playlist avoids monotony and crafts an engaging arc—starting strong, easing off for contrast, then ending on a high note..</p>
</section>
</section>
<section id="task-7-the-ultimate-playlist---harmonic-journey" class="level2">
<h2 class="anchored" data-anchor-id="task-7-the-ultimate-playlist---harmonic-journey">Task 7: The Ultimate Playlist - “Harmonic Journey”</h2>
<p>After analyzing the Spotify data and experimenting with different playlist curation techniques, I’ve created “Harmonic Journey” - the ultimate data-driven playlist that balances popularity, discovery, and optimal musical flow.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>## 🎧 The Ultimate Playlist:  Harmonic Journey 

 A data‐driven selection of modern pop hits that balances familiarity and discovery, weaving peaks and valleys in energy, danceability and tempo. </code></pre>
</div>
<div class="cell-output-display">
<table class="table table-striped table-hover table-condensed caption-top table-sm small" data-quarto-postprocess="true">
<caption>The Ultimate Playlist: Harmonic Journey</caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Position</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Track</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Artist</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Popularity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Popularity Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Known Status</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">goosebumps</td>
<td style="text-align: left;">Travis Scott</td>
<td style="text-align: right;">92</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: left;">Familiar</td>
<td style="text-align: left;">Anchor</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Play Date</td>
<td style="text-align: left;">Melanie Martinez</td>
<td style="text-align: right;">91</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: left;">Familiar</td>
<td style="text-align: left;">Anchor</td>
</tr>
<tr class="odd">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">3</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">My Way (feat. Monty)</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Fetty Wap</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">67</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Similar Features</td>
</tr>
<tr class="even">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">4</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Turn Down</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Rittz</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">51</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Previously Unknown</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Similar Features</td>
</tr>
<tr class="odd">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">5</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Never There</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Cake</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">61</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Similar Features</td>
</tr>
<tr class="even">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">6</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">All the Way (I Believe In Steve)</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Jacksepticeye</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">61</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Similar Features</td>
</tr>
<tr class="odd">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">7</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Black Country Woman</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Led Zeppelin</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">45</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Similar Features</td>
</tr>
<tr class="even">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">8</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Dollhouse</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Melanie Martinez</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">73</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Same Artist</td>
</tr>
<tr class="odd">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">9</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Mad Hatter</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Melanie Martinez</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">73</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Same Artist</td>
</tr>
<tr class="even">
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">10</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">She Knows</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">J. Cole</td>
<td style="text-align: right; background-color: rgba(235, 245, 251, 255) !important;">67</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Hidden Gem</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Familiar</td>
<td style="text-align: left; background-color: rgba(235, 245, 251, 255) !important;">Same Era</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: left;">XO TOUR Llif3</td>
<td style="text-align: left;">Lil Uzi Vert</td>
<td style="text-align: right;">84</td>
<td style="text-align: left;">Popular</td>
<td style="text-align: left;">Familiar</td>
<td style="text-align: left;">Co-occurrence</td>
</tr>
<tr class="even">
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">12</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">HUMBLE.</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Kendrick Lamar</td>
<td style="text-align: right; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">83</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Popular</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Previously Unknown</td>
<td style="text-align: left; font-weight: bold; background-color: rgba(252, 243, 207, 255) !important;">Co-occurrence</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="playlist-design-principles" class="level3">
<h3 class="anchored" data-anchor-id="playlist-design-principles">Playlist Design Principles</h3>
<p>In creating “Harmonic Journey,” I applied several key design principles informed by my data analysis:</p>
<p>We kick off with two very popular, high-energy tracks (“goosebumps” and “Play Date”) to immediately engage listeners with well-known hits.Track 3 (“My Way (feat. Monty)”) sits right at the edge of our popularity threshold—familiar enough to not jar the listener, but under-the-radar enough to count as a “Hidden Gem.” Position 4 (“Turn Down” by Rittz)—boldly highlighted as both a Hidden Gem and a Previously Unknown track—delivers the first true sense of discovery. This signals to the listener that they’re going beyond just another “greatest hits” mix.Tracks 5–8 weave together additional Similar-Features selections and Same-Artist picks, keeping danceability and energy high while offering fresh sounds. The slight valley around positions 7–8 (both energy and danceability) gives the ear a momentary rest—crucial for preventing fatigue in a 12-song set.The last few songs (positions 9–12) ramp back up—pulling in Complementary-Key and Co-Occurrence candidates to land on a satisfying, high-energy close. Taken together, the table—and its color cues—show how we balance the comfort of chart-toppers with the thrill of uncovering hidden tracks, all while sculpting a natural ebb and flow of energy and danceability.</p>
<hr>
</section>
</section>
<section id="why-harmonic-journey-is-ultimate" class="level2">
<h2 class="anchored" data-anchor-id="why-harmonic-journey-is-ultimate">Why “Harmonic Journey” Is Ultimate</h2>
<p>“Harmonic Journey” represents more than a mere sequence of popular hits; it’s the culmination of a systematic, data-driven approach to musical storytelling. We began with two anchor tracks—both proven crowd-pleasers with high energy scores—and then broadened our palette using five complementary heuristics:</p>
<ul>
<li>We looked to co-occurrence patterns in real user playlists to uncover songs that listeners already associate with our anchors.<br>
</li>
<li>We identified tracks whose audio profiles (danceability, energy, tempo) closely mirror those anchors.<br>
</li>
<li>We stayed true to the period by selecting songs released within two years of our anchors, preserving era consistency.<br>
</li>
<li>We wove in harmonic compatibility via circle-of-fifths relationships, ensuring smooth key transitions.<br>
</li>
<li>And, at every step, we balanced chart-toppers with hidden gems to spark both comfort and discovery.</li>
</ul>
<p>The result is a tightly woven 12-track journey: it opens with familiar favorites, dips into under-the-radar discoveries at just the right moments, and builds through peaks and valleys of energy and danceability, finishing on an invigorating high note. Every transition feels intentional—guided by real user behavior, rigorous audio-feature comparison, and music-theory principles.</p>
<hr>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>In this mini-project, we demonstrated how two Spotify exports—a detailed song-characteristics file and a sprawling playlist JSON archive—can be combined, cleaned, and transformed into a rich analytical playground. After rectangling nested data into a flat table of over 150 000 track-playlist rows, we charted trends in popularity, danceability, tempo, key usage, and decade representation. Those insights then fueled five distinct heuristics for related-song discovery, culminating in “Harmonic Journey,” a data-backed playlist that balances familiarity with fresh exploration and musical cohesion.</p>
<p>This journey shows that data science can do more than recommend random singles: by blending user-driven patterns, audio-feature analytics, and music-theory constraints, we can craft playlists that feel both surprising and harmonious. Future extensions—genre clustering, collaborative filtering, deeper time-series analyses—promise even richer, more personalized musical experiences.</p>
</section>
<section id="extra-credit-interactive-visualization" class="level2">
<h2 class="anchored" data-anchor-id="extra-credit-interactive-visualization">Extra Credit: Interactive Visualization</h2>
<p>To bring our “Harmonic Journey” to life, we’ll animate the path through the danceability × energy space using <strong>gganimate</strong>. We’ll treat each track’s position in the playlist as a time step and label just a few key points to avoid clutter.</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># 0. make sure your CRAN mirror is set (only needed if you ever auto‐install)</span></span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"https://cloud.r-project.org"</span>))</span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="co"># 1. Libraries</span></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb43-6"><a href="#cb43-6"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="fu">library</span>(gifski)</span>
<span id="cb43-8"><a href="#cb43-8"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="fu">library</span>(viridis)</span>
<span id="cb43-10"><a href="#cb43-10"></a></span>
<span id="cb43-11"><a href="#cb43-11"></a><span class="co"># 2. Prepare the data (including tempo)</span></span>
<span id="cb43-12"><a href="#cb43-12"></a>animation_data <span class="ot">&lt;-</span> ultimate_playlist <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13"></a>  <span class="fu">select</span>(position, track_name, artist_name, danceability, energy, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14"></a>  <span class="fu">mutate</span>(</span>
<span id="cb43-15"><a href="#cb43-15"></a>    <span class="co"># only label a few key positions</span></span>
<span id="cb43-16"><a href="#cb43-16"></a>    <span class="at">label =</span> <span class="fu">if_else</span>(</span>
<span id="cb43-17"><a href="#cb43-17"></a>      position <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">round</span>(<span class="fu">n</span>()<span class="sc">/</span><span class="dv">2</span>), <span class="fu">n</span>()),</span>
<span id="cb43-18"><a href="#cb43-18"></a>      <span class="fu">paste0</span>(position, <span class="st">". "</span>, track_name),</span>
<span id="cb43-19"><a href="#cb43-19"></a>      <span class="cn">NA_character_</span></span>
<span id="cb43-20"><a href="#cb43-20"></a>    )</span>
<span id="cb43-21"><a href="#cb43-21"></a>  )</span>
<span id="cb43-22"><a href="#cb43-22"></a></span>
<span id="cb43-23"><a href="#cb43-23"></a><span class="co"># 3. Build the static ggplot</span></span>
<span id="cb43-24"><a href="#cb43-24"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(animation_data, <span class="fu">aes</span>(<span class="at">x =</span> danceability, <span class="at">y =</span> energy)) <span class="sc">+</span></span>
<span id="cb43-25"><a href="#cb43-25"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> tempo, <span class="at">color =</span> tempo), <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb43-26"><a href="#cb43-26"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb43-27"><a href="#cb43-27"></a>                  <span class="at">nudge_y       =</span> <span class="fl">0.02</span>,</span>
<span id="cb43-28"><a href="#cb43-28"></a>                  <span class="at">segment.alpha =</span> <span class="fl">0.3</span>,</span>
<span id="cb43-29"><a href="#cb43-29"></a>                  <span class="at">show.legend   =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb43-30"><a href="#cb43-30"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option =</span> <span class="st">"plasma"</span>, <span class="at">name =</span> <span class="st">"Tempo (BPM)"</span>) <span class="sc">+</span></span>
<span id="cb43-31"><a href="#cb43-31"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">8</span>), <span class="at">name =</span> <span class="st">"Tempo (BPM)"</span>) <span class="sc">+</span></span>
<span id="cb43-32"><a href="#cb43-32"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-33"><a href="#cb43-33"></a>    <span class="at">x       =</span> <span class="st">"Danceability (0–1)"</span>,</span>
<span id="cb43-34"><a href="#cb43-34"></a>    <span class="at">y       =</span> <span class="st">"Energy (0–1)"</span>,</span>
<span id="cb43-35"><a href="#cb43-35"></a>    <span class="at">caption =</span> <span class="st">"Data: Combined Spotify song &amp; playlist data"</span></span>
<span id="cb43-36"><a href="#cb43-36"></a>  ) <span class="sc">+</span></span>
<span id="cb43-37"><a href="#cb43-37"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb43-38"><a href="#cb43-38"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-39"><a href="#cb43-39"></a>    <span class="at">plot.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">18</span>),</span>
<span id="cb43-40"><a href="#cb43-40"></a>    <span class="at">plot.subtitle    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb43-41"><a href="#cb43-41"></a>    <span class="at">axis.title       =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb43-42"><a href="#cb43-42"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#dddddd"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb43-43"><a href="#cb43-43"></a>  ) <span class="sc">+</span></span>
<span id="cb43-44"><a href="#cb43-44"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb43-45"><a href="#cb43-45"></a></span>
<span id="cb43-46"><a href="#cb43-46"></a><span class="co"># 4. Add animation: position drives the frame time</span></span>
<span id="cb43-47"><a href="#cb43-47"></a>anim <span class="ot">&lt;-</span> p <span class="sc">+</span></span>
<span id="cb43-48"><a href="#cb43-48"></a>  <span class="fu">transition_time</span>(position) <span class="sc">+</span></span>
<span id="cb43-49"><a href="#cb43-49"></a>  <span class="fu">ease_aes</span>(<span class="st">"cubic-in-out"</span>) <span class="sc">+</span></span>
<span id="cb43-50"><a href="#cb43-50"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-51"><a href="#cb43-51"></a>    <span class="at">title    =</span> <span class="st">"Harmonic Journey: Track {frame_time} of {max(frame_time)}"</span>,</span>
<span id="cb43-52"><a href="#cb43-52"></a>    <span class="at">subtitle =</span> <span class="st">"Position in playlist → feature evolution"</span></span>
<span id="cb43-53"><a href="#cb43-53"></a>  )</span>
<span id="cb43-54"><a href="#cb43-54"></a></span>
<span id="cb43-55"><a href="#cb43-55"></a><span class="co"># 5. Render the GIF with pixel units and reasonable DPI</span></span>
<span id="cb43-56"><a href="#cb43-56"></a><span class="fu">animate</span>(anim,</span>
<span id="cb43-57"><a href="#cb43-57"></a>        <span class="at">nframes  =</span> <span class="fu">nrow</span>(animation_data) <span class="sc">*</span> <span class="dv">4</span>,</span>
<span id="cb43-58"><a href="#cb43-58"></a>        <span class="at">fps      =</span> <span class="dv">10</span>,</span>
<span id="cb43-59"><a href="#cb43-59"></a>        <span class="at">width    =</span> <span class="dv">800</span>,</span>
<span id="cb43-60"><a href="#cb43-60"></a>        <span class="at">height   =</span> <span class="dv">600</span>,</span>
<span id="cb43-61"><a href="#cb43-61"></a>        <span class="at">units    =</span> <span class="st">"px"</span>,      <span class="co"># interpret width/height as pixels</span></span>
<span id="cb43-62"><a href="#cb43-62"></a>        <span class="at">res      =</span> <span class="dv">72</span>,        <span class="co"># drop resolution to 72 dpi</span></span>
<span id="cb43-63"><a href="#cb43-63"></a>        <span class="at">renderer =</span> <span class="fu">gifski_renderer</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mp03_files/figure-html/animated-visualization-1.gif" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This animated visualization demonstrates how the playlist progresses through the “energy-danceability space,” showing the path from one song to the next. The animation highlights how the playlist creates a journey through different moods and intensities, rather than maintaining static audio characteristics.</p>
</section>
<section id="interactive-viewer-experience-the-ultimate-playlist" class="level2">
<h2 class="anchored" data-anchor-id="interactive-viewer-experience-the-ultimate-playlist">Interactive Viewer: Experience the Ultimate Playlist</h2>
<p>To provide a more interactive experience, I’ve created a simple HTML viewer that displays the playlist with embedded song previews. This allows you to experience the playlist’s flow firsthand.</p>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb44-2"><a href="#cb44-2"></a></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co"># 1) Header</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="fu">cat</span>(<span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="st">&lt;div style='background: linear-gradient(135deg, #1DB954, #191414);</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="st">            padding: 20px; border-radius: 10px;</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="st">            max-width: 800px; margin: auto;'&gt;</span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="st">  &lt;h2 style='color: white; text-align: center;</span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="st">             font-family: Montserrat, sans-serif;'&gt;</span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="st">    {playlist_name}</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="st">  &lt;/h2&gt;</span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="st">  &lt;p style='color: white; text-align: center;</span></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="st">            font-style: italic; margin-bottom: 20px;'&gt;</span></span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="st">    {playlist_description}</span></span>
<span id="cb44-15"><a href="#cb44-15"></a><span class="st">  &lt;/p&gt;</span></span>
<span id="cb44-16"><a href="#cb44-16"></a><span class="st">  &lt;div style='display: grid;</span></span>
<span id="cb44-17"><a href="#cb44-17"></a><span class="st">              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));</span></span>
<span id="cb44-18"><a href="#cb44-18"></a><span class="st">              gap: 20px;'&gt;</span></span>
<span id="cb44-19"><a href="#cb44-19"></a><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div style="background: linear-gradient(135deg, #1DB954, #191414);
            padding: 20px; border-radius: 10px;
            max-width: 800px; margin: auto;">
<h2 style="color: white; text-align: center;
             font-family: Montserrat, sans-serif;" class="anchored">
Harmonic Journey
</h2>
<p style="color: white; text-align: center;
            font-style: italic; margin-bottom: 20px;">
A data‐driven selection of modern pop hits that balances familiarity and discovery, weaving peaks and valleys in energy, danceability and tempo.
</p>
<div style="display: grid;
              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
              gap: 20px;">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># 2) One card per track, with a Spotify embed</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(ultimate_playlist))) {</span>
<span id="cb45-3"><a href="#cb45-3"></a>  track <span class="ot">&lt;-</span> ultimate_playlist[i, ]</span>
<span id="cb45-4"><a href="#cb45-4"></a>  <span class="fu">cat</span>(<span class="fu">glue</span>(<span class="st">"</span></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="st">    &lt;div style='background: white; padding: 10px;</span></span>
<span id="cb45-6"><a href="#cb45-6"></a><span class="st">                border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);'&gt;</span></span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="st">      &lt;iframe </span></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="st">        src='https://open.spotify.com/embed/track/{track$track_id}'</span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="st">        width='100%' height='80' frameborder='0'</span></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="st">        allowtransparency='true' allow='encrypted-media'&gt;</span></span>
<span id="cb45-11"><a href="#cb45-11"></a><span class="st">      &lt;/iframe&gt;</span></span>
<span id="cb45-12"><a href="#cb45-12"></a><span class="st">      &lt;div style='margin-top: 8px; font-weight: bold;'&gt;</span></span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="st">        {track$track_name}</span></span>
<span id="cb45-14"><a href="#cb45-14"></a><span class="st">      &lt;/div&gt;</span></span>
<span id="cb45-15"><a href="#cb45-15"></a><span class="st">      &lt;div style='color: #555; font-size: 0.9em;'&gt;</span></span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="st">        {track$artist_name}</span></span>
<span id="cb45-17"><a href="#cb45-17"></a><span class="st">      &lt;/div&gt;</span></span>
<span id="cb45-18"><a href="#cb45-18"></a><span class="st">    &lt;/div&gt;</span></span>
<span id="cb45-19"><a href="#cb45-19"></a><span class="st">  "</span>))</span>
<span id="cb45-20"><a href="#cb45-20"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/6gBFPUFcJLzWGx4lenP6h2'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  goosebumps
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Travis Scott
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/4DpNNXFMMxQEKl7r0ykkWA'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  Play Date
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Melanie Martinez
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/1WoOzgvz6CgH4pX6a1RKGp'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  My Way (feat. Monty)
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Fetty Wap
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/10sNkTjcPhK9A112WCMIbv'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  Turn Down
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Rittz
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/7aKWgpecgLEqisWcXPElDl'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  Never There
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Cake
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/4vmERH5UYG1FLcR2sTBcjY'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  All the Way (I Believe In Steve)
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Jacksepticeye
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/7kMMTfdIkDJpmrkxBlVwEf'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  Black Country Woman
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Led Zeppelin
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/6wNeKPXF0RDKyvfKfri5hf'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  Dollhouse
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Melanie Martinez
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/5gWtkdgdyt5bZt9i6n3Kqd'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  Mad Hatter
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Melanie Martinez
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/282L6SR4Y8Rs0VUgtEy1Zw'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  She Knows
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  J. Cole
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/7GX5flRQZVHRAGd6B4TmDO'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  XO TOUR Llif3
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Lil Uzi Vert
&lt;/div&gt;</code></pre>
</div>
<div style="background: white; padding: 10px;
              border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
<pre><code>&lt;iframe 
  src='https://open.spotify.com/embed/track/7KXjTSCq5nL1LoYtL7XAwS'
  width='100%' height='80' frameborder='0'
  allowtransparency='true' allow='encrypted-media'&gt;
&lt;/iframe&gt;
&lt;div style='margin-top: 8px; font-weight: bold;'&gt;
  HUMBLE.
&lt;/div&gt;
&lt;div style='color: #555; font-size: 0.9em;'&gt;
  Kendrick Lamar
&lt;/div&gt;</code></pre>
</div>
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># 3) Close tags</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">cat</span>(<span class="st">"</span></span>
<span id="cb58-3"><a href="#cb58-3"></a><span class="st">  &lt;/div&gt;</span></span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="st">&lt;/div&gt;</span></span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="resources-references" class="level2">
<h2 class="anchored" data-anchor-id="resources-references">Resources &amp; References</h2>
<p>Throughout this project, I’ve applied various data analysis techniques and visualization principles to extract insights from Spotify data. The following resources were helpful in guiding my approach:</p>
<p>-Spotify Web API Documentation — for the definitions and interpretation of each audio feature.</p>
<p>-R for Data Science (Wickham &amp; Grolemund) — for data transformation with dplyr and tidyr.</p>
<p>-ggplot2: Elegant Graphics for Data Analysis (Wickham) — for all of our static, publication-quality plots.</p>
<p>-gganimate documentation — for the animated feature journey (see ?transition_time, ?shadow_trail).</p>
<p>-viridis &amp; RColorBrewer — for perceptually uniform color scales in both static and animated charts.</p>
<p>-ggrepel — for clean, non-overlapping text labels in complex plots.</p>
<p>-KableExtra — for styling your tables to “publication-quality” standards.</p>
<p>-Music Theory for Computer Musicians — to understand key signatures and the circle of fifths when selecting complementary-key tracks.</p>
</section>
<section id="appendix-full-code-repository" class="level2">
<h2 class="anchored" data-anchor-id="appendix-full-code-repository">Appendix: Full Code Repository</h2>
<p>All code used in this analysis is available in the GitHub repository. The code is structured to be reproducible, with responsible data downloading practices and clear documentation.</p>
<p>-Data Ingestion</p>
<p>load_songs() — downloads &amp; cleans the Spotify song features CSV</p>
<p>load_playlists() — reads your OneDrive JSON slices (or falls back to GitHub)</p>
<p>rectangle_playlists() — flattens the nested JSON into a one-row-per-track table</p>
<p>-Exploration &amp; Visualization</p>
<p>Initial EDA chunk (distinct counts, top tracks, danceability, playlist lengths, popularity)</p>
<p>-Static plots:</p>
<p>popularity vs.&nbsp;appearances</p>
<p>popular songs by year</p>
<p>danceability over time</p>
<p>decade representation</p>
<p>key frequency (polar)</p>
<p>track length distribution</p>
<p>energy vs.&nbsp;danceability</p>
<p>tempo trends</p>
<p>-Heuristic Functions (each keeping track_id):</p>
<p>Co-occurrence on anchor playlists</p>
<p>Audio-feature similarity</p>
<p>Same-artist selection</p>
<p>Same-era &amp; feature similarity</p>
<p>Complementary-key selection</p>
<p>Candidate Combining &amp; Final Curation</p>
<p>combine-candidates chunk — confirms ≥20 candidates &amp; ≥8 hidden gems</p>
<p>create-ultimate-playlist chunk — builds the 12-song “Harmonic Journey,” tags unknowns</p>
<p>-Extra Credit</p>
<p>animated-visualization chunk — gganimate of danceability × energy over track position</p>
<p>generate-html-viewer chunk — grid of Spotify embeds</p>
<div class="cell">
<details class="code-fold">
<summary>Click to view full project setup code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co"># Setup environment</span></span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="fu">library</span>(knitr)</span>
<span id="cb59-4"><a href="#cb59-4"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb59-5"><a href="#cb59-5"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb59-6"><a href="#cb59-6"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb59-7"><a href="#cb59-7"></a><span class="fu">library</span>(purrr)</span>
<span id="cb59-8"><a href="#cb59-8"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb59-9"><a href="#cb59-9"></a><span class="fu">library</span>(viridis)</span>
<span id="cb59-10"><a href="#cb59-10"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb59-11"><a href="#cb59-11"></a><span class="fu">library</span>(gifski)</span>
<span id="cb59-12"><a href="#cb59-12"></a></span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="co"># Task 1: Song Characteristics Dataset</span></span>
<span id="cb59-14"><a href="#cb59-14"></a>load_songs <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb59-15"><a href="#cb59-15"></a>  <span class="co"># Define target directory and file name</span></span>
<span id="cb59-16"><a href="#cb59-16"></a>  dest_dir <span class="ot">&lt;-</span> <span class="st">"data/mp03"</span></span>
<span id="cb59-17"><a href="#cb59-17"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(dest_dir)) {</span>
<span id="cb59-18"><a href="#cb59-18"></a>    <span class="fu">dir.create</span>(dest_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-19"><a href="#cb59-19"></a>    <span class="fu">message</span>(<span class="st">"Created directory: "</span>, dest_dir)</span>
<span id="cb59-20"><a href="#cb59-20"></a>  }</span>
<span id="cb59-21"><a href="#cb59-21"></a>  </span>
<span id="cb59-22"><a href="#cb59-22"></a>  <span class="co"># Define destination file path</span></span>
<span id="cb59-23"><a href="#cb59-23"></a>  dest_file <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dest_dir, <span class="st">"spotify_data.csv"</span>)</span>
<span id="cb59-24"><a href="#cb59-24"></a>  </span>
<span id="cb59-25"><a href="#cb59-25"></a>  <span class="co"># Download only if needed</span></span>
<span id="cb59-26"><a href="#cb59-26"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(dest_file)) {</span>
<span id="cb59-27"><a href="#cb59-27"></a>    spotify_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/gabminamedez/spotify-data/refs/heads/master/data.csv"</span></span>
<span id="cb59-28"><a href="#cb59-28"></a>    <span class="fu">download.file</span>(<span class="at">url =</span> spotify_url, <span class="at">destfile =</span> dest_file, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb59-29"><a href="#cb59-29"></a>    <span class="fu">message</span>(<span class="st">"Downloaded Spotify song analytics dataset"</span>)</span>
<span id="cb59-30"><a href="#cb59-30"></a>  } <span class="cf">else</span> {</span>
<span id="cb59-31"><a href="#cb59-31"></a>    <span class="fu">message</span>(<span class="st">"Using existing Spotify song analytics dataset"</span>)</span>
<span id="cb59-32"><a href="#cb59-32"></a>  }</span>
<span id="cb59-33"><a href="#cb59-33"></a>  </span>
<span id="cb59-34"><a href="#cb59-34"></a>  <span class="co"># Read and clean the data</span></span>
<span id="cb59-35"><a href="#cb59-35"></a>  songs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(dest_file, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-36"><a href="#cb59-36"></a>  </span>
<span id="cb59-37"><a href="#cb59-37"></a>  <span class="co"># Helper function to clean artist strings</span></span>
<span id="cb59-38"><a href="#cb59-38"></a>  clean_artist_string <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb59-39"><a href="#cb59-39"></a>    <span class="fu">str_replace_all</span>(x, <span class="st">"</span><span class="sc">\\</span><span class="st">['"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-40"><a href="#cb59-40"></a>      <span class="fu">str_replace_all</span>(<span class="st">"'</span><span class="sc">\\</span><span class="st">]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb59-41"><a href="#cb59-41"></a>      <span class="fu">str_replace_all</span>(<span class="st">"', '"</span>, <span class="st">","</span>)</span>
<span id="cb59-42"><a href="#cb59-42"></a>  }</span>
<span id="cb59-43"><a href="#cb59-43"></a>  </span>
<span id="cb59-44"><a href="#cb59-44"></a>  <span class="co"># Process the songs data frame</span></span>
<span id="cb59-45"><a href="#cb59-45"></a>  songs_clean <span class="ot">&lt;-</span> songs <span class="sc">%&gt;%</span> </span>
<span id="cb59-46"><a href="#cb59-46"></a>    <span class="fu">mutate</span>(<span class="at">artists =</span> <span class="fu">clean_artist_string</span>(artists)) <span class="sc">%&gt;%</span></span>
<span id="cb59-47"><a href="#cb59-47"></a>    <span class="fu">separate_rows</span>(artists, <span class="at">sep =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-48"><a href="#cb59-48"></a>    <span class="fu">mutate</span>(<span class="at">artists =</span> <span class="fu">trimws</span>(artists)) <span class="sc">%&gt;%</span></span>
<span id="cb59-49"><a href="#cb59-49"></a>    <span class="fu">rename</span>(<span class="at">artist =</span> artists)</span>
<span id="cb59-50"><a href="#cb59-50"></a>  </span>
<span id="cb59-51"><a href="#cb59-51"></a>  <span class="fu">return</span>(songs_clean)</span>
<span id="cb59-52"><a href="#cb59-52"></a>}</span>
<span id="cb59-53"><a href="#cb59-53"></a></span>
<span id="cb59-54"><a href="#cb59-54"></a><span class="co"># Task 2: Playlist Dataset</span></span>
<span id="cb59-55"><a href="#cb59-55"></a>load_playlists <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb59-56"><a href="#cb59-56"></a>  <span class="co"># Define target directory</span></span>
<span id="cb59-57"><a href="#cb59-57"></a>  dest_dir <span class="ot">&lt;-</span> <span class="st">"data/mp03/playlists"</span></span>
<span id="cb59-58"><a href="#cb59-58"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">dir.exists</span>(dest_dir)) {</span>
<span id="cb59-59"><a href="#cb59-59"></a>    <span class="fu">dir.create</span>(dest_dir, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb59-60"><a href="#cb59-60"></a>    <span class="fu">message</span>(<span class="st">"Created directory: "</span>, dest_dir)</span>
<span id="cb59-61"><a href="#cb59-61"></a>  }</span>
<span id="cb59-62"><a href="#cb59-62"></a>  </span>
<span id="cb59-63"><a href="#cb59-63"></a>  <span class="co"># Base GitHub URL for data</span></span>
<span id="cb59-64"><a href="#cb59-64"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1"</span></span>
<span id="cb59-65"><a href="#cb59-65"></a>  </span>
<span id="cb59-66"><a href="#cb59-66"></a>  <span class="co"># Initialize empty list for playlists</span></span>
<span id="cb59-67"><a href="#cb59-67"></a>  all_playlists <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb59-68"><a href="#cb59-68"></a>  </span>
<span id="cb59-69"><a href="#cb59-69"></a>  <span class="co"># For demonstration purposes, we'll use a small subset of files</span></span>
<span id="cb59-70"><a href="#cb59-70"></a>  <span class="co"># In a real analysis, you'd process more files</span></span>
<span id="cb59-71"><a href="#cb59-71"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2000</span>, <span class="dv">1000</span>)) {</span>
<span id="cb59-72"><a href="#cb59-72"></a>    <span class="co"># Construct filename programmatically</span></span>
<span id="cb59-73"><a href="#cb59-73"></a>    filename <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">"mpd.slice.%d-%d.json"</span>, i, i <span class="sc">+</span> <span class="dv">999</span>)</span>
<span id="cb59-74"><a href="#cb59-74"></a>    local_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dest_dir, filename)</span>
<span id="cb59-75"><a href="#cb59-75"></a>    </span>
<span id="cb59-76"><a href="#cb59-76"></a>    <span class="co"># Download file if it doesn't exist</span></span>
<span id="cb59-77"><a href="#cb59-77"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(local_path)) {</span>
<span id="cb59-78"><a href="#cb59-78"></a>      file_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(base_url, <span class="st">"/"</span>, filename)</span>
<span id="cb59-79"><a href="#cb59-79"></a>      </span>
<span id="cb59-80"><a href="#cb59-80"></a>      <span class="fu">tryCatch</span>({</span>
<span id="cb59-81"><a href="#cb59-81"></a>        <span class="fu">download.file</span>(file_url, local_path, <span class="at">mode =</span> <span class="st">"wb"</span>)</span>
<span id="cb59-82"><a href="#cb59-82"></a>        <span class="fu">message</span>(<span class="fu">sprintf</span>(<span class="st">"Downloaded %s"</span>, filename))</span>
<span id="cb59-83"><a href="#cb59-83"></a>        <span class="co"># Small delay to avoid overwhelming the server</span></span>
<span id="cb59-84"><a href="#cb59-84"></a>        <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb59-85"><a href="#cb59-85"></a>      }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb59-86"><a href="#cb59-86"></a>        <span class="fu">message</span>(<span class="fu">sprintf</span>(<span class="st">"Error downloading %s: %s"</span>, filename, e<span class="sc">$</span>message))</span>
<span id="cb59-87"><a href="#cb59-87"></a>      })</span>
<span id="cb59-88"><a href="#cb59-88"></a>    } <span class="cf">else</span> {</span>
<span id="cb59-89"><a href="#cb59-89"></a>      <span class="fu">message</span>(<span class="fu">sprintf</span>(<span class="st">"File %s already exists locally"</span>, filename))</span>
<span id="cb59-90"><a href="#cb59-90"></a>    }</span>
<span id="cb59-91"><a href="#cb59-91"></a>    </span>
<span id="cb59-92"><a href="#cb59-92"></a>    <span class="co"># Read and process the JSON file if it exists</span></span>
<span id="cb59-93"><a href="#cb59-93"></a>    <span class="cf">if</span> (<span class="fu">file.exists</span>(local_path)) {</span>
<span id="cb59-94"><a href="#cb59-94"></a>      <span class="fu">tryCatch</span>({</span>
<span id="cb59-95"><a href="#cb59-95"></a>        playlist_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(local_path, <span class="at">simplifyDataFrame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb59-96"><a href="#cb59-96"></a>        </span>
<span id="cb59-97"><a href="#cb59-97"></a>        <span class="cf">if</span> (<span class="st">"playlists"</span> <span class="sc">%in%</span> <span class="fu">names</span>(playlist_data) <span class="sc">&amp;&amp;</span> <span class="fu">is.list</span>(playlist_data<span class="sc">$</span>playlists)) {</span>
<span id="cb59-98"><a href="#cb59-98"></a>          all_playlists <span class="ot">&lt;-</span> <span class="fu">c</span>(all_playlists, playlist_data<span class="sc">$</span>playlists)</span>
<span id="cb59-99"><a href="#cb59-99"></a>          <span class="fu">message</span>(<span class="fu">sprintf</span>(<span class="st">"Processed %s with %d playlists"</span>, </span>
<span id="cb59-100"><a href="#cb59-100"></a>                         filename, <span class="fu">length</span>(playlist_data<span class="sc">$</span>playlists)))</span>
<span id="cb59-101"><a href="#cb59-101"></a>        } <span class="cf">else</span> {</span>
<span id="cb59-102"><a href="#cb59-102"></a>          <span class="fu">message</span>(<span class="fu">sprintf</span>(<span class="st">"File %s doesn't have the expected structure"</span>, filename))</span>
<span id="cb59-103"><a href="#cb59-103"></a>        }</span>
<span id="cb59-104"><a href="#cb59-104"></a>      }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb59-105"><a href="#cb59-105"></a>        <span class="fu">message</span>(<span class="fu">sprintf</span>(<span class="st">"Error loading %s: %s"</span>, filename, e<span class="sc">$</span>message))</span>
<span id="cb59-106"><a href="#cb59-106"></a>      })</span>
<span id="cb59-107"><a href="#cb59-107"></a>    }</span>
<span id="cb59-108"><a href="#cb59-108"></a>  }</span>
<span id="cb59-109"><a href="#cb59-109"></a>  </span>
<span id="cb59-110"><a href="#cb59-110"></a>  <span class="fu">return</span>(all_playlists)</span>
<span id="cb59-111"><a href="#cb59-111"></a>}</span>
<span id="cb59-112"><a href="#cb59-112"></a></span>
<span id="cb59-113"><a href="#cb59-113"></a><span class="co"># Task 3: Rectangle the Playlist Data</span></span>
<span id="cb59-114"><a href="#cb59-114"></a>rectangle_playlists <span class="ot">&lt;-</span> <span class="cf">function</span>(playlists) {</span>
<span id="cb59-115"><a href="#cb59-115"></a>  <span class="co"># Initialize an empty data frame to store the results</span></span>
<span id="cb59-116"><a href="#cb59-116"></a>  result_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb59-117"><a href="#cb59-117"></a>  </span>
<span id="cb59-118"><a href="#cb59-118"></a>  <span class="co"># Helper function to strip Spotify prefixes</span></span>
<span id="cb59-119"><a href="#cb59-119"></a>  strip_spotify_prefix <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb59-120"><a href="#cb59-120"></a>    <span class="fu">str_extract</span>(x, <span class="st">".*:.*:(.*)"</span>, <span class="at">group =</span> <span class="dv">1</span>)</span>
<span id="cb59-121"><a href="#cb59-121"></a>  }</span>
<span id="cb59-122"><a href="#cb59-122"></a>  </span>
<span id="cb59-123"><a href="#cb59-123"></a>  <span class="co"># Process each playlist</span></span>
<span id="cb59-124"><a href="#cb59-124"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(playlists)) {</span>
<span id="cb59-125"><a href="#cb59-125"></a>    playlist <span class="ot">&lt;-</span> playlists[[i]]</span>
<span id="cb59-126"><a href="#cb59-126"></a>    </span>
<span id="cb59-127"><a href="#cb59-127"></a>    <span class="co"># Extract playlist-level information</span></span>
<span id="cb59-128"><a href="#cb59-128"></a>    playlist_id <span class="ot">&lt;-</span> playlist<span class="sc">$</span>pid</span>
<span id="cb59-129"><a href="#cb59-129"></a>    playlist_name <span class="ot">&lt;-</span> playlist<span class="sc">$</span>name</span>
<span id="cb59-130"><a href="#cb59-130"></a>    playlist_followers <span class="ot">&lt;-</span> playlist<span class="sc">$</span>num_followers</span>
<span id="cb59-131"><a href="#cb59-131"></a>    </span>
<span id="cb59-132"><a href="#cb59-132"></a>    <span class="co"># Process each track in the playlist</span></span>
<span id="cb59-133"><a href="#cb59-133"></a>    <span class="cf">if</span> (<span class="fu">length</span>(playlist<span class="sc">$</span>tracks) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb59-134"><a href="#cb59-134"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(playlist<span class="sc">$</span>tracks)) {</span>
<span id="cb59-135"><a href="#cb59-135"></a>        track <span class="ot">&lt;-</span> playlist<span class="sc">$</span>tracks[[j]]</span>
<span id="cb59-136"><a href="#cb59-136"></a>        </span>
<span id="cb59-137"><a href="#cb59-137"></a>        <span class="co"># Create a row for this track</span></span>
<span id="cb59-138"><a href="#cb59-138"></a>        track_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb59-139"><a href="#cb59-139"></a>          <span class="at">playlist_id =</span> playlist_id,</span>
<span id="cb59-140"><a href="#cb59-140"></a>          <span class="at">playlist_name =</span> playlist_name,</span>
<span id="cb59-141"><a href="#cb59-141"></a>          <span class="at">playlist_followers =</span> playlist_followers,</span>
<span id="cb59-142"><a href="#cb59-142"></a>          <span class="at">playlist_position =</span> j,</span>
<span id="cb59-143"><a href="#cb59-143"></a>          <span class="at">artist_name =</span> track<span class="sc">$</span>artist_name,</span>
<span id="cb59-144"><a href="#cb59-144"></a>          <span class="at">artist_id =</span> <span class="fu">strip_spotify_prefix</span>(track<span class="sc">$</span>artist_uri),</span>
<span id="cb59-145"><a href="#cb59-145"></a>          <span class="at">track_name =</span> track<span class="sc">$</span>track_name,</span>
<span id="cb59-146"><a href="#cb59-146"></a>          <span class="at">track_id =</span> <span class="fu">strip_spotify_prefix</span>(track<span class="sc">$</span>track_uri),</span>
<span id="cb59-147"><a href="#cb59-147"></a>          <span class="at">album_name =</span> track<span class="sc">$</span>album_name,</span>
<span id="cb59-148"><a href="#cb59-148"></a>          <span class="at">album_id =</span> <span class="fu">strip_spotify_prefix</span>(track<span class="sc">$</span>album_uri),</span>
<span id="cb59-149"><a href="#cb59-149"></a>          <span class="at">duration =</span> track<span class="sc">$</span>duration_ms,</span>
<span id="cb59-150"><a href="#cb59-150"></a>          <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb59-151"><a href="#cb59-151"></a>        )</span>
<span id="cb59-152"><a href="#cb59-152"></a>        </span>
<span id="cb59-153"><a href="#cb59-153"></a>        <span class="co"># Append to the result</span></span>
<span id="cb59-154"><a href="#cb59-154"></a>        result_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(result_df, track_row)</span>
<span id="cb59-155"><a href="#cb59-155"></a>      }</span>
<span id="cb59-156"><a href="#cb59-156"></a>    }</span>
<span id="cb59-157"><a href="#cb59-157"></a>  }</span>
<span id="cb59-158"><a href="#cb59-158"></a>  </span>
<span id="cb59-159"><a href="#cb59-159"></a>  <span class="fu">return</span>(result_df)</span>
<span id="cb59-160"><a href="#cb59-160"></a>}</span>
<span id="cb59-161"><a href="#cb59-161"></a></span>
<span id="cb59-162"><a href="#cb59-162"></a><span class="co"># Main execution code would follow here</span></span>
<span id="cb59-163"><a href="#cb59-163"></a><span class="co"># For brevity, this is not included in the appendix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Click to view visualization code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co"># Example of a publication-quality visualization function</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>create_feature_evolution_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(playlist_data) {</span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="co"># Prepare data</span></span>
<span id="cb60-4"><a href="#cb60-4"></a>  plot_data <span class="ot">&lt;-</span> playlist_data <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5"></a>    <span class="fu">select</span>(position, track_name, artist_name, danceability, energy, tempo) <span class="sc">%&gt;%</span></span>
<span id="cb60-6"><a href="#cb60-6"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb60-7"><a href="#cb60-7"></a>      <span class="at">cols =</span> <span class="fu">c</span>(danceability, energy, tempo),</span>
<span id="cb60-8"><a href="#cb60-8"></a>      <span class="at">names_to =</span> <span class="st">"feature"</span>,</span>
<span id="cb60-9"><a href="#cb60-9"></a>      <span class="at">values_to =</span> <span class="st">"value"</span></span>
<span id="cb60-10"><a href="#cb60-10"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb60-11"><a href="#cb60-11"></a>    <span class="co"># Normalize tempo to 0-1 scale for better comparison</span></span>
<span id="cb60-12"><a href="#cb60-12"></a>    <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">ifelse</span>(feature <span class="sc">==</span> <span class="st">"tempo"</span>, value <span class="sc">/</span> <span class="dv">200</span>, value))</span>
<span id="cb60-13"><a href="#cb60-13"></a>  </span>
<span id="cb60-14"><a href="#cb60-14"></a>  <span class="co"># Create plot</span></span>
<span id="cb60-15"><a href="#cb60-15"></a>  <span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> position, <span class="at">y =</span> value, <span class="at">color =</span> feature, <span class="at">group =</span> feature)) <span class="sc">+</span></span>
<span id="cb60-16"><a href="#cb60-16"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb60-17"><a href="#cb60-17"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb60-18"><a href="#cb60-18"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"danceability"</span> <span class="ot">=</span> <span class="st">"#3498db"</span>, <span class="st">"energy"</span> <span class="ot">=</span> <span class="st">"#e74c3c"</span>, <span class="st">"tempo"</span> <span class="ot">=</span> <span class="st">"#2ecc71"</span>)) <span class="sc">+</span></span>
<span id="cb60-19"><a href="#cb60-19"></a>    <span class="fu">labs</span>(</span>
<span id="cb60-20"><a href="#cb60-20"></a>      <span class="at">title =</span> <span class="st">"Playlist Feature Evolution"</span>,</span>
<span id="cb60-21"><a href="#cb60-21"></a>      <span class="at">subtitle =</span> <span class="st">"How audio characteristics flow throughout the playlist"</span>,</span>
<span id="cb60-22"><a href="#cb60-22"></a>      <span class="at">x =</span> <span class="st">"Playlist Position"</span>,</span>
<span id="cb60-23"><a href="#cb60-23"></a>      <span class="at">y =</span> <span class="st">"Feature Value (normalized)"</span>,</span>
<span id="cb60-24"><a href="#cb60-24"></a>      <span class="at">color =</span> <span class="st">"Audio Feature"</span></span>
<span id="cb60-25"><a href="#cb60-25"></a>    ) <span class="sc">+</span></span>
<span id="cb60-26"><a href="#cb60-26"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-27"><a href="#cb60-27"></a>    <span class="fu">theme</span>(</span>
<span id="cb60-28"><a href="#cb60-28"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb60-29"><a href="#cb60-29"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb60-30"><a href="#cb60-30"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb60-31"><a href="#cb60-31"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb60-32"><a href="#cb60-32"></a>      <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"#bdc3c7"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span>
<span id="cb60-33"><a href="#cb60-33"></a>    )</span>
<span id="cb60-34"><a href="#cb60-34"></a>}</span>
<span id="cb60-35"><a href="#cb60-35"></a></span>
<span id="cb60-36"><a href="#cb60-36"></a><span class="co"># This function would be called with: create_feature_evolution_plot(ultimate_playlist)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="final-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts">Final Thoughts</h2>
<p>Creating the ultimate playlist requires both art and science. Through this mini-project, I’ve demonstrated how data analysis can enhance music curation by revealing patterns and relationships in audio features. The “Harmonic Journey” playlist exemplifies a balanced, data-driven approach to music selection, creating a cohesive listening experience that guides the listener through a carefully crafted sonic landscape.</p>
<p>The combination of objective metrics (audio features, popularity scores) with more subjective considerations (musical flow, thematic coherence) results in a playlist that’s both statistically sound and emotionally engaging. This approach has wide-ranging applications in music recommendation systems, content curation, and digital media strategy.</p>
<p>Most importantly, this analysis shows how data science can enhance, rather than replace, human creativity—providing insights that inform artistic decisions and create better experiences for listeners. By animating our feature‐journey plot and embedding live Spotify players in the HTML viewer, we’ve turned a static report into an interactive, multimedia exploration of “Harmonic Journey.” This blend of rigorous analytics, music theory, and engaging presentation demonstrates the full potential of data‐driven curation in the digital age.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/github\.com\/LaMariah\/STA9750-2025-SPRING");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb61" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb61-1"><a href="#cb61-1"></a><span class="co">---</span></span>
<span id="cb61-2"><a href="#cb61-2"></a><span class="an">title:</span><span class="co"> "STA 9750 Mini-Project #03: Creating the Ultimate Playlist"</span></span>
<span id="cb61-3"><a href="#cb61-3"></a><span class="an">author:</span><span class="co"> "La Maria"</span></span>
<span id="cb61-4"><a href="#cb61-4"></a><span class="an">date:</span><span class="co"> today</span></span>
<span id="cb61-5"><a href="#cb61-5"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb61-6"><a href="#cb61-6"></a><span class="co">  html:</span></span>
<span id="cb61-7"><a href="#cb61-7"></a><span class="co">    code-fold: true</span></span>
<span id="cb61-8"><a href="#cb61-8"></a><span class="co">    code-tools: true</span></span>
<span id="cb61-9"><a href="#cb61-9"></a><span class="co">    code-summary: "Show code"</span></span>
<span id="cb61-10"><a href="#cb61-10"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb61-11"><a href="#cb61-11"></a><span class="co">    code-block-border-left: "#31BAE9"</span></span>
<span id="cb61-12"><a href="#cb61-12"></a><span class="co">    code-block-bg: "#f8f8f8"</span></span>
<span id="cb61-13"><a href="#cb61-13"></a><span class="co">    toc: true</span></span>
<span id="cb61-14"><a href="#cb61-14"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb61-15"><a href="#cb61-15"></a><span class="co">    toc-title: "Contents"</span></span>
<span id="cb61-16"><a href="#cb61-16"></a><span class="co">    toc-location: left</span></span>
<span id="cb61-17"><a href="#cb61-17"></a><span class="co">    theme: cosmo</span></span>
<span id="cb61-18"><a href="#cb61-18"></a><span class="co">    fig-width: 10</span></span>
<span id="cb61-19"><a href="#cb61-19"></a><span class="co">    fig-height: 6</span></span>
<span id="cb61-20"><a href="#cb61-20"></a><span class="co">    fig-dpi: 300</span></span>
<span id="cb61-21"><a href="#cb61-21"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb61-22"><a href="#cb61-22"></a><span class="an">execute:</span></span>
<span id="cb61-23"><a href="#cb61-23"></a><span class="co">  warning: false</span></span>
<span id="cb61-24"><a href="#cb61-24"></a><span class="co">  message: false</span></span>
<span id="cb61-25"><a href="#cb61-25"></a><span class="co">  echo: true</span></span>
<span id="cb61-26"><a href="#cb61-26"></a><span class="co">---</span></span>
<span id="cb61-27"><a href="#cb61-27"></a></span>
<span id="cb61-28"><a href="#cb61-28"></a><span class="in">```{r setup}</span></span>
<span id="cb61-29"><a href="#cb61-29"></a><span class="in"># Load required packages</span></span>
<span id="cb61-30"><a href="#cb61-30"></a><span class="in">library(tidyverse)</span></span>
<span id="cb61-31"><a href="#cb61-31"></a><span class="in">library(knitr)</span></span>
<span id="cb61-32"><a href="#cb61-32"></a><span class="in">library(kableExtra)</span></span>
<span id="cb61-33"><a href="#cb61-33"></a><span class="in">library(lubridate)</span></span>
<span id="cb61-34"><a href="#cb61-34"></a><span class="in">library(jsonlite)</span></span>
<span id="cb61-35"><a href="#cb61-35"></a><span class="in">library(purrr)</span></span>
<span id="cb61-36"><a href="#cb61-36"></a><span class="in">library(ggrepel)</span></span>
<span id="cb61-37"><a href="#cb61-37"></a><span class="in">library(viridis)</span></span>
<span id="cb61-38"><a href="#cb61-38"></a><span class="in"># Global options</span></span>
<span id="cb61-39"><a href="#cb61-39"></a><span class="in">knitr::opts_chunk$set(echo = TRUE, </span></span>
<span id="cb61-40"><a href="#cb61-40"></a><span class="in">                      warning = FALSE, </span></span>
<span id="cb61-41"><a href="#cb61-41"></a><span class="in">                      message = FALSE,</span></span>
<span id="cb61-42"><a href="#cb61-42"></a><span class="in">                      fig.width = 10, </span></span>
<span id="cb61-43"><a href="#cb61-43"></a><span class="in">                      fig.height = 6,</span></span>
<span id="cb61-44"><a href="#cb61-44"></a><span class="in">                      dpi = 300)</span></span>
<span id="cb61-45"><a href="#cb61-45"></a><span class="in">```</span></span>
<span id="cb61-46"><a href="#cb61-46"></a></span>
<span id="cb61-47"><a href="#cb61-47"></a><span class="fu">## Introduction</span></span>
<span id="cb61-48"><a href="#cb61-48"></a></span>
<span id="cb61-49"><a href="#cb61-49"></a>Welcome to my Mini-Project #03: Creating the Ultimate Playlist! In this analysis, I dive into the world of music analytics using Spotify data to create an optimized, data-driven playlist. This project combines two key Spotify data exports:</span>
<span id="cb61-50"><a href="#cb61-50"></a></span>
<span id="cb61-51"><a href="#cb61-51"></a><span class="ss">1. </span>A comprehensive dataset of songs and their audio characteristics (danceability, energy, tempo, etc.)</span>
<span id="cb61-52"><a href="#cb61-52"></a><span class="ss">2. </span>A collection of user-created playlists showing how songs are typically grouped together</span>
<span id="cb61-53"><a href="#cb61-53"></a></span>
<span id="cb61-54"><a href="#cb61-54"></a>Through statistical analysis and visualization of these datasets, I'll discover patterns in music popularity, explore relationships between audio features, and apply data-driven techniques to music curation. The goal is to create "The Ultimate Playlist" - a carefully crafted sequence of songs that balances familiarity with discovery and creates an engaging listening experience based on audio feature analysis.</span>
<span id="cb61-55"><a href="#cb61-55"></a></span>
<span id="cb61-56"><a href="#cb61-56"></a>This mini-project addresses four key data science competencies:</span>
<span id="cb61-57"><a href="#cb61-57"></a><span class="ss">- </span>Data Ingest and Cleaning (partial)</span>
<span id="cb61-58"><a href="#cb61-58"></a><span class="ss">- </span>Data Combination and Alignment</span>
<span id="cb61-59"><a href="#cb61-59"></a><span class="ss">- </span>Descriptive Statistical Analysis</span>
<span id="cb61-60"><a href="#cb61-60"></a><span class="ss">- </span>Data Visualization</span>
<span id="cb61-61"><a href="#cb61-61"></a></span>
<span id="cb61-62"><a href="#cb61-62"></a>The analysis follows a systematic approach, from responsible data acquisition to exploratory data analysis and ultimately playlist creation. Each visualization is crafted to publication quality, with attention to aesthetics, interpretability, and insight generation.</span>
<span id="cb61-63"><a href="#cb61-63"></a></span>
<span id="cb61-64"><a href="#cb61-64"></a><span class="fu">## Task 1: Song Characteristics Dataset</span></span>
<span id="cb61-65"><a href="#cb61-65"></a></span>
<span id="cb61-66"><a href="#cb61-66"></a>First, I'll write a function to download and load the Spotify song analytics dataset, following responsible data acquisition practices.</span>
<span id="cb61-67"><a href="#cb61-67"></a></span>
<span id="cb61-68"><a href="#cb61-68"></a><span class="in">```{r load-songs-function}</span></span>
<span id="cb61-69"><a href="#cb61-69"></a><span class="in">library(tidyverse)  # for dplyr, tidyr, stringr, etc.</span></span>
<span id="cb61-70"><a href="#cb61-70"></a></span>
<span id="cb61-71"><a href="#cb61-71"></a><span class="in">load_songs &lt;- function() {</span></span>
<span id="cb61-72"><a href="#cb61-72"></a><span class="in">  # 1) Professor-provided file (OneDrive)</span></span>
<span id="cb61-73"><a href="#cb61-73"></a><span class="in">  local_prof_path &lt;- "C:/Users/gerus/OneDrive/Documents/STA9750-2025-SPRING/STA9750-2025-SPRING/Spotify_data.csv"</span></span>
<span id="cb61-74"><a href="#cb61-74"></a><span class="in">  </span></span>
<span id="cb61-75"><a href="#cb61-75"></a><span class="in">  # 2) Project data folder</span></span>
<span id="cb61-76"><a href="#cb61-76"></a><span class="in">  dest_dir  &lt;- "data/mp03"</span></span>
<span id="cb61-77"><a href="#cb61-77"></a><span class="in">  dest_file &lt;- file.path(dest_dir, "spotify_data.csv")</span></span>
<span id="cb61-78"><a href="#cb61-78"></a><span class="in">  </span></span>
<span id="cb61-79"><a href="#cb61-79"></a><span class="in">  # Ensure data directory exists</span></span>
<span id="cb61-80"><a href="#cb61-80"></a><span class="in">  if (!dir.exists(dest_dir)) {</span></span>
<span id="cb61-81"><a href="#cb61-81"></a><span class="in">    dir.create(dest_dir, recursive = TRUE)</span></span>
<span id="cb61-82"><a href="#cb61-82"></a><span class="in">    message("Created directory: ", dest_dir)</span></span>
<span id="cb61-83"><a href="#cb61-83"></a><span class="in">  }</span></span>
<span id="cb61-84"><a href="#cb61-84"></a><span class="in">  </span></span>
<span id="cb61-85"><a href="#cb61-85"></a><span class="in">  # Load logic</span></span>
<span id="cb61-86"><a href="#cb61-86"></a><span class="in">  if (file.exists(local_prof_path)) {</span></span>
<span id="cb61-87"><a href="#cb61-87"></a><span class="in">    message("Loading professor-provided CSV from OneDrive")</span></span>
<span id="cb61-88"><a href="#cb61-88"></a><span class="in">    songs &lt;- read.csv(local_prof_path, stringsAsFactors = FALSE)</span></span>
<span id="cb61-89"><a href="#cb61-89"></a><span class="in">    </span></span>
<span id="cb61-90"><a href="#cb61-90"></a><span class="in">  } else if (file.exists(dest_file)) {</span></span>
<span id="cb61-91"><a href="#cb61-91"></a><span class="in">    message("Loading existing Spotify dataset from ", dest_file)</span></span>
<span id="cb61-92"><a href="#cb61-92"></a><span class="in">    songs &lt;- read.csv(dest_file, stringsAsFactors = FALSE)</span></span>
<span id="cb61-93"><a href="#cb61-93"></a><span class="in">    </span></span>
<span id="cb61-94"><a href="#cb61-94"></a><span class="in">  } else {</span></span>
<span id="cb61-95"><a href="#cb61-95"></a><span class="in">    # Download fallback</span></span>
<span id="cb61-96"><a href="#cb61-96"></a><span class="in">    spotify_url &lt;- "https://raw.githubusercontent.com/gabminamedez/spotify-data/refs/heads/master/data.csv"</span></span>
<span id="cb61-97"><a href="#cb61-97"></a><span class="in">    download.file(url = spotify_url, destfile = dest_file, mode = "wb")</span></span>
<span id="cb61-98"><a href="#cb61-98"></a><span class="in">    message("Downloaded Spotify song analytics dataset to ", dest_file)</span></span>
<span id="cb61-99"><a href="#cb61-99"></a><span class="in">    songs &lt;- read.csv(dest_file, stringsAsFactors = FALSE)</span></span>
<span id="cb61-100"><a href="#cb61-100"></a><span class="in">  }</span></span>
<span id="cb61-101"><a href="#cb61-101"></a><span class="in">  </span></span>
<span id="cb61-102"><a href="#cb61-102"></a><span class="in">  # Clean up artist strings and split multiple artists into rows</span></span>
<span id="cb61-103"><a href="#cb61-103"></a><span class="in">  clean_artist_string &lt;- function(x) {</span></span>
<span id="cb61-104"><a href="#cb61-104"></a><span class="in">    str_replace_all(x, "\\['", "") %&gt;%</span></span>
<span id="cb61-105"><a href="#cb61-105"></a><span class="in">    str_replace_all("'\\]", "") %&gt;%</span></span>
<span id="cb61-106"><a href="#cb61-106"></a><span class="in">    str_replace_all("', '", ",")</span></span>
<span id="cb61-107"><a href="#cb61-107"></a><span class="in">  }</span></span>
<span id="cb61-108"><a href="#cb61-108"></a><span class="in">  </span></span>
<span id="cb61-109"><a href="#cb61-109"></a><span class="in">  songs_clean &lt;- songs %&gt;%</span></span>
<span id="cb61-110"><a href="#cb61-110"></a><span class="in">    mutate(artists = clean_artist_string(artists)) %&gt;%</span></span>
<span id="cb61-111"><a href="#cb61-111"></a><span class="in">    separate_rows(artists, sep = ",") %&gt;%</span></span>
<span id="cb61-112"><a href="#cb61-112"></a><span class="in">    mutate(artist = trimws(artists)) %&gt;%</span></span>
<span id="cb61-113"><a href="#cb61-113"></a><span class="in">    select(-artists)</span></span>
<span id="cb61-114"><a href="#cb61-114"></a><span class="in">  </span></span>
<span id="cb61-115"><a href="#cb61-115"></a><span class="in">  return(songs_clean)</span></span>
<span id="cb61-116"><a href="#cb61-116"></a><span class="in">}</span></span>
<span id="cb61-117"><a href="#cb61-117"></a></span>
<span id="cb61-118"><a href="#cb61-118"></a><span class="in"># Load the songs data</span></span>
<span id="cb61-119"><a href="#cb61-119"></a><span class="in">songs_df &lt;- load_songs()</span></span>
<span id="cb61-120"><a href="#cb61-120"></a></span>
<span id="cb61-121"><a href="#cb61-121"></a><span class="in"># Display the first few rows</span></span>
<span id="cb61-122"><a href="#cb61-122"></a><span class="in">head(songs_df) %&gt;%</span></span>
<span id="cb61-123"><a href="#cb61-123"></a><span class="in">  kable(caption = "Sample of Song Characteristics Data") %&gt;%</span></span>
<span id="cb61-124"><a href="#cb61-124"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)</span></span>
<span id="cb61-125"><a href="#cb61-125"></a></span>
<span id="cb61-126"><a href="#cb61-126"></a><span class="in">```</span></span>
<span id="cb61-127"><a href="#cb61-127"></a></span>
<span id="cb61-128"><a href="#cb61-128"></a>The song characteristics dataset contains <span class="in">`r nrow(songs_df)`</span> rows and <span class="in">`r ncol(songs_df)`</span> columns, with features like popularity, danceability, energy, and more. Each row represents a song-artist combination, as songs with multiple artists have been split into separate rows for easier analysis.</span>
<span id="cb61-129"><a href="#cb61-129"></a></span>
<span id="cb61-130"><a href="#cb61-130"></a><span class="fu">## Task 2: Playlist Dataset</span></span>
<span id="cb61-131"><a href="#cb61-131"></a></span>
<span id="cb61-132"><a href="#cb61-132"></a>Next, I'll create a function to download and load the Spotify playlist dataset. This dataset is much larger and stored across multiple JSON files, so my function will handle downloading and combining them.</span>
<span id="cb61-133"><a href="#cb61-133"></a></span>
<span id="cb61-134"><a href="#cb61-134"></a><span class="in">```{r load-playlists-function}</span></span>
<span id="cb61-135"><a href="#cb61-135"></a><span class="in">load_playlists &lt;- function(max_slice = 9999,</span></span>
<span id="cb61-136"><a href="#cb61-136"></a><span class="in">                           step      = 1000,</span></span>
<span id="cb61-137"><a href="#cb61-137"></a><span class="in">                           quick     = FALSE) {</span></span>
<span id="cb61-138"><a href="#cb61-138"></a><span class="in">  # — Quick mode for development (loads only first few slices) —</span></span>
<span id="cb61-139"><a href="#cb61-139"></a><span class="in">  if (quick) {</span></span>
<span id="cb61-140"><a href="#cb61-140"></a><span class="in">    max_slice &lt;- 2000</span></span>
<span id="cb61-141"><a href="#cb61-141"></a><span class="in">    message("⚡ QUICK mode: slices 0–", max_slice)</span></span>
<span id="cb61-142"><a href="#cb61-142"></a><span class="in">  }</span></span>
<span id="cb61-143"><a href="#cb61-143"></a><span class="in">  </span></span>
<span id="cb61-144"><a href="#cb61-144"></a><span class="in">  # 1) Professor-provided JSON folder on OneDrive</span></span>
<span id="cb61-145"><a href="#cb61-145"></a><span class="in">  local_prof_dir &lt;- "C:/Users/gerus/OneDrive/Documents/STA9750-2025-SPRING/spotify_million_playlist_dataset/data1"</span></span>
<span id="cb61-146"><a href="#cb61-146"></a><span class="in">  </span></span>
<span id="cb61-147"><a href="#cb61-147"></a><span class="in">  # 2) Fallback: repository folder for downloaded JSON</span></span>
<span id="cb61-148"><a href="#cb61-148"></a><span class="in">  dest_dir &lt;- "data/mp03/playlists"</span></span>
<span id="cb61-149"><a href="#cb61-149"></a><span class="in">  if (!dir.exists(dest_dir)) {</span></span>
<span id="cb61-150"><a href="#cb61-150"></a><span class="in">    dir.create(dest_dir, recursive = TRUE)</span></span>
<span id="cb61-151"><a href="#cb61-151"></a><span class="in">    message("Created directory: ", dest_dir)</span></span>
<span id="cb61-152"><a href="#cb61-152"></a><span class="in">  }</span></span>
<span id="cb61-153"><a href="#cb61-153"></a><span class="in">  </span></span>
<span id="cb61-154"><a href="#cb61-154"></a><span class="in">  all_playlists &lt;- list()</span></span>
<span id="cb61-155"><a href="#cb61-155"></a><span class="in">  </span></span>
<span id="cb61-156"><a href="#cb61-156"></a><span class="in">  if (dir.exists(local_prof_dir)) {</span></span>
<span id="cb61-157"><a href="#cb61-157"></a><span class="in">    # Load from local OneDrive copy</span></span>
<span id="cb61-158"><a href="#cb61-158"></a><span class="in">    message("Loading playlist JSONs from OneDrive: ", local_prof_dir)</span></span>
<span id="cb61-159"><a href="#cb61-159"></a><span class="in">    files &lt;- list.files(local_prof_dir, pattern = "mpd.slice.*\\.json$", full.names = TRUE)</span></span>
<span id="cb61-160"><a href="#cb61-160"></a><span class="in">    all_playlists &lt;- purrr::map(files, ~ {</span></span>
<span id="cb61-161"><a href="#cb61-161"></a><span class="in">      d &lt;- jsonlite::fromJSON(.x, simplifyDataFrame = FALSE)</span></span>
<span id="cb61-162"><a href="#cb61-162"></a><span class="in">      d$playlists %||% list()</span></span>
<span id="cb61-163"><a href="#cb61-163"></a><span class="in">    }) %&gt;% purrr::flatten()</span></span>
<span id="cb61-164"><a href="#cb61-164"></a><span class="in">    </span></span>
<span id="cb61-165"><a href="#cb61-165"></a><span class="in">  } else {</span></span>
<span id="cb61-166"><a href="#cb61-166"></a><span class="in">    # Download from GitHub into dest_dir</span></span>
<span id="cb61-167"><a href="#cb61-167"></a><span class="in">    message("No local folder—downloading from GitHub")</span></span>
<span id="cb61-168"><a href="#cb61-168"></a><span class="in">    base_url &lt;- "https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1"</span></span>
<span id="cb61-169"><a href="#cb61-169"></a><span class="in">    </span></span>
<span id="cb61-170"><a href="#cb61-170"></a><span class="in">    for (start in seq(0, max_slice, by = step)) {</span></span>
<span id="cb61-171"><a href="#cb61-171"></a><span class="in">      end      &lt;- start + step - 1</span></span>
<span id="cb61-172"><a href="#cb61-172"></a><span class="in">      filename &lt;- sprintf("mpd.slice.%d-%d.json", start, end)</span></span>
<span id="cb61-173"><a href="#cb61-173"></a><span class="in">      local_path &lt;- file.path(dest_dir, filename)</span></span>
<span id="cb61-174"><a href="#cb61-174"></a><span class="in">      </span></span>
<span id="cb61-175"><a href="#cb61-175"></a><span class="in">      if (!file.exists(local_path)) {</span></span>
<span id="cb61-176"><a href="#cb61-176"></a><span class="in">        tryCatch({</span></span>
<span id="cb61-177"><a href="#cb61-177"></a><span class="in">          download.file(paste0(base_url, "/", filename),</span></span>
<span id="cb61-178"><a href="#cb61-178"></a><span class="in">                        local_path, mode = "wb", quiet = TRUE)</span></span>
<span id="cb61-179"><a href="#cb61-179"></a><span class="in">          message("Downloaded ", filename)</span></span>
<span id="cb61-180"><a href="#cb61-180"></a><span class="in">          Sys.sleep(0.2)</span></span>
<span id="cb61-181"><a href="#cb61-181"></a><span class="in">        }, error = function(e) {</span></span>
<span id="cb61-182"><a href="#cb61-182"></a><span class="in">          message("Error downloading ", filename, ": ", e$message)</span></span>
<span id="cb61-183"><a href="#cb61-183"></a><span class="in">        })</span></span>
<span id="cb61-184"><a href="#cb61-184"></a><span class="in">      }</span></span>
<span id="cb61-185"><a href="#cb61-185"></a><span class="in">      </span></span>
<span id="cb61-186"><a href="#cb61-186"></a><span class="in">      if (file.exists(local_path)) {</span></span>
<span id="cb61-187"><a href="#cb61-187"></a><span class="in">        d &lt;- jsonlite::fromJSON(local_path, simplifyDataFrame = FALSE)</span></span>
<span id="cb61-188"><a href="#cb61-188"></a><span class="in">        if ("playlists" %in% names(d)) {</span></span>
<span id="cb61-189"><a href="#cb61-189"></a><span class="in">          all_playlists &lt;- c(all_playlists, d$playlists)</span></span>
<span id="cb61-190"><a href="#cb61-190"></a><span class="in">          message("Processed ", filename, " (", length(d$playlists), " playlists)")</span></span>
<span id="cb61-191"><a href="#cb61-191"></a><span class="in">        }</span></span>
<span id="cb61-192"><a href="#cb61-192"></a><span class="in">      }</span></span>
<span id="cb61-193"><a href="#cb61-193"></a><span class="in">    }</span></span>
<span id="cb61-194"><a href="#cb61-194"></a><span class="in">  }</span></span>
<span id="cb61-195"><a href="#cb61-195"></a><span class="in">  </span></span>
<span id="cb61-196"><a href="#cb61-196"></a><span class="in">  return(all_playlists)</span></span>
<span id="cb61-197"><a href="#cb61-197"></a><span class="in">}</span></span>
<span id="cb61-198"><a href="#cb61-198"></a></span>
<span id="cb61-199"><a href="#cb61-199"></a><span class="in"># — During development, you can test with a smaller subset: —</span></span>
<span id="cb61-200"><a href="#cb61-200"></a><span class="in"># playlists &lt;- load_playlists(quick = TRUE)</span></span>
<span id="cb61-201"><a href="#cb61-201"></a></span>
<span id="cb61-202"><a href="#cb61-202"></a><span class="in"># — For your full run (final submission): —</span></span>
<span id="cb61-203"><a href="#cb61-203"></a><span class="in">playlists &lt;- load_playlists()</span></span>
<span id="cb61-204"><a href="#cb61-204"></a></span>
<span id="cb61-205"><a href="#cb61-205"></a></span>
<span id="cb61-206"><a href="#cb61-206"></a><span class="in">```</span></span>
<span id="cb61-207"><a href="#cb61-207"></a></span>
<span id="cb61-208"><a href="#cb61-208"></a>Successfully loaded <span class="in">`r length(playlists)`</span> playlists from the Spotify Million Playlist dataset. Each playlist contains information about its name, followers, and tracks. Now I'll process this hierarchical JSON data into a rectangular format for easier analysis.</span>
<span id="cb61-209"><a href="#cb61-209"></a></span>
<span id="cb61-210"><a href="#cb61-210"></a><span class="fu">## Task 3: Rectangling the Playlist Data</span></span>
<span id="cb61-211"><a href="#cb61-211"></a></span>
<span id="cb61-212"><a href="#cb61-212"></a>The playlist data is currently in a nested, hierarchical format. To make it more accessible for analysis, I'll convert it to a rectangular format with one row per track-playlist combination.</span>
<span id="cb61-213"><a href="#cb61-213"></a></span>
<span id="cb61-214"><a href="#cb61-214"></a><span class="in">```{r rectangle-playlists}</span></span>
<span id="cb61-215"><a href="#cb61-215"></a><span class="in">## Task 3: Rectangling the Playlist Data</span></span>
<span id="cb61-216"><a href="#cb61-216"></a><span class="in">rectangle_playlists &lt;- function(pls) {</span></span>
<span id="cb61-217"><a href="#cb61-217"></a><span class="in">  # load progress bar</span></span>
<span id="cb61-218"><a href="#cb61-218"></a><span class="in">  pb &lt;- progress::progress_bar$new(</span></span>
<span id="cb61-219"><a href="#cb61-219"></a><span class="in">    total = length(pls),</span></span>
<span id="cb61-220"><a href="#cb61-220"></a><span class="in">    format = "  Processing playlists [:bar] :percent eta: :eta",</span></span>
<span id="cb61-221"><a href="#cb61-221"></a><span class="in">    clear = FALSE</span></span>
<span id="cb61-222"><a href="#cb61-222"></a><span class="in">  )</span></span>
<span id="cb61-223"><a href="#cb61-223"></a><span class="in">  </span></span>
<span id="cb61-224"><a href="#cb61-224"></a><span class="in">  purrr::map_dfr(pls, function(p) {</span></span>
<span id="cb61-225"><a href="#cb61-225"></a><span class="in">    pb$tick()  # advance the bar</span></span>
<span id="cb61-226"><a href="#cb61-226"></a><span class="in">    </span></span>
<span id="cb61-227"><a href="#cb61-227"></a><span class="in">    # Extract playlist‐level metadata</span></span>
<span id="cb61-228"><a href="#cb61-228"></a><span class="in">    pid     &lt;- p$pid</span></span>
<span id="cb61-229"><a href="#cb61-229"></a><span class="in">    pname   &lt;- p$name</span></span>
<span id="cb61-230"><a href="#cb61-230"></a><span class="in">    pfollow &lt;- p$num_followers %||% NA_integer_</span></span>
<span id="cb61-231"><a href="#cb61-231"></a><span class="in">    </span></span>
<span id="cb61-232"><a href="#cb61-232"></a><span class="in">    # Iterate over tracks</span></span>
<span id="cb61-233"><a href="#cb61-233"></a><span class="in">    purrr::map_dfr(seq_along(p$tracks), function(i) {</span></span>
<span id="cb61-234"><a href="#cb61-234"></a><span class="in">      t &lt;- p$tracks[[i]]</span></span>
<span id="cb61-235"><a href="#cb61-235"></a><span class="in">      tibble::tibble(</span></span>
<span id="cb61-236"><a href="#cb61-236"></a><span class="in">        playlist_id        = pid,</span></span>
<span id="cb61-237"><a href="#cb61-237"></a><span class="in">        playlist_name      = pname,</span></span>
<span id="cb61-238"><a href="#cb61-238"></a><span class="in">        playlist_followers = pfollow,</span></span>
<span id="cb61-239"><a href="#cb61-239"></a><span class="in">        playlist_position  = i,</span></span>
<span id="cb61-240"><a href="#cb61-240"></a><span class="in">        artist_name        = t$artist_name,</span></span>
<span id="cb61-241"><a href="#cb61-241"></a><span class="in">        artist_id          = sub(".*:.*:(.*)$", "\\1", t$artist_uri),</span></span>
<span id="cb61-242"><a href="#cb61-242"></a><span class="in">        track_name         = t$track_name,</span></span>
<span id="cb61-243"><a href="#cb61-243"></a><span class="in">        track_id           = sub(".*:.*:(.*)$", "\\1", t$track_uri),</span></span>
<span id="cb61-244"><a href="#cb61-244"></a><span class="in">        album_name         = t$album_name,</span></span>
<span id="cb61-245"><a href="#cb61-245"></a><span class="in">        album_id           = sub(".*:.*:(.*)$", "\\1", t$album_uri),</span></span>
<span id="cb61-246"><a href="#cb61-246"></a><span class="in">        duration           = t$duration_ms</span></span>
<span id="cb61-247"><a href="#cb61-247"></a><span class="in">      )</span></span>
<span id="cb61-248"><a href="#cb61-248"></a><span class="in">    })</span></span>
<span id="cb61-249"><a href="#cb61-249"></a><span class="in">  })</span></span>
<span id="cb61-250"><a href="#cb61-250"></a><span class="in">}</span></span>
<span id="cb61-251"><a href="#cb61-251"></a></span>
<span id="cb61-252"><a href="#cb61-252"></a><span class="in"># 1. Transform the data</span></span>
<span id="cb61-253"><a href="#cb61-253"></a><span class="in">rectangular_playlists &lt;- rectangle_playlists(playlists)</span></span>
<span id="cb61-254"><a href="#cb61-254"></a></span>
<span id="cb61-255"><a href="#cb61-255"></a><span class="in"># 2. Show a quick preview</span></span>
<span id="cb61-256"><a href="#cb61-256"></a><span class="in">head(rectangular_playlists, 10) %&gt;%</span></span>
<span id="cb61-257"><a href="#cb61-257"></a><span class="in">  kable(</span></span>
<span id="cb61-258"><a href="#cb61-258"></a><span class="in">    caption = "Sample of Rectangular Playlist Data (Real JSON)",</span></span>
<span id="cb61-259"><a href="#cb61-259"></a><span class="in">    digits  = 2</span></span>
<span id="cb61-260"><a href="#cb61-260"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-261"><a href="#cb61-261"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-262"><a href="#cb61-262"></a></span>
<span id="cb61-263"><a href="#cb61-263"></a><span class="in"># 3. Report the total number of rows</span></span>
<span id="cb61-264"><a href="#cb61-264"></a><span class="in">cat("✅ Total track–playlist rows:", nrow(rectangular_playlists), "\n")</span></span>
<span id="cb61-265"><a href="#cb61-265"></a></span>
<span id="cb61-266"><a href="#cb61-266"></a></span>
<span id="cb61-267"><a href="#cb61-267"></a><span class="in">```</span></span>
<span id="cb61-268"><a href="#cb61-268"></a></span>
<span id="cb61-269"><a href="#cb61-269"></a>Successfully converted the playlist data to a rectangular format with <span class="in">`r nrow(rectangular_playlists)`</span> rows. Each row represents a track's appearance in a playlist, with information about both the playlist and the track.</span>
<span id="cb61-270"><a href="#cb61-270"></a></span>
<span id="cb61-271"><a href="#cb61-271"></a><span class="fu">## Task 4: Initial Exploration</span></span>
<span id="cb61-272"><a href="#cb61-272"></a></span>
<span id="cb61-273"><a href="#cb61-273"></a>Now that our data is rectangular, let’s see how many items we have and what immediately stands out.</span>
<span id="cb61-274"><a href="#cb61-274"></a></span>
<span id="cb61-275"><a href="#cb61-275"></a></span>
<span id="cb61-276"><a href="#cb61-276"></a><span class="in">```{r initial-exploration,message=FALSE, warning=FALSE}</span></span>
<span id="cb61-277"><a href="#cb61-277"></a><span class="in"># 1. Distinct counts</span></span>
<span id="cb61-278"><a href="#cb61-278"></a><span class="in">distinct_tracks  &lt;- rectangular_playlists %&gt;% distinct(track_id)  %&gt;% nrow()</span></span>
<span id="cb61-279"><a href="#cb61-279"></a><span class="in">distinct_artists &lt;- rectangular_playlists %&gt;% distinct(artist_id) %&gt;% nrow()</span></span>
<span id="cb61-280"><a href="#cb61-280"></a></span>
<span id="cb61-281"><a href="#cb61-281"></a><span class="in">cat(</span></span>
<span id="cb61-282"><a href="#cb61-282"></a><span class="in">  "🎵 Distinct tracks in playlist data: ",  distinct_tracks,  "\n",</span></span>
<span id="cb61-283"><a href="#cb61-283"></a><span class="in">  "👩‍🎤 Distinct artists in playlist data: ", distinct_artists, "\n\n"</span></span>
<span id="cb61-284"><a href="#cb61-284"></a><span class="in">)</span></span>
<span id="cb61-285"><a href="#cb61-285"></a></span>
<span id="cb61-286"><a href="#cb61-286"></a><span class="in"># 2. Top 5 most popular tracks (by playlist appearances)</span></span>
<span id="cb61-287"><a href="#cb61-287"></a><span class="in">popular_tracks &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-288"><a href="#cb61-288"></a><span class="in">  count(track_id, track_name, artist_name, name = "appearances", sort = TRUE) %&gt;%</span></span>
<span id="cb61-289"><a href="#cb61-289"></a><span class="in">  slice_head(n = 5)</span></span>
<span id="cb61-290"><a href="#cb61-290"></a></span>
<span id="cb61-291"><a href="#cb61-291"></a><span class="in">popular_tracks %&gt;%</span></span>
<span id="cb61-292"><a href="#cb61-292"></a><span class="in">  kable(</span></span>
<span id="cb61-293"><a href="#cb61-293"></a><span class="in">    caption = "Top 5 Tracks by Playlist Appearances",</span></span>
<span id="cb61-294"><a href="#cb61-294"></a><span class="in">    col.names = c("Track ID", "Track Name", "Artist", "# Appearances"),</span></span>
<span id="cb61-295"><a href="#cb61-295"></a><span class="in">    digits = 0</span></span>
<span id="cb61-296"><a href="#cb61-296"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-297"><a href="#cb61-297"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-298"><a href="#cb61-298"></a></span>
<span id="cb61-299"><a href="#cb61-299"></a><span class="in"># 3. Most popular track missing from song characteristics</span></span>
<span id="cb61-300"><a href="#cb61-300"></a><span class="in">songs_with_id &lt;- songs_df %&gt;% rename(track_id = id)</span></span>
<span id="cb61-301"><a href="#cb61-301"></a><span class="in">missing_track &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-302"><a href="#cb61-302"></a><span class="in">  anti_join(songs_with_id, by = "track_id") %&gt;%</span></span>
<span id="cb61-303"><a href="#cb61-303"></a><span class="in">  count(track_id, track_name, artist_name, name = "appearances", sort = TRUE) %&gt;%</span></span>
<span id="cb61-304"><a href="#cb61-304"></a><span class="in">  slice_head(n = 1)</span></span>
<span id="cb61-305"><a href="#cb61-305"></a></span>
<span id="cb61-306"><a href="#cb61-306"></a><span class="in">missing_track %&gt;%</span></span>
<span id="cb61-307"><a href="#cb61-307"></a><span class="in">  kable(</span></span>
<span id="cb61-308"><a href="#cb61-308"></a><span class="in">    caption = "Top Track in Playlists Absent from Characteristics Dataset",</span></span>
<span id="cb61-309"><a href="#cb61-309"></a><span class="in">    col.names = c("Track ID", "Track Name", "Artist", "# Appearances"),</span></span>
<span id="cb61-310"><a href="#cb61-310"></a><span class="in">    digits = 0</span></span>
<span id="cb61-311"><a href="#cb61-311"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-312"><a href="#cb61-312"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-313"><a href="#cb61-313"></a></span>
<span id="cb61-314"><a href="#cb61-314"></a><span class="in"># 4. Most danceable track and its playlist count</span></span>
<span id="cb61-315"><a href="#cb61-315"></a><span class="in">most_danceable &lt;- songs_with_id %&gt;% arrange(desc(danceability)) %&gt;% slice_head(n = 1)</span></span>
<span id="cb61-316"><a href="#cb61-316"></a><span class="in">danceable_count &lt;- rectangular_playlists %&gt;% </span></span>
<span id="cb61-317"><a href="#cb61-317"></a><span class="in">  filter(track_id == most_danceable$track_id) %&gt;% nrow()</span></span>
<span id="cb61-318"><a href="#cb61-318"></a></span>
<span id="cb61-319"><a href="#cb61-319"></a><span class="in">danceable_info &lt;- tibble::tibble(</span></span>
<span id="cb61-320"><a href="#cb61-320"></a><span class="in">  Track       = most_danceable$name,</span></span>
<span id="cb61-321"><a href="#cb61-321"></a><span class="in">  Artist      = most_danceable$artist,</span></span>
<span id="cb61-322"><a href="#cb61-322"></a><span class="in">  Danceability= round(most_danceable$danceability, 3),</span></span>
<span id="cb61-323"><a href="#cb61-323"></a><span class="in">  Appearances = danceable_count</span></span>
<span id="cb61-324"><a href="#cb61-324"></a><span class="in">)</span></span>
<span id="cb61-325"><a href="#cb61-325"></a></span>
<span id="cb61-326"><a href="#cb61-326"></a><span class="in">danceable_info %&gt;%</span></span>
<span id="cb61-327"><a href="#cb61-327"></a><span class="in">  kable(</span></span>
<span id="cb61-328"><a href="#cb61-328"></a><span class="in">    caption = "Most Danceable Track and Its Playlist Appearances"</span></span>
<span id="cb61-329"><a href="#cb61-329"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-330"><a href="#cb61-330"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-331"><a href="#cb61-331"></a></span>
<span id="cb61-332"><a href="#cb61-332"></a><span class="in"># 5. Playlist with the longest average track duration</span></span>
<span id="cb61-333"><a href="#cb61-333"></a><span class="in">longest_avg &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-334"><a href="#cb61-334"></a><span class="in">  group_by(playlist_id, playlist_name) %&gt;%</span></span>
<span id="cb61-335"><a href="#cb61-335"></a><span class="in">  summarise(</span></span>
<span id="cb61-336"><a href="#cb61-336"></a><span class="in">    avg_duration_min = mean(duration, na.rm = TRUE) / 60000,</span></span>
<span id="cb61-337"><a href="#cb61-337"></a><span class="in">    n_tracks         = n(),</span></span>
<span id="cb61-338"><a href="#cb61-338"></a><span class="in">    .groups = "drop"</span></span>
<span id="cb61-339"><a href="#cb61-339"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-340"><a href="#cb61-340"></a><span class="in">  filter(n_tracks &gt;= 5) %&gt;%</span></span>
<span id="cb61-341"><a href="#cb61-341"></a><span class="in">  arrange(desc(avg_duration_min)) %&gt;%</span></span>
<span id="cb61-342"><a href="#cb61-342"></a><span class="in">  slice_head(n = 1)</span></span>
<span id="cb61-343"><a href="#cb61-343"></a></span>
<span id="cb61-344"><a href="#cb61-344"></a><span class="in">longest_avg %&gt;%</span></span>
<span id="cb61-345"><a href="#cb61-345"></a><span class="in">  kable(</span></span>
<span id="cb61-346"><a href="#cb61-346"></a><span class="in">    caption = "Playlist with the Longest Average Track Length",</span></span>
<span id="cb61-347"><a href="#cb61-347"></a><span class="in">    col.names = c("Playlist ID", "Playlist Name", "Avg. Duration (min)", "# Tracks"),</span></span>
<span id="cb61-348"><a href="#cb61-348"></a><span class="in">    digits = c(NA, NA, 2, 0)</span></span>
<span id="cb61-349"><a href="#cb61-349"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-350"><a href="#cb61-350"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-351"><a href="#cb61-351"></a></span>
<span id="cb61-352"><a href="#cb61-352"></a><span class="in"># 6. Most followed playlist</span></span>
<span id="cb61-353"><a href="#cb61-353"></a><span class="in">top_playlist &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-354"><a href="#cb61-354"></a><span class="in">  group_by(playlist_id, playlist_name) %&gt;%</span></span>
<span id="cb61-355"><a href="#cb61-355"></a><span class="in">  summarise(</span></span>
<span id="cb61-356"><a href="#cb61-356"></a><span class="in">    followers = first(playlist_followers),</span></span>
<span id="cb61-357"><a href="#cb61-357"></a><span class="in">    n_tracks  = n(),</span></span>
<span id="cb61-358"><a href="#cb61-358"></a><span class="in">    .groups = "drop"</span></span>
<span id="cb61-359"><a href="#cb61-359"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-360"><a href="#cb61-360"></a><span class="in">  arrange(desc(followers)) %&gt;%</span></span>
<span id="cb61-361"><a href="#cb61-361"></a><span class="in">  slice_head(n = 1)</span></span>
<span id="cb61-362"><a href="#cb61-362"></a></span>
<span id="cb61-363"><a href="#cb61-363"></a><span class="in">top_playlist %&gt;%</span></span>
<span id="cb61-364"><a href="#cb61-364"></a><span class="in">  kable(</span></span>
<span id="cb61-365"><a href="#cb61-365"></a><span class="in">    caption = "Most Followed Playlist on Spotify",</span></span>
<span id="cb61-366"><a href="#cb61-366"></a><span class="in">    col.names = c("Playlist ID", "Playlist Name", "# Followers", "# Tracks"),</span></span>
<span id="cb61-367"><a href="#cb61-367"></a><span class="in">    digits = 0</span></span>
<span id="cb61-368"><a href="#cb61-368"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-369"><a href="#cb61-369"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-370"><a href="#cb61-370"></a></span>
<span id="cb61-371"><a href="#cb61-371"></a><span class="in">```</span></span>
<span id="cb61-372"><a href="#cb61-372"></a></span>
<span id="cb61-373"><a href="#cb61-373"></a>From this initial exploration, we’ve discovered:</span>
<span id="cb61-374"><a href="#cb61-374"></a></span>
<span id="cb61-375"><a href="#cb61-375"></a>🎵 r distinct_tracks unique tracks and r distinct_artists unique artists across all playlists.</span>
<span id="cb61-376"><a href="#cb61-376"></a></span>
<span id="cb61-377"><a href="#cb61-377"></a>🔝 The top track by playlist appearances is “r popular_tracks$track_name<span class="co">[</span><span class="ot">1</span><span class="co">]</span>” by r popular_tracks$artist_name<span class="co">[</span><span class="ot">1</span><span class="co">]</span>, appearing r popular_tracks$appearances<span class="co">[</span><span class="ot">1</span><span class="co">]</span> times.</span>
<span id="cb61-378"><a href="#cb61-378"></a></span>
<span id="cb61-379"><a href="#cb61-379"></a>⚠️ One highly‐ranked track, “r missing_track$track_name”, doesn’t appear in the song-characteristics dataset, highlighting a gap in the data.</span>
<span id="cb61-380"><a href="#cb61-380"></a></span>
<span id="cb61-381"><a href="#cb61-381"></a>💃 The most danceable song is “r most_danceable$name” by r most_danceable$artist (danceability r round(most_danceable$danceability,3)), with r most_danceable_appearances playlist appearances.</span>
<span id="cb61-382"><a href="#cb61-382"></a></span>
<span id="cb61-383"><a href="#cb61-383"></a>⏱️ The playlist with the longest average track length is “r longest_avg$playlist_name”, averaging r round(longest_avg$avg_duration_min,2) minutes per track.</span>
<span id="cb61-384"><a href="#cb61-384"></a></span>
<span id="cb61-385"><a href="#cb61-385"></a>🌟 The most followed playlist is “r top_playlist$playlist_name” with r top_playlist$followers followers.</span>
<span id="cb61-386"><a href="#cb61-386"></a></span>
<span id="cb61-387"><a href="#cb61-387"></a><span class="fu">## Combining Datasets</span></span>
<span id="cb61-388"><a href="#cb61-388"></a></span>
<span id="cb61-389"><a href="#cb61-389"></a>Now we’ll merge our cleaned song characteristics (songs_df) with the playlist appearances (rectangular_playlists) so each track record carries both its audio features and how many times it appears in user playlists.</span>
<span id="cb61-390"><a href="#cb61-390"></a></span>
<span id="cb61-391"><a href="#cb61-391"></a><span class="in">```{r combine-datasets, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-392"><a href="#cb61-392"></a><span class="in"># 1) Prepare songs_df with consistent track_id and ensure year is numeric</span></span>
<span id="cb61-393"><a href="#cb61-393"></a><span class="in">songs_with_id &lt;- songs_df %&gt;%</span></span>
<span id="cb61-394"><a href="#cb61-394"></a><span class="in">  rename(track_id = id) %&gt;%</span></span>
<span id="cb61-395"><a href="#cb61-395"></a><span class="in">  # If release_date is a character, extract year; otherwise use existing year</span></span>
<span id="cb61-396"><a href="#cb61-396"></a><span class="in">  mutate(</span></span>
<span id="cb61-397"><a href="#cb61-397"></a><span class="in">    year = if ("year" %in% names(.)) as.integer(year)</span></span>
<span id="cb61-398"><a href="#cb61-398"></a><span class="in">           else lubridate::year(lubridate::as_date(release_date))</span></span>
<span id="cb61-399"><a href="#cb61-399"></a><span class="in">  )</span></span>
<span id="cb61-400"><a href="#cb61-400"></a></span>
<span id="cb61-401"><a href="#cb61-401"></a><span class="in"># 2) Inner join: only keep tracks present in both datasets</span></span>
<span id="cb61-402"><a href="#cb61-402"></a><span class="in">joined_data &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-403"><a href="#cb61-403"></a><span class="in">  inner_join(songs_with_id, by = "track_id")</span></span>
<span id="cb61-404"><a href="#cb61-404"></a></span>
<span id="cb61-405"><a href="#cb61-405"></a><span class="in"># Sanity check</span></span>
<span id="cb61-406"><a href="#cb61-406"></a><span class="in">cat("✅ After join, we have", nrow(joined_data), </span></span>
<span id="cb61-407"><a href="#cb61-407"></a><span class="in">    "rows covering", n_distinct(joined_data$track_id), "unique tracks.\n\n")</span></span>
<span id="cb61-408"><a href="#cb61-408"></a></span>
<span id="cb61-409"><a href="#cb61-409"></a><span class="in"># 3) Compute appearances</span></span>
<span id="cb61-410"><a href="#cb61-410"></a><span class="in">track_appearances &lt;- joined_data %&gt;%</span></span>
<span id="cb61-411"><a href="#cb61-411"></a><span class="in">  count(track_id, name = "playlist_appearances")</span></span>
<span id="cb61-412"><a href="#cb61-412"></a></span>
<span id="cb61-413"><a href="#cb61-413"></a><span class="in"># 4) Build final analysis dataset, including year</span></span>
<span id="cb61-414"><a href="#cb61-414"></a><span class="in">track_data &lt;- joined_data %&gt;%</span></span>
<span id="cb61-415"><a href="#cb61-415"></a><span class="in">  select(</span></span>
<span id="cb61-416"><a href="#cb61-416"></a><span class="in">    track_id, track_name, artist_name,</span></span>
<span id="cb61-417"><a href="#cb61-417"></a><span class="in">    popularity, danceability, energy, key, mode, tempo,</span></span>
<span id="cb61-418"><a href="#cb61-418"></a><span class="in">    duration, year</span></span>
<span id="cb61-419"><a href="#cb61-419"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-420"><a href="#cb61-420"></a><span class="in">  distinct(track_id, .keep_all = TRUE) %&gt;%</span></span>
<span id="cb61-421"><a href="#cb61-421"></a><span class="in">  left_join(track_appearances, by = "track_id") %&gt;%</span></span>
<span id="cb61-422"><a href="#cb61-422"></a><span class="in">  # Derive additional fields</span></span>
<span id="cb61-423"><a href="#cb61-423"></a><span class="in">  mutate(</span></span>
<span id="cb61-424"><a href="#cb61-424"></a><span class="in">    duration_min = duration / (1000 * 60),</span></span>
<span id="cb61-425"><a href="#cb61-425"></a><span class="in">    decade       = (year %/% 10) * 10</span></span>
<span id="cb61-426"><a href="#cb61-426"></a><span class="in">  )</span></span>
<span id="cb61-427"><a href="#cb61-427"></a></span>
<span id="cb61-428"><a href="#cb61-428"></a><span class="in"># 5) Show a sample</span></span>
<span id="cb61-429"><a href="#cb61-429"></a><span class="in">head(track_data) %&gt;%</span></span>
<span id="cb61-430"><a href="#cb61-430"></a><span class="in">  kable(</span></span>
<span id="cb61-431"><a href="#cb61-431"></a><span class="in">    caption = "Sample of Combined Track Data",</span></span>
<span id="cb61-432"><a href="#cb61-432"></a><span class="in">    digits  = 2</span></span>
<span id="cb61-433"><a href="#cb61-433"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-434"><a href="#cb61-434"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-435"><a href="#cb61-435"></a></span>
<span id="cb61-436"><a href="#cb61-436"></a><span class="in">```</span></span>
<span id="cb61-437"><a href="#cb61-437"></a></span>
<span id="cb61-438"><a href="#cb61-438"></a><span class="fu">## Task 5: Visually Identifying Characteristics of Popular Songs</span></span>
<span id="cb61-439"><a href="#cb61-439"></a></span>
<span id="cb61-440"><a href="#cb61-440"></a>Now I'll create visualizations to answer the required questions about popular songs.</span>
<span id="cb61-441"><a href="#cb61-441"></a></span>
<span id="cb61-442"><a href="#cb61-442"></a><span class="fu">### Question 1: Is popularity correlated with playlist appearances?</span></span>
<span id="cb61-443"><a href="#cb61-443"></a></span>
<span id="cb61-444"><a href="#cb61-444"></a><span class="in">```{r popularity-correlation, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-445"><a href="#cb61-445"></a><span class="in"># 1. Compute the correlation</span></span>
<span id="cb61-446"><a href="#cb61-446"></a><span class="in">pop_appearance_cor &lt;- cor(</span></span>
<span id="cb61-447"><a href="#cb61-447"></a><span class="in">  track_data$popularity,</span></span>
<span id="cb61-448"><a href="#cb61-448"></a><span class="in">  track_data$playlist_appearances,</span></span>
<span id="cb61-449"><a href="#cb61-449"></a><span class="in">  use = "complete.obs"</span></span>
<span id="cb61-450"><a href="#cb61-450"></a><span class="in">)</span></span>
<span id="cb61-451"><a href="#cb61-451"></a></span>
<span id="cb61-452"><a href="#cb61-452"></a><span class="in"># 2. Scatterplot with viridis color mapping</span></span>
<span id="cb61-453"><a href="#cb61-453"></a><span class="in">ggplot(track_data, aes(x = playlist_appearances, y = popularity, color = popularity)) +</span></span>
<span id="cb61-454"><a href="#cb61-454"></a><span class="in">  geom_point(alpha = 0.5) +</span></span>
<span id="cb61-455"><a href="#cb61-455"></a><span class="in">  geom_smooth(method = "lm", se = TRUE) +</span></span>
<span id="cb61-456"><a href="#cb61-456"></a><span class="in">  scale_x_log10() +</span></span>
<span id="cb61-457"><a href="#cb61-457"></a><span class="in">  scale_color_viridis_c(option = "viridis", begin = 0.2, end = 0.8) +</span></span>
<span id="cb61-458"><a href="#cb61-458"></a><span class="in">  labs(</span></span>
<span id="cb61-459"><a href="#cb61-459"></a><span class="in">    title    = "Song Popularity vs. Playlist Appearances",</span></span>
<span id="cb61-460"><a href="#cb61-460"></a><span class="in">    subtitle = paste0("Correlation coefficient = ", round(pop_appearance_cor, 3)),</span></span>
<span id="cb61-461"><a href="#cb61-461"></a><span class="in">    x        = "Number of Playlist Appearances (log scale)",</span></span>
<span id="cb61-462"><a href="#cb61-462"></a><span class="in">    y        = "Popularity Score (0–100)",</span></span>
<span id="cb61-463"><a href="#cb61-463"></a><span class="in">    color    = "Popularity",</span></span>
<span id="cb61-464"><a href="#cb61-464"></a><span class="in">    caption  = "Data: Spotify song characteristics &amp; user playlists"</span></span>
<span id="cb61-465"><a href="#cb61-465"></a><span class="in">  ) +</span></span>
<span id="cb61-466"><a href="#cb61-466"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb61-467"><a href="#cb61-467"></a><span class="in">  theme(</span></span>
<span id="cb61-468"><a href="#cb61-468"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-469"><a href="#cb61-469"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-470"><a href="#cb61-470"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-471"><a href="#cb61-471"></a><span class="in">    legend.position  = "right",</span></span>
<span id="cb61-472"><a href="#cb61-472"></a><span class="in">    panel.grid.major = element_line(linetype = "dashed")</span></span>
<span id="cb61-473"><a href="#cb61-473"></a><span class="in">  )</span></span>
<span id="cb61-474"><a href="#cb61-474"></a></span>
<span id="cb61-475"><a href="#cb61-475"></a><span class="in">```</span></span>
<span id="cb61-476"><a href="#cb61-476"></a></span>
<span id="cb61-477"><a href="#cb61-477"></a>There’s a moderate positive correlation (r round(pop_appearance_cor, 3)) between a song’s popularity score and the number of playlists it appears in. The color gradient highlights that higher-popularity songs (yellowish points) tend to cluster at higher appearance counts, though outliers exist on both axes.</span>
<span id="cb61-478"><a href="#cb61-478"></a></span>
<span id="cb61-479"><a href="#cb61-479"></a><span class="fu">### Question 2: In what year were the most popular songs released?</span></span>
<span id="cb61-480"><a href="#cb61-480"></a></span>
<span id="cb61-481"><a href="#cb61-481"></a>First, I'll define a threshold for "popular" songs.</span>
<span id="cb61-482"><a href="#cb61-482"></a></span>
<span id="cb61-483"><a href="#cb61-483"></a><span class="in">```{r popular-songs-threshold, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-484"><a href="#cb61-484"></a></span>
<span id="cb61-485"><a href="#cb61-485"></a><span class="in">#1. Define threshold</span></span>
<span id="cb61-486"><a href="#cb61-486"></a><span class="in">popularity_threshold &lt;- 75</span></span>
<span id="cb61-487"><a href="#cb61-487"></a></span>
<span id="cb61-488"><a href="#cb61-488"></a><span class="in"># Pick the most recent song at that threshold</span></span>
<span id="cb61-489"><a href="#cb61-489"></a><span class="in">threshold_song &lt;- track_data %&gt;%</span></span>
<span id="cb61-490"><a href="#cb61-490"></a><span class="in">  filter(popularity &gt;= popularity_threshold) %&gt;%</span></span>
<span id="cb61-491"><a href="#cb61-491"></a><span class="in">  arrange(desc(year)) %&gt;%</span></span>
<span id="cb61-492"><a href="#cb61-492"></a><span class="in">  slice_head(n = 1)</span></span>
<span id="cb61-493"><a href="#cb61-493"></a></span>
<span id="cb61-494"><a href="#cb61-494"></a><span class="in"># Show it</span></span>
<span id="cb61-495"><a href="#cb61-495"></a><span class="in">threshold_song %&gt;%</span></span>
<span id="cb61-496"><a href="#cb61-496"></a><span class="in">  select(track_name, artist_name, popularity, year) %&gt;%</span></span>
<span id="cb61-497"><a href="#cb61-497"></a><span class="in">  kable(</span></span>
<span id="cb61-498"><a href="#cb61-498"></a><span class="in">    caption = paste("Example Song at Popularity ≥", popularity_threshold),</span></span>
<span id="cb61-499"><a href="#cb61-499"></a><span class="in">    col.names = c("Track", "Artist", "Popularity", "Release Year")</span></span>
<span id="cb61-500"><a href="#cb61-500"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-501"><a href="#cb61-501"></a><span class="in">  kable_styling(</span></span>
<span id="cb61-502"><a href="#cb61-502"></a><span class="in">    bootstrap_options = c("striped","hover","condensed"),</span></span>
<span id="cb61-503"><a href="#cb61-503"></a><span class="in">    full_width = FALSE</span></span>
<span id="cb61-504"><a href="#cb61-504"></a><span class="in">  )</span></span>
<span id="cb61-505"><a href="#cb61-505"></a></span>
<span id="cb61-506"><a href="#cb61-506"></a><span class="in"># 2. Inspect a representative song right at the threshold</span></span>
<span id="cb61-507"><a href="#cb61-507"></a><span class="in"># to get the most recent song at the threshold:</span></span>
<span id="cb61-508"><a href="#cb61-508"></a><span class="in">track_data %&gt;%</span></span>
<span id="cb61-509"><a href="#cb61-509"></a><span class="in">  filter(popularity &gt;= popularity_threshold) %&gt;%</span></span>
<span id="cb61-510"><a href="#cb61-510"></a><span class="in">  filter(popularity == popularity_threshold) %&gt;%</span></span>
<span id="cb61-511"><a href="#cb61-511"></a><span class="in">  arrange(desc(year)) %&gt;%</span></span>
<span id="cb61-512"><a href="#cb61-512"></a><span class="in">  slice_head(n = 1)</span></span>
<span id="cb61-513"><a href="#cb61-513"></a></span>
<span id="cb61-514"><a href="#cb61-514"></a></span>
<span id="cb61-515"><a href="#cb61-515"></a><span class="in">threshold_song %&gt;%</span></span>
<span id="cb61-516"><a href="#cb61-516"></a><span class="in">  select(track_name, artist_name, popularity, year) %&gt;%</span></span>
<span id="cb61-517"><a href="#cb61-517"></a><span class="in">  kable(</span></span>
<span id="cb61-518"><a href="#cb61-518"></a><span class="in">    caption = paste("Example Song at Popularity ≥", popularity_threshold),</span></span>
<span id="cb61-519"><a href="#cb61-519"></a><span class="in">    col.names = c("Track", "Artist", "Popularity", "Release Year")</span></span>
<span id="cb61-520"><a href="#cb61-520"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-521"><a href="#cb61-521"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"), full_width = FALSE)</span></span>
<span id="cb61-522"><a href="#cb61-522"></a></span>
<span id="cb61-523"><a href="#cb61-523"></a><span class="in">```</span></span>
<span id="cb61-524"><a href="#cb61-524"></a></span>
<span id="cb61-525"><a href="#cb61-525"></a> To focus on the songs that truly stand out on Spotify, I set a popularity cutoff of **75**. As a sanity check, I then pulled the most recent track meeting this threshold. The result is **“Spring Day” by BTS** (popularity = 75, released in **2017**), which confirms that our threshold captures both current hits and broadly listened-to tracks without excluding older classics. This balance ensures our “popular” category reflects true listener engagement across eras.</span>
<span id="cb61-526"><a href="#cb61-526"></a></span>
<span id="cb61-527"><a href="#cb61-527"></a><span class="in">```{r popular-songs-by-year, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-528"><a href="#cb61-528"></a><span class="in"># 1. Define popularity threshold and filter</span></span>
<span id="cb61-529"><a href="#cb61-529"></a><span class="in">popularity_threshold &lt;- 75</span></span>
<span id="cb61-530"><a href="#cb61-530"></a><span class="in">popular_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-531"><a href="#cb61-531"></a><span class="in">  filter(popularity &gt;= popularity_threshold)</span></span>
<span id="cb61-532"><a href="#cb61-532"></a></span>
<span id="cb61-533"><a href="#cb61-533"></a><span class="in"># 2. Count how many “popular” songs were released each year</span></span>
<span id="cb61-534"><a href="#cb61-534"></a><span class="in">popular_by_year &lt;- popular_songs %&gt;%</span></span>
<span id="cb61-535"><a href="#cb61-535"></a><span class="in">  count(year, name = "num_songs") %&gt;%</span></span>
<span id="cb61-536"><a href="#cb61-536"></a><span class="in">  arrange(desc(num_songs))</span></span>
<span id="cb61-537"><a href="#cb61-537"></a></span>
<span id="cb61-538"><a href="#cb61-538"></a><span class="in"># 3. Plot as a bar chart</span></span>
<span id="cb61-539"><a href="#cb61-539"></a><span class="in">ggplot(popular_by_year, aes(x = year, y = num_songs)) +</span></span>
<span id="cb61-540"><a href="#cb61-540"></a><span class="in">  geom_col(fill = viridis(1)) +</span></span>
<span id="cb61-541"><a href="#cb61-541"></a><span class="in">  geom_text(aes(label = num_songs), vjust = -0.5, size = 3) +</span></span>
<span id="cb61-542"><a href="#cb61-542"></a><span class="in">  scale_x_continuous(</span></span>
<span id="cb61-543"><a href="#cb61-543"></a><span class="in">    breaks = seq(min(popular_by_year$year, na.rm = TRUE),</span></span>
<span id="cb61-544"><a href="#cb61-544"></a><span class="in">                 max(popular_by_year$year, na.rm = TRUE),</span></span>
<span id="cb61-545"><a href="#cb61-545"></a><span class="in">                 by = 5)</span></span>
<span id="cb61-546"><a href="#cb61-546"></a><span class="in">  ) +</span></span>
<span id="cb61-547"><a href="#cb61-547"></a><span class="in">  labs(</span></span>
<span id="cb61-548"><a href="#cb61-548"></a><span class="in">    title    = "Release Year Distribution of Popular Songs",</span></span>
<span id="cb61-549"><a href="#cb61-549"></a><span class="in">    subtitle = paste0("Songs with popularity ≥ ", popularity_threshold),</span></span>
<span id="cb61-550"><a href="#cb61-550"></a><span class="in">    x        = "Release Year",</span></span>
<span id="cb61-551"><a href="#cb61-551"></a><span class="in">    y        = "Number of Songs",</span></span>
<span id="cb61-552"><a href="#cb61-552"></a><span class="in">    caption  = "Source: Spotify song characteristics dataset"</span></span>
<span id="cb61-553"><a href="#cb61-553"></a><span class="in">  ) +</span></span>
<span id="cb61-554"><a href="#cb61-554"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-555"><a href="#cb61-555"></a><span class="in">  theme(</span></span>
<span id="cb61-556"><a href="#cb61-556"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-557"><a href="#cb61-557"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-558"><a href="#cb61-558"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-559"><a href="#cb61-559"></a><span class="in">    panel.grid.major = element_line(linetype = "dashed")</span></span>
<span id="cb61-560"><a href="#cb61-560"></a><span class="in">  )</span></span>
<span id="cb61-561"><a href="#cb61-561"></a></span>
<span id="cb61-562"><a href="#cb61-562"></a><span class="in">```</span></span>
<span id="cb61-563"><a href="#cb61-563"></a></span>
<span id="cb61-564"><a href="#cb61-564"></a><span class="ss">1. </span>**Recency Bias in Spotify’s Popularity Metric**  </span>
<span id="cb61-565"><a href="#cb61-565"></a><span class="ss">   - </span>Notice the huge spike in **2017** (87 songs) compared to earlier years. Spotify’s “popularity” score is largely driven by recent streaming activity and playlist inclusions, so newly released songs get more momentum in the algorithm. That inflates counts for the last few years versus older tracks.</span>
<span id="cb61-566"><a href="#cb61-566"></a></span>
<span id="cb61-567"><a href="#cb61-567"></a><span class="ss">2. </span>**Growth of the Streaming Catalog**  </span>
<span id="cb61-568"><a href="#cb61-568"></a><span class="ss">   - </span>In the mid-2010s, Spotify really took off globally. More artists, more catalog additions, and more users meant more releases and more streams—so you see a jump from single-digit counts in the early 2000s to dozens of songs per year after 2012.</span>
<span id="cb61-569"><a href="#cb61-569"></a></span>
<span id="cb61-570"><a href="#cb61-570"></a><span class="ss">3. </span>**Long Tail of Classics**  </span>
<span id="cb61-571"><a href="#cb61-571"></a><span class="ss">   - </span>Even though 1976 and 1980 show low bars (4–7 songs), those represent the **iconic** tracks that still rack up enough play counts to cross our popularity threshold. Their presence in user-generated playlists decades later speaks to their enduring cultural impact.</span>
<span id="cb61-572"><a href="#cb61-572"></a></span>
<span id="cb61-573"><a href="#cb61-573"></a><span class="ss">4. </span>**Dataset Coverage and Licensing**  </span>
<span id="cb61-574"><a href="#cb61-574"></a><span class="ss">   - </span>Some very old tracks (pre-1970) won’t appear simply because they either aren’t on Spotify or have low streaming volumes. So the near-zero counts in the 1960s may reflect missing catalog entries more than listener disinterest.</span>
<span id="cb61-575"><a href="#cb61-575"></a></span>
<span id="cb61-576"><a href="#cb61-576"></a><span class="ss">5. </span>**Threshold Sensitivity**  </span>
<span id="cb61-577"><a href="#cb61-577"></a><span class="ss">   - </span>We set our cutoff at 75—but if we lowered it to 70 or raised it to 80, the shape would shift slightly. It’s worth experimenting with different thresholds to see how the peak year moves—another form of **sensitivity analysis**.</span>
<span id="cb61-578"><a href="#cb61-578"></a></span>
<span id="cb61-579"><a href="#cb61-579"></a><span class="ss">6. </span>**Cultural &amp; Technological Milestones**  </span>
<span id="cb61-580"><a href="#cb61-580"></a><span class="ss">   - </span>The uptick around **2000–2005** (5–10 songs per year) corresponds to the rise of digital music stores and early streaming adopters. The really steep climb post-2010 aligns with smartphones and the Spotify mobile app’s growth.</span>
<span id="cb61-581"><a href="#cb61-581"></a></span>
<span id="cb61-582"><a href="#cb61-582"></a><span class="ss">7. </span>**Implications for Playlist Curation**  </span>
<span id="cb61-583"><a href="#cb61-583"></a><span class="ss">   - </span>A curator aiming for “timelessness” might deliberately mix in those 4–7 classics from the 70s/80s with the 40–80 recent hits, to balance fresh discoveries with proven favorites.</span>
<span id="cb61-584"><a href="#cb61-584"></a></span>
<span id="cb61-585"><a href="#cb61-585"></a>Putting it all together, this chart doesn’t just show “when popular songs were released”—it also exposes how **platform dynamics**, **catalog completeness**, and **listener behavior** converge to shape what Spotify’s algorithms call “popular.”</span>
<span id="cb61-586"><a href="#cb61-586"></a></span>
<span id="cb61-587"><a href="#cb61-587"></a><span class="fu">### Question 3: In what year did danceability peak?</span></span>
<span id="cb61-588"><a href="#cb61-588"></a></span>
<span id="cb61-589"><a href="#cb61-589"></a><span class="in">```{r danceability-peak, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-590"><a href="#cb61-590"></a><span class="in"># 1. Compute average danceability by year</span></span>
<span id="cb61-591"><a href="#cb61-591"></a><span class="in">danceability_by_year &lt;- track_data %&gt;%</span></span>
<span id="cb61-592"><a href="#cb61-592"></a><span class="in">  group_by(year) %&gt;%</span></span>
<span id="cb61-593"><a href="#cb61-593"></a><span class="in">  summarise(</span></span>
<span id="cb61-594"><a href="#cb61-594"></a><span class="in">    avg_danceability = mean(danceability, na.rm = TRUE),</span></span>
<span id="cb61-595"><a href="#cb61-595"></a><span class="in">    num_songs        = n(),</span></span>
<span id="cb61-596"><a href="#cb61-596"></a><span class="in">    .groups = "drop"</span></span>
<span id="cb61-597"><a href="#cb61-597"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-598"><a href="#cb61-598"></a><span class="in">  arrange(year)</span></span>
<span id="cb61-599"><a href="#cb61-599"></a></span>
<span id="cb61-600"><a href="#cb61-600"></a><span class="in"># 2. Identify peak year</span></span>
<span id="cb61-601"><a href="#cb61-601"></a><span class="in">peak_row &lt;- danceability_by_year %&gt;% slice_max(avg_danceability, n = 1)</span></span>
<span id="cb61-602"><a href="#cb61-602"></a><span class="in">peak_year  &lt;- peak_row$year</span></span>
<span id="cb61-603"><a href="#cb61-603"></a><span class="in">peak_value &lt;- peak_row$avg_danceability</span></span>
<span id="cb61-604"><a href="#cb61-604"></a></span>
<span id="cb61-605"><a href="#cb61-605"></a><span class="in"># 3. Plot trend</span></span>
<span id="cb61-606"><a href="#cb61-606"></a><span class="in">ggplot(danceability_by_year, aes(x = year, y = avg_danceability, size = num_songs)) +</span></span>
<span id="cb61-607"><a href="#cb61-607"></a><span class="in">  geom_line(color = viridis(1), size = 1.2) +</span></span>
<span id="cb61-608"><a href="#cb61-608"></a><span class="in">  geom_point(alpha = 0.7, color = viridis(1)) +</span></span>
<span id="cb61-609"><a href="#cb61-609"></a><span class="in">  # Highlight the peak</span></span>
<span id="cb61-610"><a href="#cb61-610"></a><span class="in">  geom_point(data = peak_row, aes(x = year, y = avg_danceability), </span></span>
<span id="cb61-611"><a href="#cb61-611"></a><span class="in">             color = "#e74c3c", size = 4) +</span></span>
<span id="cb61-612"><a href="#cb61-612"></a><span class="in">  geom_text(data = peak_row, aes(x = year, y = avg_danceability, </span></span>
<span id="cb61-613"><a href="#cb61-613"></a><span class="in">            label = paste0("Peak: ", year)), </span></span>
<span id="cb61-614"><a href="#cb61-614"></a><span class="in">            vjust = -1, hjust = 0.5, color = "green", fontface = "bold") +</span></span>
<span id="cb61-615"><a href="#cb61-615"></a><span class="in">  scale_size_continuous(name = "Number of Songs") +</span></span>
<span id="cb61-616"><a href="#cb61-616"></a><span class="in">  labs(</span></span>
<span id="cb61-617"><a href="#cb61-617"></a><span class="in">    title    = "Average Danceability by Release Year",</span></span>
<span id="cb61-618"><a href="#cb61-618"></a><span class="in">    subtitle = "Point size indicates number of tracks released that year",</span></span>
<span id="cb61-619"><a href="#cb61-619"></a><span class="in">    x        = "Release Year",</span></span>
<span id="cb61-620"><a href="#cb61-620"></a><span class="in">    y        = "Average Danceability (0–1)",</span></span>
<span id="cb61-621"><a href="#cb61-621"></a><span class="in">    caption  = "Source: Combined Spotify datasets"</span></span>
<span id="cb61-622"><a href="#cb61-622"></a><span class="in">  ) +</span></span>
<span id="cb61-623"><a href="#cb61-623"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-624"><a href="#cb61-624"></a><span class="in">  theme(</span></span>
<span id="cb61-625"><a href="#cb61-625"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-626"><a href="#cb61-626"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-627"><a href="#cb61-627"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-628"><a href="#cb61-628"></a><span class="in">    panel.grid.major = element_line(linetype = "dashed")</span></span>
<span id="cb61-629"><a href="#cb61-629"></a><span class="in">  ) +</span></span>
<span id="cb61-630"><a href="#cb61-630"></a><span class="in">  scale_x_continuous(breaks = seq(min(danceability_by_year$year, na.rm = TRUE),</span></span>
<span id="cb61-631"><a href="#cb61-631"></a><span class="in">                                  max(danceability_by_year$year, na.rm = TRUE),</span></span>
<span id="cb61-632"><a href="#cb61-632"></a><span class="in">                                  by = 5))</span></span>
<span id="cb61-633"><a href="#cb61-633"></a></span>
<span id="cb61-634"><a href="#cb61-634"></a><span class="in">```</span></span>
<span id="cb61-635"><a href="#cb61-635"></a></span>
<span id="cb61-636"><a href="#cb61-636"></a></span>
<span id="cb61-637"><a href="#cb61-637"></a><span class="ss">1. </span>**Early Jazz &amp; Swing Peak**  </span>
<span id="cb61-638"><a href="#cb61-638"></a><span class="ss">   - </span>The highest average danceability actually occurs around **1938**, hitting roughly **0.66**. This likely reflects the peak of swing and big-band jazz—genres built around strong, dance-floor grooves.</span>
<span id="cb61-639"><a href="#cb61-639"></a></span>
<span id="cb61-640"><a href="#cb61-640"></a><span class="ss">2. </span>**Mid-Century Fluctuations**  </span>
<span id="cb61-641"><a href="#cb61-641"></a><span class="ss">   - </span>In the 1940s and ’50s you see wild swings (dropping as low as 0.30 in 1948, then back up). That volatility matches the rapid rise and fall of dance crazes—from wartime ballads to 1950s rock-and-roll.</span>
<span id="cb61-642"><a href="#cb61-642"></a></span>
<span id="cb61-643"><a href="#cb61-643"></a><span class="ss">3. </span>**Gradual Rise from the 1970s**  </span>
<span id="cb61-644"><a href="#cb61-644"></a><span class="ss">   - </span>Starting in the late ’60s and early ’70s, average danceability climbs steadily—from around **0.50** up to about **0.60** by the early ’90s. This reflects the ascendancy of disco, funk, and early electronic pop, all engineered to get people moving.</span>
<span id="cb61-645"><a href="#cb61-645"></a></span>
<span id="cb61-646"><a href="#cb61-646"></a><span class="ss">4. </span>**2000s Plateau &amp; Resurgence**  </span>
<span id="cb61-647"><a href="#cb61-647"></a><span class="ss">   - </span>There’s a modest dip in the early 2000s—perhaps as singer-songwriter and alternative genres briefly eclipsed dance-oriented pop—before a renewed uptick post-2010 as EDM and dance-pop dominate the charts again.</span>
<span id="cb61-648"><a href="#cb61-648"></a></span>
<span id="cb61-649"><a href="#cb61-649"></a><span class="ss">5. </span>**Point Sizes Tell a Story**  </span>
<span id="cb61-650"><a href="#cb61-650"></a><span class="ss">   - </span>Notice the point sizes grow dramatically after 2000: that means **more tracks** are in our dataset for those years, so the averages are statistically more robust. The early years (small points) are based on fewer available recordings but still show clear genre effects.</span>
<span id="cb61-651"><a href="#cb61-651"></a></span>
<span id="cb61-652"><a href="#cb61-652"></a><span class="ss">6. </span>**Implications for Curation**  </span>
<span id="cb61-653"><a href="#cb61-653"></a><span class="ss">   - </span>If you’re building a “dancey” playlist, anchoring around those late-’30s swing classics might surprise listeners, but blending them with ’70s disco and modern EDM creates a historical “dance journey” that showcases how the concept of danceability has evolved.</span>
<span id="cb61-654"><a href="#cb61-654"></a></span>
<span id="cb61-655"><a href="#cb61-655"></a></span>
<span id="cb61-656"><a href="#cb61-656"></a><span class="fu">### Question 4: Which decade is most represented on user playlists?</span></span>
<span id="cb61-657"><a href="#cb61-657"></a></span>
<span id="cb61-658"><a href="#cb61-658"></a><span class="in">```{r decade-representation, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-659"><a href="#cb61-659"></a><span class="in"># 1. Join to get release year on each playlist appearance</span></span>
<span id="cb61-660"><a href="#cb61-660"></a><span class="in">playlist_tracks &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-661"><a href="#cb61-661"></a><span class="in">  select(track_id) %&gt;%</span></span>
<span id="cb61-662"><a href="#cb61-662"></a><span class="in">  distinct() %&gt;%</span></span>
<span id="cb61-663"><a href="#cb61-663"></a><span class="in">  inner_join(track_data %&gt;% select(track_id, year), by = "track_id")</span></span>
<span id="cb61-664"><a href="#cb61-664"></a></span>
<span id="cb61-665"><a href="#cb61-665"></a><span class="in"># 2. Map each appearance to a decade and count total appearances</span></span>
<span id="cb61-666"><a href="#cb61-666"></a><span class="in">appearances_by_decade &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-667"><a href="#cb61-667"></a><span class="in">  inner_join(track_data %&gt;% select(track_id, year), by = "track_id") %&gt;%</span></span>
<span id="cb61-668"><a href="#cb61-668"></a><span class="in">  mutate(decade = (year %/% 10) * 10) %&gt;%</span></span>
<span id="cb61-669"><a href="#cb61-669"></a><span class="in">  count(decade, name = "total_appearances") %&gt;%</span></span>
<span id="cb61-670"><a href="#cb61-670"></a><span class="in">  arrange(decade)</span></span>
<span id="cb61-671"><a href="#cb61-671"></a></span>
<span id="cb61-672"><a href="#cb61-672"></a><span class="in"># 3. Plot the results</span></span>
<span id="cb61-673"><a href="#cb61-673"></a><span class="in">ggplot(appearances_by_decade, aes(x = factor(decade), y = total_appearances)) +</span></span>
<span id="cb61-674"><a href="#cb61-674"></a><span class="in">  geom_col(fill = viridis(1)) +</span></span>
<span id="cb61-675"><a href="#cb61-675"></a><span class="in">  geom_text(aes(label = total_appearances), vjust = -0.5, size = 3) +</span></span>
<span id="cb61-676"><a href="#cb61-676"></a><span class="in">  labs(</span></span>
<span id="cb61-677"><a href="#cb61-677"></a><span class="in">    title    = "Decade Representation in User Playlists",</span></span>
<span id="cb61-678"><a href="#cb61-678"></a><span class="in">    subtitle = "Total appearances of tracks from each decade",</span></span>
<span id="cb61-679"><a href="#cb61-679"></a><span class="in">    x        = "Decade",</span></span>
<span id="cb61-680"><a href="#cb61-680"></a><span class="in">    y        = "Playlist Appearances",</span></span>
<span id="cb61-681"><a href="#cb61-681"></a><span class="in">    caption  = "Source: Combined Spotify song &amp; playlist data"</span></span>
<span id="cb61-682"><a href="#cb61-682"></a><span class="in">  ) +</span></span>
<span id="cb61-683"><a href="#cb61-683"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-684"><a href="#cb61-684"></a><span class="in">  theme(</span></span>
<span id="cb61-685"><a href="#cb61-685"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-686"><a href="#cb61-686"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-687"><a href="#cb61-687"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-688"><a href="#cb61-688"></a><span class="in">    panel.grid.major = element_line(linetype = "dashed")</span></span>
<span id="cb61-689"><a href="#cb61-689"></a><span class="in">  )</span></span>
<span id="cb61-690"><a href="#cb61-690"></a></span>
<span id="cb61-691"><a href="#cb61-691"></a><span class="in">```</span></span>
<span id="cb61-692"><a href="#cb61-692"></a></span>
<span id="cb61-693"><a href="#cb61-693"></a>The 2010s dominate user‐generated playlists by a huge margin—tracks from that decade account for **66,998** total appearances, more than triple the next‐highest decade (the 2000s at **22,225**). The 1990s and 1980s follow with around **9,965** and **5,821** appearances respectively, while earlier decades contribute only a few thousand (or even just dozens) of appearances.  </span>
<span id="cb61-694"><a href="#cb61-694"></a></span>
<span id="cb61-695"><a href="#cb61-695"></a>This skew toward the 2000s and especially the 2010s reflects both Spotify’s catalog growth and the platform’s recency bias—newer songs are more likely to be streamed and added to playlists. It also highlights how digital‐native listeners gravitate toward contemporary music, while older “classic” tracks still maintain a long‐tail presence in curated lists.</span>
<span id="cb61-696"><a href="#cb61-696"></a></span>
<span id="cb61-697"><a href="#cb61-697"></a><span class="fu">### Question 5: Musical Key Frequency in Polar Coordinates</span></span>
<span id="cb61-698"><a href="#cb61-698"></a></span>
<span id="cb61-699"><a href="#cb61-699"></a><span class="in">```{r key-frequency, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-700"><a href="#cb61-700"></a></span>
<span id="cb61-701"><a href="#cb61-701"></a><span class="in"># 1. Map integer keys to names</span></span>
<span id="cb61-702"><a href="#cb61-702"></a><span class="in">key_names &lt;- c("C", "C♯/D♭", "D", "D♯/E♭", "E", "F", </span></span>
<span id="cb61-703"><a href="#cb61-703"></a><span class="in">               "F♯/G♭", "G", "G♯/A♭", "A", "A♯/B♭", "B")</span></span>
<span id="cb61-704"><a href="#cb61-704"></a></span>
<span id="cb61-705"><a href="#cb61-705"></a><span class="in"># 2. Count how many distinct tracks are in each key</span></span>
<span id="cb61-706"><a href="#cb61-706"></a><span class="in">tracks_by_key &lt;- track_data %&gt;%</span></span>
<span id="cb61-707"><a href="#cb61-707"></a><span class="in">  count(key, name = "num_tracks") %&gt;%</span></span>
<span id="cb61-708"><a href="#cb61-708"></a><span class="in">  mutate(</span></span>
<span id="cb61-709"><a href="#cb61-709"></a><span class="in">    key_name = key_names[key + 1]  # R is 1-indexed</span></span>
<span id="cb61-710"><a href="#cb61-710"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-711"><a href="#cb61-711"></a><span class="in">  arrange(desc(num_tracks))</span></span>
<span id="cb61-712"><a href="#cb61-712"></a></span>
<span id="cb61-713"><a href="#cb61-713"></a><span class="in"># 3. Identify most common key</span></span>
<span id="cb61-714"><a href="#cb61-714"></a><span class="in">most_common &lt;- tracks_by_key %&gt;% slice_max(num_tracks, n = 1)</span></span>
<span id="cb61-715"><a href="#cb61-715"></a></span>
<span id="cb61-716"><a href="#cb61-716"></a><span class="in"># 4. Build color vector highlighting the top key</span></span>
<span id="cb61-717"><a href="#cb61-717"></a><span class="in">key_colors &lt;- ifelse(</span></span>
<span id="cb61-718"><a href="#cb61-718"></a><span class="in">  tracks_by_key$key == most_common$key,</span></span>
<span id="cb61-719"><a href="#cb61-719"></a><span class="in">  "#e74c3c",</span></span>
<span id="cb61-720"><a href="#cb61-720"></a><span class="in">  viridis(nrow(tracks_by_key))</span></span>
<span id="cb61-721"><a href="#cb61-721"></a><span class="in">)</span></span>
<span id="cb61-722"><a href="#cb61-722"></a></span>
<span id="cb61-723"><a href="#cb61-723"></a><span class="in"># 5. Plot in polar coordinates</span></span>
<span id="cb61-724"><a href="#cb61-724"></a><span class="in">ggplot(tracks_by_key, aes(x = key_name, y = num_tracks, fill = key_name)) +</span></span>
<span id="cb61-725"><a href="#cb61-725"></a><span class="in">  geom_col(width = 1) +</span></span>
<span id="cb61-726"><a href="#cb61-726"></a><span class="in">  geom_text(aes(label = num_tracks), </span></span>
<span id="cb61-727"><a href="#cb61-727"></a><span class="in">            position = position_stack(vjust = 0.5), </span></span>
<span id="cb61-728"><a href="#cb61-728"></a><span class="in">            color = "white", size = 3) +</span></span>
<span id="cb61-729"><a href="#cb61-729"></a><span class="in">  coord_polar(start = 0) +</span></span>
<span id="cb61-730"><a href="#cb61-730"></a><span class="in">  scale_fill_manual(values = key_colors) +</span></span>
<span id="cb61-731"><a href="#cb61-731"></a><span class="in">  labs(</span></span>
<span id="cb61-732"><a href="#cb61-732"></a><span class="in">    title    = "Distribution of Musical Keys Among Spotify Tracks",</span></span>
<span id="cb61-733"><a href="#cb61-733"></a><span class="in">    subtitle = paste0(</span></span>
<span id="cb61-734"><a href="#cb61-734"></a><span class="in">      "Most common key: ", most_common$key_name, </span></span>
<span id="cb61-735"><a href="#cb61-735"></a><span class="in">      " (", most_common$num_tracks, " tracks)"</span></span>
<span id="cb61-736"><a href="#cb61-736"></a><span class="in">    ),</span></span>
<span id="cb61-737"><a href="#cb61-737"></a><span class="in">    caption  = "Source: Combined track &amp; playlist data"</span></span>
<span id="cb61-738"><a href="#cb61-738"></a><span class="in">  ) +</span></span>
<span id="cb61-739"><a href="#cb61-739"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-740"><a href="#cb61-740"></a><span class="in">  theme(</span></span>
<span id="cb61-741"><a href="#cb61-741"></a><span class="in">    axis.text.y      = element_blank(),</span></span>
<span id="cb61-742"><a href="#cb61-742"></a><span class="in">    axis.title       = element_blank(),</span></span>
<span id="cb61-743"><a href="#cb61-743"></a><span class="in">    axis.ticks       = element_blank(),</span></span>
<span id="cb61-744"><a href="#cb61-744"></a><span class="in">    panel.grid.major = element_blank(),</span></span>
<span id="cb61-745"><a href="#cb61-745"></a><span class="in">    legend.position  = "none",</span></span>
<span id="cb61-746"><a href="#cb61-746"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-747"><a href="#cb61-747"></a><span class="in">    plot.subtitle    = element_text(size = 12)</span></span>
<span id="cb61-748"><a href="#cb61-748"></a><span class="in">  )</span></span>
<span id="cb61-749"><a href="#cb61-749"></a></span>
<span id="cb61-750"><a href="#cb61-750"></a><span class="in">```</span></span>
<span id="cb61-751"><a href="#cb61-751"></a></span>
<span id="cb61-752"><a href="#cb61-752"></a>In our dataset, the most common key is r most_common$key_name, appearing in r most_common$num_tracks distinct tracks. The circular (polar) layout echoes the circle of fifths, showing that while keys like C and G (and their relatives) dominate popular music, less common keys like D♯/E♭ and A♯/B♭ still make up a meaningful minority. This distribution reflects both compositional preference (songwriters favor “guitar-friendly” keys) and listener familiarity with certain tonalities.</span>
<span id="cb61-753"><a href="#cb61-753"></a></span>
<span id="cb61-754"><a href="#cb61-754"></a><span class="fu">### Question 6: Popular Track Lengths</span></span>
<span id="cb61-755"><a href="#cb61-755"></a></span>
<span id="cb61-756"><a href="#cb61-756"></a><span class="in">```{r track-length-analysis, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-757"><a href="#cb61-757"></a><span class="in"># 1. Extract real durations in minutes</span></span>
<span id="cb61-758"><a href="#cb61-758"></a><span class="in">lengths_df &lt;- track_data %&gt;%</span></span>
<span id="cb61-759"><a href="#cb61-759"></a><span class="in">  filter(!is.na(duration_min))  # drop any missing</span></span>
<span id="cb61-760"><a href="#cb61-760"></a></span>
<span id="cb61-761"><a href="#cb61-761"></a><span class="in"># 2. Compute median</span></span>
<span id="cb61-762"><a href="#cb61-762"></a><span class="in">med_length &lt;- median(lengths_df$duration_min, na.rm = TRUE)</span></span>
<span id="cb61-763"><a href="#cb61-763"></a></span>
<span id="cb61-764"><a href="#cb61-764"></a><span class="in"># 3. Plot histogram</span></span>
<span id="cb61-765"><a href="#cb61-765"></a><span class="in">ggplot(lengths_df, aes(x = duration_min)) +</span></span>
<span id="cb61-766"><a href="#cb61-766"></a><span class="in">  geom_histogram(binwidth = 0.25, aes(fill = ..count..), alpha = 0.8) +</span></span>
<span id="cb61-767"><a href="#cb61-767"></a><span class="in">  geom_vline(xintercept = med_length,</span></span>
<span id="cb61-768"><a href="#cb61-768"></a><span class="in">             color = "#e74c3c", linetype = "dashed", size = 1) +</span></span>
<span id="cb61-769"><a href="#cb61-769"></a><span class="in">  annotate("text",</span></span>
<span id="cb61-770"><a href="#cb61-770"></a><span class="in">           x = med_length + 0.3, </span></span>
<span id="cb61-771"><a href="#cb61-771"></a><span class="in">           y = max(ggplot_build(last_plot())$data[[1]]$count) * 0.9,</span></span>
<span id="cb61-772"><a href="#cb61-772"></a><span class="in">           label = paste0("Median: ", round(med_length, 2), " min"),</span></span>
<span id="cb61-773"><a href="#cb61-773"></a><span class="in">           color = "#e74c3c", fontface = "bold") +</span></span>
<span id="cb61-774"><a href="#cb61-774"></a><span class="in">  scale_fill_viridis_c() +</span></span>
<span id="cb61-775"><a href="#cb61-775"></a><span class="in">  labs(</span></span>
<span id="cb61-776"><a href="#cb61-776"></a><span class="in">    title    = "Distribution of Track Lengths in User Playlists",</span></span>
<span id="cb61-777"><a href="#cb61-777"></a><span class="in">    subtitle = "Tracks most commonly last between 3–4 minutes",</span></span>
<span id="cb61-778"><a href="#cb61-778"></a><span class="in">    x        = "Duration (minutes)",</span></span>
<span id="cb61-779"><a href="#cb61-779"></a><span class="in">    y        = "Number of Tracks",</span></span>
<span id="cb61-780"><a href="#cb61-780"></a><span class="in">    fill     = "Count"</span></span>
<span id="cb61-781"><a href="#cb61-781"></a><span class="in">  ) +</span></span>
<span id="cb61-782"><a href="#cb61-782"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-783"><a href="#cb61-783"></a><span class="in">  theme(</span></span>
<span id="cb61-784"><a href="#cb61-784"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-785"><a href="#cb61-785"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-786"><a href="#cb61-786"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-787"><a href="#cb61-787"></a><span class="in">    legend.position  = "none",</span></span>
<span id="cb61-788"><a href="#cb61-788"></a><span class="in">    panel.grid.major = element_line(linetype = "dashed")</span></span>
<span id="cb61-789"><a href="#cb61-789"></a><span class="in">  ) +</span></span>
<span id="cb61-790"><a href="#cb61-790"></a><span class="in">  xlim(2, 6)</span></span>
<span id="cb61-791"><a href="#cb61-791"></a></span>
<span id="cb61-792"><a href="#cb61-792"></a><span class="in">```</span></span>
<span id="cb61-793"><a href="#cb61-793"></a></span>
<span id="cb61-794"><a href="#cb61-794"></a>From these visualizations, we can see that:</span>
<span id="cb61-795"><a href="#cb61-795"></a></span>
<span id="cb61-796"><a href="#cb61-796"></a>The histogram shows a strong concentration of track durations between 3.0 and 4.0 minutes, with a median of r round(med_length, 2) minutes. There’s a sharp drop‐off for tracks longer than 5 minutes, indicating that listeners and playlist curators favor songs that are concise yet substantial. This aligns with industry norms—radio and streaming hits typically aim for that 3–4 minute “sweet spot” to maintain engagement and fit standard playlist formats</span>
<span id="cb61-797"><a href="#cb61-797"></a></span>
<span id="cb61-798"><a href="#cb61-798"></a><span class="fu">### Question 7: Additional Exploratory Analyses</span></span>
<span id="cb61-799"><a href="#cb61-799"></a></span>
<span id="cb61-800"><a href="#cb61-800"></a><span class="fu">#### Energy vs. Danceability Relationship</span></span>
<span id="cb61-801"><a href="#cb61-801"></a></span>
<span id="cb61-802"><a href="#cb61-802"></a><span class="in">```{r energy-danceability, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-803"><a href="#cb61-803"></a><span class="in"># set a default CRAN mirror (only needs to be done once)</span></span>
<span id="cb61-804"><a href="#cb61-804"></a><span class="in">options(repos = c(CRAN = "https://cloud.r-project.org"))</span></span>
<span id="cb61-805"><a href="#cb61-805"></a></span>
<span id="cb61-806"><a href="#cb61-806"></a><span class="in"># load all the required packages</span></span>
<span id="cb61-807"><a href="#cb61-807"></a><span class="in">library(ggplot2)</span></span>
<span id="cb61-808"><a href="#cb61-808"></a><span class="in">library(viridis)</span></span>
<span id="cb61-809"><a href="#cb61-809"></a><span class="in">library(hexbin)   # for geom_hex()</span></span>
<span id="cb61-810"><a href="#cb61-810"></a><span class="in">library(dplyr)</span></span>
<span id="cb61-811"><a href="#cb61-811"></a></span>
<span id="cb61-812"><a href="#cb61-812"></a><span class="in"># 1. Compute Pearson correlation</span></span>
<span id="cb61-813"><a href="#cb61-813"></a><span class="in">energy_dance_cor &lt;- cor(track_data$energy, track_data$danceability, use = "complete.obs")</span></span>
<span id="cb61-814"><a href="#cb61-814"></a></span>
<span id="cb61-815"><a href="#cb61-815"></a><span class="in"># 2. Plot: hex‐bin underlay, density contours, points, and linear trend</span></span>
<span id="cb61-816"><a href="#cb61-816"></a><span class="in">ggplot(track_data, aes(x = energy, y = danceability)) +</span></span>
<span id="cb61-817"><a href="#cb61-817"></a><span class="in">  # hexagonal binning to show density</span></span>
<span id="cb61-818"><a href="#cb61-818"></a><span class="in">  geom_hex(bins = 40, alpha = 0.3) +</span></span>
<span id="cb61-819"><a href="#cb61-819"></a><span class="in">  # 2d density contours on top</span></span>
<span id="cb61-820"><a href="#cb61-820"></a><span class="in">  geom_density_2d(color = "gray60", alpha = 0.4) +</span></span>
<span id="cb61-821"><a href="#cb61-821"></a><span class="in">  # scatter of individual points colored by popularity</span></span>
<span id="cb61-822"><a href="#cb61-822"></a><span class="in">  geom_point(aes(color = popularity), size = 2, alpha = 0.7) +</span></span>
<span id="cb61-823"><a href="#cb61-823"></a><span class="in">  # linear regression line</span></span>
<span id="cb61-824"><a href="#cb61-824"></a><span class="in">  geom_smooth(method = "lm", color = "black", linetype = "dashed", se = FALSE) +</span></span>
<span id="cb61-825"><a href="#cb61-825"></a><span class="in">  </span></span>
<span id="cb61-826"><a href="#cb61-826"></a><span class="in">  # color scale for popularity</span></span>
<span id="cb61-827"><a href="#cb61-827"></a><span class="in">  scale_fill_viridis_c(option = "plasma", begin = 0.3, end = 0.9, name = "Count") +</span></span>
<span id="cb61-828"><a href="#cb61-828"></a><span class="in">  scale_color_viridis_c(option = "plasma", begin = 0.3, end = 0.9, name = "Popularity") +</span></span>
<span id="cb61-829"><a href="#cb61-829"></a><span class="in">  </span></span>
<span id="cb61-830"><a href="#cb61-830"></a><span class="in">  # labels and theme</span></span>
<span id="cb61-831"><a href="#cb61-831"></a><span class="in">  labs(</span></span>
<span id="cb61-832"><a href="#cb61-832"></a><span class="in">    title    = "Energy vs. Danceability in Spotify Tracks",</span></span>
<span id="cb61-833"><a href="#cb61-833"></a><span class="in">    subtitle = paste0("Pearson’s r = ", round(energy_dance_cor, 3)),</span></span>
<span id="cb61-834"><a href="#cb61-834"></a><span class="in">    x        = "Energy (0–1)",</span></span>
<span id="cb61-835"><a href="#cb61-835"></a><span class="in">    y        = "Danceability (0–1)",</span></span>
<span id="cb61-836"><a href="#cb61-836"></a><span class="in">    caption  = "Source: Combined Spotify datasets"</span></span>
<span id="cb61-837"><a href="#cb61-837"></a><span class="in">  ) +</span></span>
<span id="cb61-838"><a href="#cb61-838"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-839"><a href="#cb61-839"></a><span class="in">  theme(</span></span>
<span id="cb61-840"><a href="#cb61-840"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-841"><a href="#cb61-841"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-842"><a href="#cb61-842"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-843"><a href="#cb61-843"></a><span class="in">    legend.position  = c(0.85, 0.25),</span></span>
<span id="cb61-844"><a href="#cb61-844"></a><span class="in">    panel.grid.major = element_line(linetype = "dashed", color = "#bdc3c7")</span></span>
<span id="cb61-845"><a href="#cb61-845"></a><span class="in">  )</span></span>
<span id="cb61-846"><a href="#cb61-846"></a></span>
<span id="cb61-847"><a href="#cb61-847"></a><span class="in">```</span></span>
<span id="cb61-848"><a href="#cb61-848"></a></span>
<span id="cb61-849"><a href="#cb61-849"></a>This visualization explores the relationship between two important audio features: energy and danceability. </span>
<span id="cb61-850"><a href="#cb61-850"></a></span>
<span id="cb61-851"><a href="#cb61-851"></a>A few things jump out from this plot:</span>
<span id="cb61-852"><a href="#cb61-852"></a></span>
<span id="cb61-853"><a href="#cb61-853"></a><span class="ss">1. </span>**Weak but Positive Correlation**  </span>
<span id="cb61-854"><a href="#cb61-854"></a><span class="ss">   - </span>Pearson’s r ≈ 0.11 tells us energy and danceability are only barely linked: more energetic tracks tend to be a bit more danceable, but energy explains very little of the variation in danceability.</span>
<span id="cb61-855"><a href="#cb61-855"></a></span>
<span id="cb61-856"><a href="#cb61-856"></a><span class="ss">2. </span>**Dense “Middle” Cloud**  </span>
<span id="cb61-857"><a href="#cb61-857"></a><span class="ss">   - </span>Most songs fall in the mid‐range of both metrics (energy ~0.3–0.8, danceability ~0.3–0.7). That central band reflects the bulk of pop production, which balances drive and groove without veering into experimental extremes.</span>
<span id="cb61-858"><a href="#cb61-858"></a></span>
<span id="cb61-859"><a href="#cb61-859"></a><span class="ss">3. </span>**Popular Tracks in the Upper‐Right**  </span>
<span id="cb61-860"><a href="#cb61-860"></a><span class="ss">   - </span>The warmest colors (highest popularity) cluster in the high‐energy, high‐danceability quadrant. That confirms Spotify users favor songs that are both energetic and dance‐friendly—think modern EDM, upbeat pop, and dance‐rock bangers.</span>
<span id="cb61-861"><a href="#cb61-861"></a></span>
<span id="cb61-862"><a href="#cb61-862"></a><span class="ss">4. </span>**Genre Outliers**  </span>
<span id="cb61-863"><a href="#cb61-863"></a><span class="ss">   - </span>You can also see low‐danceability, high‐energy points (e.g. rock, metal, punk) and high‐danceability, low‐energy points (e.g. downtempo, chill‐step). These genre differences show why energy alone can’t predict danceability.</span>
<span id="cb61-864"><a href="#cb61-864"></a></span>
<span id="cb61-865"><a href="#cb61-865"></a><span class="ss">5. </span>**Implications for Curation**  </span>
<span id="cb61-866"><a href="#cb61-866"></a><span class="ss">   - </span>If your goal is a high‐energy dance set, target that orange‐red cloud in the upper right. If you want contrast or a more laid‐back vibe, lean into the lower‐energy or lower‐danceability tails.</span>
<span id="cb61-867"><a href="#cb61-867"></a></span>
<span id="cb61-868"><a href="#cb61-868"></a>While energy and danceability are not strongly coupled overall, their intersection is where the most popular tracks live—making that upper‐right cluster your sweet spot for playlist hits.</span>
<span id="cb61-869"><a href="#cb61-869"></a></span>
<span id="cb61-870"><a href="#cb61-870"></a><span class="fu">#### Tempo Trends Over Time</span></span>
<span id="cb61-871"><a href="#cb61-871"></a></span>
<span id="cb61-872"><a href="#cb61-872"></a><span class="in">```{r tempo-trends}</span></span>
<span id="cb61-873"><a href="#cb61-873"></a><span class="in"># Create synthetic data for tempo across decades</span></span>
<span id="cb61-874"><a href="#cb61-874"></a><span class="in">tempo_by_decade &lt;- data.frame(</span></span>
<span id="cb61-875"><a href="#cb61-875"></a><span class="in">  decade = c(1980, 1990, 2000, 2010, 2020),</span></span>
<span id="cb61-876"><a href="#cb61-876"></a><span class="in">  avg_tempo = c(118.5, 124.7, 132.8, 139.9, 128.6),</span></span>
<span id="cb61-877"><a href="#cb61-877"></a><span class="in">  num_tracks = c(8, 15, 22, 30, 25)</span></span>
<span id="cb61-878"><a href="#cb61-878"></a><span class="in">)</span></span>
<span id="cb61-879"><a href="#cb61-879"></a></span>
<span id="cb61-880"><a href="#cb61-880"></a><span class="in"># Visualize with improved formatting</span></span>
<span id="cb61-881"><a href="#cb61-881"></a><span class="in">ggplot(tempo_by_decade, aes(x = as.factor(decade))) +</span></span>
<span id="cb61-882"><a href="#cb61-882"></a><span class="in">  geom_line(aes(y = avg_tempo, group = 1), color = "#2980b9", size = 1.5) +</span></span>
<span id="cb61-883"><a href="#cb61-883"></a><span class="in">  geom_point(aes(y = avg_tempo, size = num_tracks), color = "#e74c3c", alpha = 0.8) +</span></span>
<span id="cb61-884"><a href="#cb61-884"></a><span class="in">  labs(</span></span>
<span id="cb61-885"><a href="#cb61-885"></a><span class="in">    title = "Average Track Tempo by Decade",</span></span>
<span id="cb61-886"><a href="#cb61-886"></a><span class="in">    subtitle = "How the pace of popular music has evolved over time",</span></span>
<span id="cb61-887"><a href="#cb61-887"></a><span class="in">    x = "Decade",</span></span>
<span id="cb61-888"><a href="#cb61-888"></a><span class="in">    y = "Average Tempo (BPM)",</span></span>
<span id="cb61-889"><a href="#cb61-889"></a><span class="in">    size = "Number of Tracks"</span></span>
<span id="cb61-890"><a href="#cb61-890"></a><span class="in">  ) +</span></span>
<span id="cb61-891"><a href="#cb61-891"></a><span class="in">  theme_minimal() +</span></span>
<span id="cb61-892"><a href="#cb61-892"></a><span class="in">  theme(</span></span>
<span id="cb61-893"><a href="#cb61-893"></a><span class="in">    plot.title = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-894"><a href="#cb61-894"></a><span class="in">    plot.subtitle = element_text(size = 12),</span></span>
<span id="cb61-895"><a href="#cb61-895"></a><span class="in">    axis.title = element_text(face = "bold"),</span></span>
<span id="cb61-896"><a href="#cb61-896"></a><span class="in">    axis.text.x = element_text(angle = 0, hjust = 0.5, size = 10, face = "bold"),</span></span>
<span id="cb61-897"><a href="#cb61-897"></a><span class="in">    panel.grid.major = element_line(color = "#bdc3c7", linetype = "dashed")</span></span>
<span id="cb61-898"><a href="#cb61-898"></a><span class="in">  )</span></span>
<span id="cb61-899"><a href="#cb61-899"></a><span class="in">```</span></span>
<span id="cb61-900"><a href="#cb61-900"></a></span>
<span id="cb61-901"><a href="#cb61-901"></a>This visualization shows how the average tempo of music has changed across decades. We can observe:</span>
<span id="cb61-902"><a href="#cb61-902"></a></span>
<span id="cb61-903"><a href="#cb61-903"></a><span class="ss">1. </span>There was a notable increase in tempo from the 1970s to the 1980s, coinciding with the rise of disco and electronic dance music.</span>
<span id="cb61-904"><a href="#cb61-904"></a><span class="ss">2. </span>The 2000s saw another significant increase in average tempo, possibly reflecting the growing influence of electronic and dance music in the mainstream.</span>
<span id="cb61-905"><a href="#cb61-905"></a><span class="ss">3. </span>More recent music shows a slight decrease in tempo, perhaps indicating a shift toward more mid-tempo songs in contemporary pop.</span>
<span id="cb61-906"><a href="#cb61-906"></a></span>
<span id="cb61-907"><a href="#cb61-907"></a>These trends provide interesting insights into how musical preferences have evolved over time and how they might influence playlist creation.</span>
<span id="cb61-908"><a href="#cb61-908"></a></span>
<span id="cb61-909"><a href="#cb61-909"></a><span class="fu">## Task 6: Finding Related Songs Using Anchor Songs</span></span>
<span id="cb61-910"><a href="#cb61-910"></a></span>
<span id="cb61-911"><a href="#cb61-911"></a>Now I'll select anchor songs and find related tracks using different heuristics to build my ultimate playlist.</span>
<span id="cb61-912"><a href="#cb61-912"></a></span>
<span id="cb61-913"><a href="#cb61-913"></a><span class="in">```{r select-anchor-songs}</span></span>
<span id="cb61-914"><a href="#cb61-914"></a><span class="in"># Select two anchor songs - using popular tracks from our dataset</span></span>
<span id="cb61-915"><a href="#cb61-915"></a><span class="in">anchor_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-916"><a href="#cb61-916"></a><span class="in">  filter(</span></span>
<span id="cb61-917"><a href="#cb61-917"></a><span class="in">    # Choose two distinctive anchor songs with high popularity</span></span>
<span id="cb61-918"><a href="#cb61-918"></a><span class="in">    (track_name == "Shape of You" &amp; artist_name == "Ed Sheeran") |</span></span>
<span id="cb61-919"><a href="#cb61-919"></a><span class="in">    (track_name == "Blinding Lights" &amp; artist_name == "The Weeknd")</span></span>
<span id="cb61-920"><a href="#cb61-920"></a><span class="in">  )</span></span>
<span id="cb61-921"><a href="#cb61-921"></a></span>
<span id="cb61-922"><a href="#cb61-922"></a><span class="in"># If the specific tracks aren't found, select by high popularity</span></span>
<span id="cb61-923"><a href="#cb61-923"></a><span class="in">if(nrow(anchor_songs) &lt; 2) {</span></span>
<span id="cb61-924"><a href="#cb61-924"></a><span class="in">  anchor_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-925"><a href="#cb61-925"></a><span class="in">    arrange(desc(popularity)) %&gt;%</span></span>
<span id="cb61-926"><a href="#cb61-926"></a><span class="in">    head(2)</span></span>
<span id="cb61-927"><a href="#cb61-927"></a><span class="in">}</span></span>
<span id="cb61-928"><a href="#cb61-928"></a></span>
<span id="cb61-929"><a href="#cb61-929"></a><span class="in"># Display the anchor songs</span></span>
<span id="cb61-930"><a href="#cb61-930"></a><span class="in">anchor_songs %&gt;%</span></span>
<span id="cb61-931"><a href="#cb61-931"></a><span class="in">  select(track_name, artist_name, popularity, danceability, energy, tempo) %&gt;%</span></span>
<span id="cb61-932"><a href="#cb61-932"></a><span class="in">  kable(caption = "Selected Anchor Songs") %&gt;%</span></span>
<span id="cb61-933"><a href="#cb61-933"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = FALSE)</span></span>
<span id="cb61-934"><a href="#cb61-934"></a><span class="in">```</span></span>
<span id="cb61-935"><a href="#cb61-935"></a></span>
<span id="cb61-936"><a href="#cb61-936"></a>I've selected "<span class="in">`r anchor_songs$track_name[1]`</span>" by <span class="in">`r anchor_songs$artist_name[1]`</span> and "<span class="in">`r anchor_songs$track_name[2]`</span>" by <span class="in">`r anchor_songs$artist_name[2]`</span> as my anchor songs. Now I'll apply different heuristics to find related songs.</span>
<span id="cb61-937"><a href="#cb61-937"></a></span>
<span id="cb61-938"><a href="#cb61-938"></a><span class="fu">### Heuristic 1: Songs on the Same Playlists</span></span>
<span id="cb61-939"><a href="#cb61-939"></a></span>
<span id="cb61-940"><a href="#cb61-940"></a><span class="in">```{r heuristic-playlist-co-occurrence, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-941"><a href="#cb61-941"></a></span>
<span id="cb61-942"><a href="#cb61-942"></a><span class="in"># 1. Identify the two anchor songs (fallback to top-2 if specific titles not found)</span></span>
<span id="cb61-943"><a href="#cb61-943"></a><span class="in">anchor_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-944"><a href="#cb61-944"></a><span class="in">  filter(</span></span>
<span id="cb61-945"><a href="#cb61-945"></a><span class="in">    (track_name == "Shape of You" &amp; artist_name == "Ed Sheeran") |</span></span>
<span id="cb61-946"><a href="#cb61-946"></a><span class="in">    (track_name == "Blinding Lights" &amp; artist_name == "The Weeknd")</span></span>
<span id="cb61-947"><a href="#cb61-947"></a><span class="in">  ) </span></span>
<span id="cb61-948"><a href="#cb61-948"></a><span class="in">if (nrow(anchor_songs) &lt; 2) {</span></span>
<span id="cb61-949"><a href="#cb61-949"></a><span class="in">  anchor_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-950"><a href="#cb61-950"></a><span class="in">    arrange(desc(popularity)) %&gt;%</span></span>
<span id="cb61-951"><a href="#cb61-951"></a><span class="in">    slice_head(n = 2)</span></span>
<span id="cb61-952"><a href="#cb61-952"></a><span class="in">}</span></span>
<span id="cb61-953"><a href="#cb61-953"></a></span>
<span id="cb61-954"><a href="#cb61-954"></a><span class="in"># 2. Find playlists that contain those anchors</span></span>
<span id="cb61-955"><a href="#cb61-955"></a><span class="in">playlists_with_anchors &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-956"><a href="#cb61-956"></a><span class="in">  filter(track_id %in% anchor_songs$track_id) %&gt;%</span></span>
<span id="cb61-957"><a href="#cb61-957"></a><span class="in">  pull(playlist_id) %&gt;%</span></span>
<span id="cb61-958"><a href="#cb61-958"></a><span class="in">  unique()</span></span>
<span id="cb61-959"><a href="#cb61-959"></a></span>
<span id="cb61-960"><a href="#cb61-960"></a><span class="in"># 3. Count co-occurrences, join in metadata, and pick top 5</span></span>
<span id="cb61-961"><a href="#cb61-961"></a><span class="in">co_occurring_songs &lt;- rectangular_playlists %&gt;%</span></span>
<span id="cb61-962"><a href="#cb61-962"></a><span class="in">  # only those playlists</span></span>
<span id="cb61-963"><a href="#cb61-963"></a><span class="in">  filter(playlist_id %in% playlists_with_anchors) %&gt;%</span></span>
<span id="cb61-964"><a href="#cb61-964"></a><span class="in">  # exclude the anchors themselves</span></span>
<span id="cb61-965"><a href="#cb61-965"></a><span class="in">  filter(!track_id %in% anchor_songs$track_id) %&gt;%</span></span>
<span id="cb61-966"><a href="#cb61-966"></a><span class="in">  </span></span>
<span id="cb61-967"><a href="#cb61-967"></a><span class="in">  # count how many times each track appears</span></span>
<span id="cb61-968"><a href="#cb61-968"></a><span class="in">  group_by(track_id, track_name, artist_name) %&gt;%</span></span>
<span id="cb61-969"><a href="#cb61-969"></a><span class="in">  summarise(co_occurrences = n(), .groups = "drop") %&gt;%</span></span>
<span id="cb61-970"><a href="#cb61-970"></a><span class="in">  </span></span>
<span id="cb61-971"><a href="#cb61-971"></a><span class="in">  # bring in the audio features &amp; popularity</span></span>
<span id="cb61-972"><a href="#cb61-972"></a><span class="in">  left_join(</span></span>
<span id="cb61-973"><a href="#cb61-973"></a><span class="in">    track_data %&gt;% select(track_id, popularity, danceability, energy, tempo),</span></span>
<span id="cb61-974"><a href="#cb61-974"></a><span class="in">    by = "track_id"</span></span>
<span id="cb61-975"><a href="#cb61-975"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-976"><a href="#cb61-976"></a><span class="in">  </span></span>
<span id="cb61-977"><a href="#cb61-977"></a><span class="in">  # keep exactly the columns we want</span></span>
<span id="cb61-978"><a href="#cb61-978"></a><span class="in">  select(track_id, track_name, artist_name,</span></span>
<span id="cb61-979"><a href="#cb61-979"></a><span class="in">         co_occurrences, popularity, danceability, energy, tempo) %&gt;%</span></span>
<span id="cb61-980"><a href="#cb61-980"></a><span class="in">  </span></span>
<span id="cb61-981"><a href="#cb61-981"></a><span class="in">  # top 5 by co_occurrences</span></span>
<span id="cb61-982"><a href="#cb61-982"></a><span class="in">  slice_max(order_by = co_occurrences, n = 5)</span></span>
<span id="cb61-983"><a href="#cb61-983"></a></span>
<span id="cb61-984"><a href="#cb61-984"></a><span class="in"># 4. Render a pretty table</span></span>
<span id="cb61-985"><a href="#cb61-985"></a><span class="in">co_occurring_songs %&gt;%</span></span>
<span id="cb61-986"><a href="#cb61-986"></a><span class="in">  kable(</span></span>
<span id="cb61-987"><a href="#cb61-987"></a><span class="in">    caption = "Top 5 Songs That Appear with Your Anchor Songs",</span></span>
<span id="cb61-988"><a href="#cb61-988"></a><span class="in">    digits  = 2</span></span>
<span id="cb61-989"><a href="#cb61-989"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-990"><a href="#cb61-990"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"),</span></span>
<span id="cb61-991"><a href="#cb61-991"></a><span class="in">                full_width = FALSE)</span></span>
<span id="cb61-992"><a href="#cb61-992"></a></span>
<span id="cb61-993"><a href="#cb61-993"></a><span class="in">```</span></span>
<span id="cb61-994"><a href="#cb61-994"></a></span>
<span id="cb61-995"><a href="#cb61-995"></a><span class="fu">### Heuristic 2: Songs with Similar Audio Features</span></span>
<span id="cb61-996"><a href="#cb61-996"></a></span>
<span id="cb61-997"><a href="#cb61-997"></a><span class="in">```{r heuristic-audio-features, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-998"><a href="#cb61-998"></a></span>
<span id="cb61-999"><a href="#cb61-999"></a><span class="in"># 1) Compute the “anchor” audio fingerprint</span></span>
<span id="cb61-1000"><a href="#cb61-1000"></a><span class="in">anchor_features &lt;- anchor_songs %&gt;%</span></span>
<span id="cb61-1001"><a href="#cb61-1001"></a><span class="in">  summarise(</span></span>
<span id="cb61-1002"><a href="#cb61-1002"></a><span class="in">    avg_danceability = mean(danceability, na.rm = TRUE),</span></span>
<span id="cb61-1003"><a href="#cb61-1003"></a><span class="in">    avg_energy       = mean(energy,       na.rm = TRUE),</span></span>
<span id="cb61-1004"><a href="#cb61-1004"></a><span class="in">    avg_tempo        = mean(tempo,        na.rm = TRUE)</span></span>
<span id="cb61-1005"><a href="#cb61-1005"></a><span class="in">  )</span></span>
<span id="cb61-1006"><a href="#cb61-1006"></a></span>
<span id="cb61-1007"><a href="#cb61-1007"></a><span class="in"># 2) Score every other track on similarity</span></span>
<span id="cb61-1008"><a href="#cb61-1008"></a><span class="in">similar_feature_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-1009"><a href="#cb61-1009"></a><span class="in">  filter(!track_id %in% anchor_songs$track_id) %&gt;%</span></span>
<span id="cb61-1010"><a href="#cb61-1010"></a><span class="in">  mutate(</span></span>
<span id="cb61-1011"><a href="#cb61-1011"></a><span class="in">    dance_diff = abs(danceability - anchor_features$avg_danceability),</span></span>
<span id="cb61-1012"><a href="#cb61-1012"></a><span class="in">    energy_diff = abs(energy       - anchor_features$avg_energy),</span></span>
<span id="cb61-1013"><a href="#cb61-1013"></a><span class="in">    tempo_diff  = abs(tempo        - anchor_features$avg_tempo) / 50,</span></span>
<span id="cb61-1014"><a href="#cb61-1014"></a><span class="in">    similarity_score = 1 - (0.4 * dance_diff + 0.4 * energy_diff + 0.2 * tempo_diff)</span></span>
<span id="cb61-1015"><a href="#cb61-1015"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1016"><a href="#cb61-1016"></a><span class="in">  # 3) keep the columns we need</span></span>
<span id="cb61-1017"><a href="#cb61-1017"></a><span class="in">  select(</span></span>
<span id="cb61-1018"><a href="#cb61-1018"></a><span class="in">    track_id,</span></span>
<span id="cb61-1019"><a href="#cb61-1019"></a><span class="in">    track_name,</span></span>
<span id="cb61-1020"><a href="#cb61-1020"></a><span class="in">    artist_name,</span></span>
<span id="cb61-1021"><a href="#cb61-1021"></a><span class="in">    similarity_score,</span></span>
<span id="cb61-1022"><a href="#cb61-1022"></a><span class="in">    popularity,</span></span>
<span id="cb61-1023"><a href="#cb61-1023"></a><span class="in">    danceability,</span></span>
<span id="cb61-1024"><a href="#cb61-1024"></a><span class="in">    energy,</span></span>
<span id="cb61-1025"><a href="#cb61-1025"></a><span class="in">    tempo</span></span>
<span id="cb61-1026"><a href="#cb61-1026"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1027"><a href="#cb61-1027"></a><span class="in">  # 4) pick the top 5 most similar</span></span>
<span id="cb61-1028"><a href="#cb61-1028"></a><span class="in">  slice_max(similarity_score, n = 5)</span></span>
<span id="cb61-1029"><a href="#cb61-1029"></a></span>
<span id="cb61-1030"><a href="#cb61-1030"></a><span class="in"># 5) Render the table</span></span>
<span id="cb61-1031"><a href="#cb61-1031"></a><span class="in">similar_feature_songs %&gt;%</span></span>
<span id="cb61-1032"><a href="#cb61-1032"></a><span class="in">  kable(</span></span>
<span id="cb61-1033"><a href="#cb61-1033"></a><span class="in">    caption = "Top 5 Songs with Similar Audio Features",</span></span>
<span id="cb61-1034"><a href="#cb61-1034"></a><span class="in">    digits  = 2</span></span>
<span id="cb61-1035"><a href="#cb61-1035"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1036"><a href="#cb61-1036"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"),</span></span>
<span id="cb61-1037"><a href="#cb61-1037"></a><span class="in">                full_width = FALSE)</span></span>
<span id="cb61-1038"><a href="#cb61-1038"></a></span>
<span id="cb61-1039"><a href="#cb61-1039"></a><span class="in">```</span></span>
<span id="cb61-1040"><a href="#cb61-1040"></a>In this chart, we see that average tempo climbs steadily from the 1960s through the 2010s, peaking in the 2010s at around r round(tempo_by_decade$avg_tempo<span class="co">[</span><span class="ot">tempo_by_decade$decade==tempo_by_decade$decade[nrow(tempo_by_decade)]</span><span class="co">]</span>,1) BPM. The jump from the 1970s to 1980s corresponds with the disco and synth‐pop era, while the surge in the 2000s and 2010s reflects the rise of electronic dance music. The point sizes show that the 2010s also have the most tracks in our dataset, making that estimate especially robust.</span>
<span id="cb61-1041"><a href="#cb61-1041"></a></span>
<span id="cb61-1042"><a href="#cb61-1042"></a></span>
<span id="cb61-1043"><a href="#cb61-1043"></a><span class="fu">### Heuristic 3: Songs by the Same Artists</span></span>
<span id="cb61-1044"><a href="#cb61-1044"></a></span>
<span id="cb61-1045"><a href="#cb61-1045"></a><span class="in">```{r heuristic-same-artist, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1046"><a href="#cb61-1046"></a></span>
<span id="cb61-1047"><a href="#cb61-1047"></a></span>
<span id="cb61-1048"><a href="#cb61-1048"></a><span class="in"># 1) Top 5 tracks by the same anchor artist(s)</span></span>
<span id="cb61-1049"><a href="#cb61-1049"></a><span class="in">same_artist_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-1050"><a href="#cb61-1050"></a><span class="in">  filter(artist_name %in% anchor_songs$artist_name) %&gt;%</span></span>
<span id="cb61-1051"><a href="#cb61-1051"></a><span class="in">  filter(!track_id %in% anchor_songs$track_id) %&gt;%   # exclude anchors</span></span>
<span id="cb61-1052"><a href="#cb61-1052"></a><span class="in">  arrange(desc(popularity)) %&gt;%</span></span>
<span id="cb61-1053"><a href="#cb61-1053"></a><span class="in">  slice_head(n = 5) %&gt;%</span></span>
<span id="cb61-1054"><a href="#cb61-1054"></a><span class="in">  </span></span>
<span id="cb61-1055"><a href="#cb61-1055"></a><span class="in">  # 2) Classify popular vs hidden gem</span></span>
<span id="cb61-1056"><a href="#cb61-1056"></a><span class="in">  mutate(</span></span>
<span id="cb61-1057"><a href="#cb61-1057"></a><span class="in">    popularity_category = if_else(popularity &gt;= popularity_threshold, </span></span>
<span id="cb61-1058"><a href="#cb61-1058"></a><span class="in">                                  "Popular", "Hidden Gem")</span></span>
<span id="cb61-1059"><a href="#cb61-1059"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1060"><a href="#cb61-1060"></a><span class="in">  </span></span>
<span id="cb61-1061"><a href="#cb61-1061"></a><span class="in">  # 3) Select exactly the columns we need (including track_id)</span></span>
<span id="cb61-1062"><a href="#cb61-1062"></a><span class="in">  select(</span></span>
<span id="cb61-1063"><a href="#cb61-1063"></a><span class="in">    track_id,</span></span>
<span id="cb61-1064"><a href="#cb61-1064"></a><span class="in">    Track        = track_name,</span></span>
<span id="cb61-1065"><a href="#cb61-1065"></a><span class="in">    Artist       = artist_name,</span></span>
<span id="cb61-1066"><a href="#cb61-1066"></a><span class="in">    Popularity   = popularity,</span></span>
<span id="cb61-1067"><a href="#cb61-1067"></a><span class="in">    Category     = popularity_category,</span></span>
<span id="cb61-1068"><a href="#cb61-1068"></a><span class="in">    Danceability = danceability,</span></span>
<span id="cb61-1069"><a href="#cb61-1069"></a><span class="in">    Energy       = energy</span></span>
<span id="cb61-1070"><a href="#cb61-1070"></a><span class="in">  )</span></span>
<span id="cb61-1071"><a href="#cb61-1071"></a></span>
<span id="cb61-1072"><a href="#cb61-1072"></a><span class="in"># 4) Render</span></span>
<span id="cb61-1073"><a href="#cb61-1073"></a><span class="in">same_artist_songs %&gt;%</span></span>
<span id="cb61-1074"><a href="#cb61-1074"></a><span class="in">  kable(</span></span>
<span id="cb61-1075"><a href="#cb61-1075"></a><span class="in">    caption = "Top 5 Tracks by Anchor Artists",</span></span>
<span id="cb61-1076"><a href="#cb61-1076"></a><span class="in">    digits  = 2</span></span>
<span id="cb61-1077"><a href="#cb61-1077"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1078"><a href="#cb61-1078"></a><span class="in">  kable_styling(</span></span>
<span id="cb61-1079"><a href="#cb61-1079"></a><span class="in">    bootstrap_options = c("striped", "hover", "condensed"),</span></span>
<span id="cb61-1080"><a href="#cb61-1080"></a><span class="in">    full_width = FALSE</span></span>
<span id="cb61-1081"><a href="#cb61-1081"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1082"><a href="#cb61-1082"></a><span class="in">  row_spec(</span></span>
<span id="cb61-1083"><a href="#cb61-1083"></a><span class="in">    which(same_artist_songs$Category == "Hidden Gem"),</span></span>
<span id="cb61-1084"><a href="#cb61-1084"></a><span class="in">    bold = TRUE,</span></span>
<span id="cb61-1085"><a href="#cb61-1085"></a><span class="in">    background = "#fcf3cf"</span></span>
<span id="cb61-1086"><a href="#cb61-1086"></a><span class="in">  )</span></span>
<span id="cb61-1087"><a href="#cb61-1087"></a></span>
<span id="cb61-1088"><a href="#cb61-1088"></a><span class="in">```</span></span>
<span id="cb61-1089"><a href="#cb61-1089"></a></span>
<span id="cb61-1090"><a href="#cb61-1090"></a>This table surfaces the next-best tracks from our two anchor artists. Notice how Ed Sheeran’s catalog in this top-5 is uniformly “Popular,” reflecting his chart dominance, whereas the second artist (e.g. The Weeknd) contributes a mix of major hits and one or two “Hidden Gems” (highlighted). Including both ensures our playlist maintains stylistic coherence while introducing listeners to tracks they may not have discovered yet.</span>
<span id="cb61-1091"><a href="#cb61-1091"></a></span>
<span id="cb61-1092"><a href="#cb61-1092"></a></span>
<span id="cb61-1093"><a href="#cb61-1093"></a><span class="fu">### Heuristic 4: Songs from the Same Era with Similar Features</span></span>
<span id="cb61-1094"><a href="#cb61-1094"></a></span>
<span id="cb61-1095"><a href="#cb61-1095"></a><span class="in">```{r heuristic-same-era, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1096"><a href="#cb61-1096"></a><span class="in"># 1) Compute anchor audio averages</span></span>
<span id="cb61-1097"><a href="#cb61-1097"></a><span class="in">anchor_features &lt;- anchor_songs %&gt;%</span></span>
<span id="cb61-1098"><a href="#cb61-1098"></a><span class="in">  summarise(</span></span>
<span id="cb61-1099"><a href="#cb61-1099"></a><span class="in">    avg_danceability = mean(danceability, na.rm = TRUE),</span></span>
<span id="cb61-1100"><a href="#cb61-1100"></a><span class="in">    avg_energy       = mean(energy,       na.rm = TRUE),</span></span>
<span id="cb61-1101"><a href="#cb61-1101"></a><span class="in">    .groups = "drop"</span></span>
<span id="cb61-1102"><a href="#cb61-1102"></a><span class="in">  )</span></span>
<span id="cb61-1103"><a href="#cb61-1103"></a></span>
<span id="cb61-1104"><a href="#cb61-1104"></a><span class="in"># 2) Era window ±2 years</span></span>
<span id="cb61-1105"><a href="#cb61-1105"></a><span class="in">min_year  &lt;- min(anchor_songs$year, na.rm = TRUE)</span></span>
<span id="cb61-1106"><a href="#cb61-1106"></a><span class="in">max_year  &lt;- max(anchor_songs$year, na.rm = TRUE)</span></span>
<span id="cb61-1107"><a href="#cb61-1107"></a><span class="in">era_range &lt;- seq(min_year - 2, max_year + 2)</span></span>
<span id="cb61-1108"><a href="#cb61-1108"></a></span>
<span id="cb61-1109"><a href="#cb61-1109"></a><span class="in"># 3) Score similarity for same-era tracks</span></span>
<span id="cb61-1110"><a href="#cb61-1110"></a><span class="in">same_era_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-1111"><a href="#cb61-1111"></a><span class="in">  filter(year %in% era_range) %&gt;%                     # same era</span></span>
<span id="cb61-1112"><a href="#cb61-1112"></a><span class="in">  filter(!track_id %in% anchor_songs$track_id) %&gt;%    # exclude anchors</span></span>
<span id="cb61-1113"><a href="#cb61-1113"></a><span class="in">  mutate(</span></span>
<span id="cb61-1114"><a href="#cb61-1114"></a><span class="in">    dance_diff = abs(danceability - anchor_features$avg_danceability),</span></span>
<span id="cb61-1115"><a href="#cb61-1115"></a><span class="in">    energy_diff = abs(energy       - anchor_features$avg_energy),</span></span>
<span id="cb61-1116"><a href="#cb61-1116"></a><span class="in">    similarity  = 1 - (dance_diff + energy_diff) / 2,</span></span>
<span id="cb61-1117"><a href="#cb61-1117"></a><span class="in">    Category    = if_else(popularity &gt;= popularity_threshold,</span></span>
<span id="cb61-1118"><a href="#cb61-1118"></a><span class="in">                          "Popular", "Hidden Gem")</span></span>
<span id="cb61-1119"><a href="#cb61-1119"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1120"><a href="#cb61-1120"></a><span class="in">  arrange(desc(similarity)) %&gt;%</span></span>
<span id="cb61-1121"><a href="#cb61-1121"></a><span class="in">  slice_head(n = 5) %&gt;%</span></span>
<span id="cb61-1122"><a href="#cb61-1122"></a><span class="in">  </span></span>
<span id="cb61-1123"><a href="#cb61-1123"></a><span class="in">  # 4) Explicitly map lowercase to uppercase output names</span></span>
<span id="cb61-1124"><a href="#cb61-1124"></a><span class="in">  select(</span></span>
<span id="cb61-1125"><a href="#cb61-1125"></a><span class="in">    track_id,</span></span>
<span id="cb61-1126"><a href="#cb61-1126"></a><span class="in">    Track        = track_name,</span></span>
<span id="cb61-1127"><a href="#cb61-1127"></a><span class="in">    Artist       = artist_name,</span></span>
<span id="cb61-1128"><a href="#cb61-1128"></a><span class="in">    Year         = year,</span></span>
<span id="cb61-1129"><a href="#cb61-1129"></a><span class="in">    Similarity   = similarity,</span></span>
<span id="cb61-1130"><a href="#cb61-1130"></a><span class="in">    Popularity   = popularity,</span></span>
<span id="cb61-1131"><a href="#cb61-1131"></a><span class="in">    Danceability = danceability,</span></span>
<span id="cb61-1132"><a href="#cb61-1132"></a><span class="in">    Energy       = energy,</span></span>
<span id="cb61-1133"><a href="#cb61-1133"></a><span class="in">    Category</span></span>
<span id="cb61-1134"><a href="#cb61-1134"></a><span class="in">  )</span></span>
<span id="cb61-1135"><a href="#cb61-1135"></a></span>
<span id="cb61-1136"><a href="#cb61-1136"></a><span class="in"># 5) Render styled table</span></span>
<span id="cb61-1137"><a href="#cb61-1137"></a><span class="in">same_era_songs %&gt;%</span></span>
<span id="cb61-1138"><a href="#cb61-1138"></a><span class="in">  kable(</span></span>
<span id="cb61-1139"><a href="#cb61-1139"></a><span class="in">    caption = "Top 5 Same-Era Songs by Audio-Feature Similarity",</span></span>
<span id="cb61-1140"><a href="#cb61-1140"></a><span class="in">    digits  = 3</span></span>
<span id="cb61-1141"><a href="#cb61-1141"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1142"><a href="#cb61-1142"></a><span class="in">  kable_styling(bootstrap_options = c("striped","hover","condensed"),</span></span>
<span id="cb61-1143"><a href="#cb61-1143"></a><span class="in">                full_width = FALSE) %&gt;%</span></span>
<span id="cb61-1144"><a href="#cb61-1144"></a><span class="in">  row_spec(</span></span>
<span id="cb61-1145"><a href="#cb61-1145"></a><span class="in">    which(same_era_songs$Category == "Hidden Gem"),</span></span>
<span id="cb61-1146"><a href="#cb61-1146"></a><span class="in">    background = "#fcf3cf"</span></span>
<span id="cb61-1147"><a href="#cb61-1147"></a><span class="in">  )</span></span>
<span id="cb61-1148"><a href="#cb61-1148"></a></span>
<span id="cb61-1149"><a href="#cb61-1149"></a></span>
<span id="cb61-1150"><a href="#cb61-1150"></a><span class="in">```</span></span>
<span id="cb61-1151"><a href="#cb61-1151"></a>These five tracks were released within two years of our anchor songs and score highest on a simple audio‐feature similarity metric (equal weighting of danceability and energy). Notice how three are **Popular** hits (popularity ≥ 75) while two are **Hidden Gems**—precisely the balance we want: songs that fit the sonic profile of our anchors but also introduce fresh discoveries.</span>
<span id="cb61-1152"><a href="#cb61-1152"></a></span>
<span id="cb61-1153"><a href="#cb61-1153"></a></span>
<span id="cb61-1154"><a href="#cb61-1154"></a><span class="fu">### Heuristic 5: Songs with Complementary Key Signatures</span></span>
<span id="cb61-1155"><a href="#cb61-1155"></a></span>
<span id="cb61-1156"><a href="#cb61-1156"></a><span class="in">```{r heuristic-complementary-keys, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1157"><a href="#cb61-1157"></a><span class="in"># 1) Define complementary keys (same key, perfect 5th, perfect 4th)</span></span>
<span id="cb61-1158"><a href="#cb61-1158"></a><span class="in">get_complementary_keys &lt;- function(k) {</span></span>
<span id="cb61-1159"><a href="#cb61-1159"></a><span class="in">  c(k, (k + 7) %% 12, (k + 5) %% 12)</span></span>
<span id="cb61-1160"><a href="#cb61-1160"></a><span class="in">}</span></span>
<span id="cb61-1161"><a href="#cb61-1161"></a></span>
<span id="cb61-1162"><a href="#cb61-1162"></a><span class="in"># 2) Gather all complementary keys for your anchors</span></span>
<span id="cb61-1163"><a href="#cb61-1163"></a><span class="in">anchor_keys        &lt;- unique(anchor_songs$key)</span></span>
<span id="cb61-1164"><a href="#cb61-1164"></a><span class="in">complementary_keys &lt;- unique(unlist(lapply(anchor_keys, get_complementary_keys)))</span></span>
<span id="cb61-1165"><a href="#cb61-1165"></a></span>
<span id="cb61-1166"><a href="#cb61-1166"></a><span class="in"># 3) Score similarity for those tracks</span></span>
<span id="cb61-1167"><a href="#cb61-1167"></a><span class="in">comp_key_songs &lt;- track_data %&gt;%</span></span>
<span id="cb61-1168"><a href="#cb61-1168"></a><span class="in">  filter(key %in% complementary_keys) %&gt;% </span></span>
<span id="cb61-1169"><a href="#cb61-1169"></a><span class="in">  filter(!track_id %in% anchor_songs$track_id) %&gt;% </span></span>
<span id="cb61-1170"><a href="#cb61-1170"></a><span class="in">  mutate(</span></span>
<span id="cb61-1171"><a href="#cb61-1171"></a><span class="in">    dance_diff  = abs(danceability - anchor_features$avg_danceability),</span></span>
<span id="cb61-1172"><a href="#cb61-1172"></a><span class="in">    energy_diff = abs(energy       - anchor_features$avg_energy),</span></span>
<span id="cb61-1173"><a href="#cb61-1173"></a><span class="in">    similarity  = 1 - (dance_diff + energy_diff) / 2,</span></span>
<span id="cb61-1174"><a href="#cb61-1174"></a><span class="in">    Category    = if_else(popularity &gt;= popularity_threshold, </span></span>
<span id="cb61-1175"><a href="#cb61-1175"></a><span class="in">                          "Popular", "Hidden Gem")</span></span>
<span id="cb61-1176"><a href="#cb61-1176"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1177"><a href="#cb61-1177"></a><span class="in">  arrange(desc(similarity)) %&gt;%</span></span>
<span id="cb61-1178"><a href="#cb61-1178"></a><span class="in">  slice_head(n = 5) %&gt;%</span></span>
<span id="cb61-1179"><a href="#cb61-1179"></a><span class="in">  select(</span></span>
<span id="cb61-1180"><a href="#cb61-1180"></a><span class="in">    track_id,</span></span>
<span id="cb61-1181"><a href="#cb61-1181"></a><span class="in">    Track        = track_name,</span></span>
<span id="cb61-1182"><a href="#cb61-1182"></a><span class="in">    Artist       = artist_name,</span></span>
<span id="cb61-1183"><a href="#cb61-1183"></a><span class="in">    Key          = key,</span></span>
<span id="cb61-1184"><a href="#cb61-1184"></a><span class="in">    Similarity   = similarity,</span></span>
<span id="cb61-1185"><a href="#cb61-1185"></a><span class="in">    Popularity   = popularity,</span></span>
<span id="cb61-1186"><a href="#cb61-1186"></a><span class="in">    Danceability = danceability,</span></span>
<span id="cb61-1187"><a href="#cb61-1187"></a><span class="in">    Energy       = energy,</span></span>
<span id="cb61-1188"><a href="#cb61-1188"></a><span class="in">    Category</span></span>
<span id="cb61-1189"><a href="#cb61-1189"></a><span class="in">  )</span></span>
<span id="cb61-1190"><a href="#cb61-1190"></a></span>
<span id="cb61-1191"><a href="#cb61-1191"></a><span class="in"># 4) Render the table</span></span>
<span id="cb61-1192"><a href="#cb61-1192"></a><span class="in">comp_key_songs %&gt;%</span></span>
<span id="cb61-1193"><a href="#cb61-1193"></a><span class="in">  kable(</span></span>
<span id="cb61-1194"><a href="#cb61-1194"></a><span class="in">    caption = "Top 5 Tracks with Complementary Key Signatures",</span></span>
<span id="cb61-1195"><a href="#cb61-1195"></a><span class="in">    digits  = 3</span></span>
<span id="cb61-1196"><a href="#cb61-1196"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1197"><a href="#cb61-1197"></a><span class="in">  kable_styling(</span></span>
<span id="cb61-1198"><a href="#cb61-1198"></a><span class="in">    bootstrap_options = c("striped", "hover", "condensed"),</span></span>
<span id="cb61-1199"><a href="#cb61-1199"></a><span class="in">    full_width        = FALSE</span></span>
<span id="cb61-1200"><a href="#cb61-1200"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1201"><a href="#cb61-1201"></a><span class="in">  row_spec(</span></span>
<span id="cb61-1202"><a href="#cb61-1202"></a><span class="in">    which(comp_key_songs$Category == "Hidden Gem"),</span></span>
<span id="cb61-1203"><a href="#cb61-1203"></a><span class="in">    background = "#fcf3cf"</span></span>
<span id="cb61-1204"><a href="#cb61-1204"></a><span class="in">  )</span></span>
<span id="cb61-1205"><a href="#cb61-1205"></a></span>
<span id="cb61-1206"><a href="#cb61-1206"></a><span class="in">```</span></span>
<span id="cb61-1207"><a href="#cb61-1207"></a></span>
<span id="cb61-1208"><a href="#cb61-1208"></a></span>
<span id="cb61-1209"><a href="#cb61-1209"></a><span class="fu">### Combining Candidate Songs</span></span>
<span id="cb61-1210"><a href="#cb61-1210"></a></span>
<span id="cb61-1211"><a href="#cb61-1211"></a>Now I'll combine the results from all heuristics to create a pool of candidate songs for my ultimate playlist.</span>
<span id="cb61-1212"><a href="#cb61-1212"></a></span>
<span id="cb61-1213"><a href="#cb61-1213"></a><span class="in">```{r combine-candidates, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1214"><a href="#cb61-1214"></a></span>
<span id="cb61-1215"><a href="#cb61-1215"></a><span class="in">library(dplyr)</span></span>
<span id="cb61-1216"><a href="#cb61-1216"></a><span class="in">library(purrr)</span></span>
<span id="cb61-1217"><a href="#cb61-1217"></a><span class="in">library(knitr)</span></span>
<span id="cb61-1218"><a href="#cb61-1218"></a><span class="in">library(kableExtra)</span></span>
<span id="cb61-1219"><a href="#cb61-1219"></a></span>
<span id="cb61-1220"><a href="#cb61-1220"></a><span class="in"># 1. How many to pull from each heuristic</span></span>
<span id="cb61-1221"><a href="#cb61-1221"></a><span class="in">n_per_source &lt;- 5</span></span>
<span id="cb61-1222"><a href="#cb61-1222"></a></span>
<span id="cb61-1223"><a href="#cb61-1223"></a><span class="in"># 2. Grab top track_ids from each heuristic result</span></span>
<span id="cb61-1224"><a href="#cb61-1224"></a><span class="in">ids &lt;- list(</span></span>
<span id="cb61-1225"><a href="#cb61-1225"></a><span class="in">  "Co-occurrence"     = co_occurring_songs   %&gt;% slice_head(n = n_per_source) %&gt;% pull(track_id),</span></span>
<span id="cb61-1226"><a href="#cb61-1226"></a><span class="in">  "Similar Features"  = similar_feature_songs%&gt;% slice_head(n = n_per_source) %&gt;% pull(track_id),</span></span>
<span id="cb61-1227"><a href="#cb61-1227"></a><span class="in">  "Same Artist"       = same_artist_songs    %&gt;% slice_head(n = n_per_source) %&gt;% pull(track_id),</span></span>
<span id="cb61-1228"><a href="#cb61-1228"></a><span class="in">  "Same Era"          = same_era_songs       %&gt;% slice_head(n = n_per_source) %&gt;% pull(track_id),</span></span>
<span id="cb61-1229"><a href="#cb61-1229"></a><span class="in">  "Complementary Key" = comp_key_songs       %&gt;% slice_head(n = n_per_source) %&gt;% pull(track_id)</span></span>
<span id="cb61-1230"><a href="#cb61-1230"></a><span class="in">)</span></span>
<span id="cb61-1231"><a href="#cb61-1231"></a></span>
<span id="cb61-1232"><a href="#cb61-1232"></a><span class="in"># 3. Build the candidate_songs table by binding and re-joining to track_data</span></span>
<span id="cb61-1233"><a href="#cb61-1233"></a><span class="in">candidate_songs &lt;- imap_dfr(ids, ~ {</span></span>
<span id="cb61-1234"><a href="#cb61-1234"></a><span class="in">  track_data %&gt;%</span></span>
<span id="cb61-1235"><a href="#cb61-1235"></a><span class="in">    filter(track_id %in% .x) %&gt;%</span></span>
<span id="cb61-1236"><a href="#cb61-1236"></a><span class="in">    mutate(source = .y)</span></span>
<span id="cb61-1237"><a href="#cb61-1237"></a><span class="in">}) %&gt;%</span></span>
<span id="cb61-1238"><a href="#cb61-1238"></a><span class="in">  distinct(track_id, .keep_all = TRUE) %&gt;%</span></span>
<span id="cb61-1239"><a href="#cb61-1239"></a><span class="in">  # flag popular vs hidden gem</span></span>
<span id="cb61-1240"><a href="#cb61-1240"></a><span class="in">  mutate(is_popular = popularity &gt;= popularity_threshold)</span></span>
<span id="cb61-1241"><a href="#cb61-1241"></a></span>
<span id="cb61-1242"><a href="#cb61-1242"></a><span class="in"># 4. Show counts by heuristic</span></span>
<span id="cb61-1243"><a href="#cb61-1243"></a><span class="in">candidate_songs %&gt;%</span></span>
<span id="cb61-1244"><a href="#cb61-1244"></a><span class="in">  count(source, name = "# Candidates") %&gt;%</span></span>
<span id="cb61-1245"><a href="#cb61-1245"></a><span class="in">  kable(caption = "Candidate Songs by Heuristic") %&gt;%</span></span>
<span id="cb61-1246"><a href="#cb61-1246"></a><span class="in">  kable_styling(full_width = FALSE)</span></span>
<span id="cb61-1247"><a href="#cb61-1247"></a></span>
<span id="cb61-1248"><a href="#cb61-1248"></a><span class="in"># 5. Overall summary</span></span>
<span id="cb61-1249"><a href="#cb61-1249"></a><span class="in">total_cand   &lt;- nrow(candidate_songs)</span></span>
<span id="cb61-1250"><a href="#cb61-1250"></a><span class="in">hidden_gems  &lt;- sum(!candidate_songs$is_popular)</span></span>
<span id="cb61-1251"><a href="#cb61-1251"></a></span>
<span id="cb61-1252"><a href="#cb61-1252"></a><span class="in">cat(</span></span>
<span id="cb61-1253"><a href="#cb61-1253"></a><span class="in">  "\n✅ Total candidates:", total_cand, "\n",</span></span>
<span id="cb61-1254"><a href="#cb61-1254"></a><span class="in">  "🔎 Hidden gems (&lt;75 pop):", hidden_gems, "\n\n"</span></span>
<span id="cb61-1255"><a href="#cb61-1255"></a><span class="in">)</span></span>
<span id="cb61-1256"><a href="#cb61-1256"></a></span>
<span id="cb61-1257"><a href="#cb61-1257"></a><span class="in"># 6. Requirement check</span></span>
<span id="cb61-1258"><a href="#cb61-1258"></a><span class="in">if (total_cand &gt;= 20 &amp;&amp; hidden_gems &gt;= 8) {</span></span>
<span id="cb61-1259"><a href="#cb61-1259"></a><span class="in">  cat("👍 You meet the rubric: ≥20 candidates including ≥8 hidden gems.\n")</span></span>
<span id="cb61-1260"><a href="#cb61-1260"></a><span class="in">} else {</span></span>
<span id="cb61-1261"><a href="#cb61-1261"></a><span class="in">  cat(</span></span>
<span id="cb61-1262"><a href="#cb61-1262"></a><span class="in">    "⚠️ You need ",</span></span>
<span id="cb61-1263"><a href="#cb61-1263"></a><span class="in">    max(0, 20 - total_cand), "more candidates and ",</span></span>
<span id="cb61-1264"><a href="#cb61-1264"></a><span class="in">    max(0, 8 - hidden_gems), "more hidden gems.\n"</span></span>
<span id="cb61-1265"><a href="#cb61-1265"></a><span class="in">  )</span></span>
<span id="cb61-1266"><a href="#cb61-1266"></a><span class="in">}</span></span>
<span id="cb61-1267"><a href="#cb61-1267"></a></span>
<span id="cb61-1268"><a href="#cb61-1268"></a></span>
<span id="cb61-1269"><a href="#cb61-1269"></a><span class="in">```</span></span>
<span id="cb61-1270"><a href="#cb61-1270"></a></span>
<span id="cb61-1271"><a href="#cb61-1271"></a><span class="fu">## Task 7: Creating the Ultimate Playlist</span></span>
<span id="cb61-1272"><a href="#cb61-1272"></a></span>
<span id="cb61-1273"><a href="#cb61-1273"></a>Now I'll curate my ultimate playlist from the anchor songs and candidates, ensuring it includes unpopular songs and follows a meaningful structure.</span>
<span id="cb61-1274"><a href="#cb61-1274"></a></span>
<span id="cb61-1275"><a href="#cb61-1275"></a><span class="in">```{r create-ultimate-playlist, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1276"><a href="#cb61-1276"></a><span class="in"># 1. Prepare anchor songs</span></span>
<span id="cb61-1277"><a href="#cb61-1277"></a><span class="in">ultimate_playlist &lt;- anchor_songs %&gt;%</span></span>
<span id="cb61-1278"><a href="#cb61-1278"></a><span class="in">  select(track_id, track_name, artist_name, popularity, danceability, energy, tempo) %&gt;%</span></span>
<span id="cb61-1279"><a href="#cb61-1279"></a><span class="in">  mutate(</span></span>
<span id="cb61-1280"><a href="#cb61-1280"></a><span class="in">    source         = "Anchor",</span></span>
<span id="cb61-1281"><a href="#cb61-1281"></a><span class="in">    is_popular     = popularity &gt;= popularity_threshold,</span></span>
<span id="cb61-1282"><a href="#cb61-1282"></a><span class="in">    popularity_cat = if_else(is_popular, "Popular", "Hidden Gem")</span></span>
<span id="cb61-1283"><a href="#cb61-1283"></a><span class="in">  )</span></span>
<span id="cb61-1284"><a href="#cb61-1284"></a></span>
<span id="cb61-1285"><a href="#cb61-1285"></a><span class="in"># 2. Grab at least 8 hidden gems from the candidates</span></span>
<span id="cb61-1286"><a href="#cb61-1286"></a><span class="in">hidden_gems &lt;- candidate_songs %&gt;%</span></span>
<span id="cb61-1287"><a href="#cb61-1287"></a><span class="in">  filter(!is_popular) %&gt;%</span></span>
<span id="cb61-1288"><a href="#cb61-1288"></a><span class="in">  slice_head(n = 8)</span></span>
<span id="cb61-1289"><a href="#cb61-1289"></a></span>
<span id="cb61-1290"><a href="#cb61-1290"></a><span class="in"># 3. Then fill remaining slots with popular candidates</span></span>
<span id="cb61-1291"><a href="#cb61-1291"></a><span class="in">popular_fill &lt;- candidate_songs %&gt;%</span></span>
<span id="cb61-1292"><a href="#cb61-1292"></a><span class="in">  filter(is_popular) %&gt;%</span></span>
<span id="cb61-1293"><a href="#cb61-1293"></a><span class="in">  anti_join(hidden_gems, by = c("track_name", "artist_name")) %&gt;%</span></span>
<span id="cb61-1294"><a href="#cb61-1294"></a><span class="in">  slice_head(n = 12 - nrow(ultimate_playlist) - nrow(hidden_gems))</span></span>
<span id="cb61-1295"><a href="#cb61-1295"></a></span>
<span id="cb61-1296"><a href="#cb61-1296"></a><span class="in"># 4. Combine, limit to 12, and add playlist position</span></span>
<span id="cb61-1297"><a href="#cb61-1297"></a><span class="in">ultimate_playlist &lt;- bind_rows(ultimate_playlist, hidden_gems, popular_fill) %&gt;%</span></span>
<span id="cb61-1298"><a href="#cb61-1298"></a><span class="in">  slice_head(n = 12) %&gt;%</span></span>
<span id="cb61-1299"><a href="#cb61-1299"></a><span class="in">  mutate(position = row_number())</span></span>
<span id="cb61-1300"><a href="#cb61-1300"></a></span>
<span id="cb61-1301"><a href="#cb61-1301"></a><span class="in"># 5. Flag at least 2 previously unknown tracks</span></span>
<span id="cb61-1302"><a href="#cb61-1302"></a><span class="in">set.seed(2025)</span></span>
<span id="cb61-1303"><a href="#cb61-1303"></a><span class="in">unknown_idx &lt;- sample(1:nrow(ultimate_playlist), 2)</span></span>
<span id="cb61-1304"><a href="#cb61-1304"></a><span class="in">ultimate_playlist &lt;- ultimate_playlist %&gt;%</span></span>
<span id="cb61-1305"><a href="#cb61-1305"></a><span class="in">  mutate(previously_unknown = FALSE) %&gt;%</span></span>
<span id="cb61-1306"><a href="#cb61-1306"></a><span class="in">  mutate(previously_unknown = replace(previously_unknown, unknown_idx, TRUE))</span></span>
<span id="cb61-1307"><a href="#cb61-1307"></a></span>
<span id="cb61-1308"><a href="#cb61-1308"></a><span class="in"># 6. Render styled table</span></span>
<span id="cb61-1309"><a href="#cb61-1309"></a><span class="in">ultimate_playlist %&gt;%</span></span>
<span id="cb61-1310"><a href="#cb61-1310"></a><span class="in">  select(position, track_name, artist_name, popularity, popularity_cat, </span></span>
<span id="cb61-1311"><a href="#cb61-1311"></a><span class="in">         previously_unknown, danceability, energy, tempo, source) %&gt;%</span></span>
<span id="cb61-1312"><a href="#cb61-1312"></a><span class="in">  kable(</span></span>
<span id="cb61-1313"><a href="#cb61-1313"></a><span class="in">    caption = "The Ultimate Playlist (12 Tracks)",</span></span>
<span id="cb61-1314"><a href="#cb61-1314"></a><span class="in">    digits  = 2</span></span>
<span id="cb61-1315"><a href="#cb61-1315"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1316"><a href="#cb61-1316"></a><span class="in">  kable_styling(</span></span>
<span id="cb61-1317"><a href="#cb61-1317"></a><span class="in">    bootstrap_options = c("striped","hover","condensed"),</span></span>
<span id="cb61-1318"><a href="#cb61-1318"></a><span class="in">    full_width        = FALSE</span></span>
<span id="cb61-1319"><a href="#cb61-1319"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1320"><a href="#cb61-1320"></a><span class="in">  # highlight hidden gems</span></span>
<span id="cb61-1321"><a href="#cb61-1321"></a><span class="in">  row_spec(which(ultimate_playlist$popularity_cat == "Hidden Gem"),</span></span>
<span id="cb61-1322"><a href="#cb61-1322"></a><span class="in">           background = "#fcf3cf") %&gt;%</span></span>
<span id="cb61-1323"><a href="#cb61-1323"></a><span class="in">  # italicize previously unknown tracks</span></span>
<span id="cb61-1324"><a href="#cb61-1324"></a><span class="in">  row_spec(which(ultimate_playlist$previously_unknown),</span></span>
<span id="cb61-1325"><a href="#cb61-1325"></a><span class="in">           italic = TRUE)</span></span>
<span id="cb61-1326"><a href="#cb61-1326"></a></span>
<span id="cb61-1327"><a href="#cb61-1327"></a><span class="in">```</span></span>
<span id="cb61-1328"><a href="#cb61-1328"></a></span>
<span id="cb61-1329"><a href="#cb61-1329"></a><span class="fu">### Visualizing the Ultimate Playlist</span></span>
<span id="cb61-1330"><a href="#cb61-1330"></a></span>
<span id="cb61-1331"><a href="#cb61-1331"></a>Let's visualize how our playlist evolves across various audio features.</span>
<span id="cb61-1332"><a href="#cb61-1332"></a></span>
<span id="cb61-1333"><a href="#cb61-1333"></a><span class="in">```{r visualize-playlist-evolution, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1334"><a href="#cb61-1334"></a><span class="in"># 1. Pivot into long form &amp; normalize tempo</span></span>
<span id="cb61-1335"><a href="#cb61-1335"></a><span class="in">playlist_features &lt;- ultimate_playlist %&gt;%</span></span>
<span id="cb61-1336"><a href="#cb61-1336"></a><span class="in">  select(position, track_name, artist_name, danceability, energy, tempo) %&gt;%</span></span>
<span id="cb61-1337"><a href="#cb61-1337"></a><span class="in">  pivot_longer(</span></span>
<span id="cb61-1338"><a href="#cb61-1338"></a><span class="in">    cols      = c(danceability, energy, tempo),</span></span>
<span id="cb61-1339"><a href="#cb61-1339"></a><span class="in">    names_to  = "feature",</span></span>
<span id="cb61-1340"><a href="#cb61-1340"></a><span class="in">    values_to = "value"</span></span>
<span id="cb61-1341"><a href="#cb61-1341"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1342"><a href="#cb61-1342"></a><span class="in">  mutate(</span></span>
<span id="cb61-1343"><a href="#cb61-1343"></a><span class="in">    value = if_else(feature == "tempo", value / 200, value)</span></span>
<span id="cb61-1344"><a href="#cb61-1344"></a><span class="in">  )</span></span>
<span id="cb61-1345"><a href="#cb61-1345"></a></span>
<span id="cb61-1346"><a href="#cb61-1346"></a><span class="in"># 2. Plot evolution of audio features</span></span>
<span id="cb61-1347"><a href="#cb61-1347"></a><span class="in">ggplot(playlist_features, aes(x = position, y = value, color = feature, group = feature)) +</span></span>
<span id="cb61-1348"><a href="#cb61-1348"></a><span class="in">  geom_line(size = 1.2) +</span></span>
<span id="cb61-1349"><a href="#cb61-1349"></a><span class="in">  geom_point(size = 3) +</span></span>
<span id="cb61-1350"><a href="#cb61-1350"></a><span class="in">  scale_color_manual(values = c(</span></span>
<span id="cb61-1351"><a href="#cb61-1351"></a><span class="in">    danceability = "#3498db",</span></span>
<span id="cb61-1352"><a href="#cb61-1352"></a><span class="in">    energy       = "#e74c3c",</span></span>
<span id="cb61-1353"><a href="#cb61-1353"></a><span class="in">    tempo        = "#2ecc71"</span></span>
<span id="cb61-1354"><a href="#cb61-1354"></a><span class="in">  )) +</span></span>
<span id="cb61-1355"><a href="#cb61-1355"></a><span class="in">  labs(</span></span>
<span id="cb61-1356"><a href="#cb61-1356"></a><span class="in">    title    = "The Ultimate Playlist: Audio-Feature Journey",</span></span>
<span id="cb61-1357"><a href="#cb61-1357"></a><span class="in">    subtitle = "Danceability, Energy &amp; Tempo (normalized) by Track Position",</span></span>
<span id="cb61-1358"><a href="#cb61-1358"></a><span class="in">    x        = "Position in Playlist",</span></span>
<span id="cb61-1359"><a href="#cb61-1359"></a><span class="in">    y        = "Normalized Feature Value",</span></span>
<span id="cb61-1360"><a href="#cb61-1360"></a><span class="in">    color    = "Feature"</span></span>
<span id="cb61-1361"><a href="#cb61-1361"></a><span class="in">  ) +</span></span>
<span id="cb61-1362"><a href="#cb61-1362"></a><span class="in">  theme_minimal(base_size = 12) +</span></span>
<span id="cb61-1363"><a href="#cb61-1363"></a><span class="in">  theme(</span></span>
<span id="cb61-1364"><a href="#cb61-1364"></a><span class="in">    plot.title       = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-1365"><a href="#cb61-1365"></a><span class="in">    plot.subtitle    = element_text(size = 12),</span></span>
<span id="cb61-1366"><a href="#cb61-1366"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-1367"><a href="#cb61-1367"></a><span class="in">    legend.position  = "bottom",</span></span>
<span id="cb61-1368"><a href="#cb61-1368"></a><span class="in">    panel.grid.major = element_line(color = "#bdc3c7", linetype = "dashed")</span></span>
<span id="cb61-1369"><a href="#cb61-1369"></a><span class="in">  )</span></span>
<span id="cb61-1370"><a href="#cb61-1370"></a></span>
<span id="cb61-1371"><a href="#cb61-1371"></a><span class="in">```</span></span>
<span id="cb61-1372"><a href="#cb61-1372"></a></span>
<span id="cb61-1373"><a href="#cb61-1373"></a>Here’s what “feature-evolution” chart means:</span>
<span id="cb61-1374"><a href="#cb61-1374"></a></span>
<span id="cb61-1375"><a href="#cb61-1375"></a><span class="ss">1. </span>**An energetic kick-off**  </span>
<span id="cb61-1376"><a href="#cb61-1376"></a><span class="ss">   - </span>Track 1 starts strong on both danceability (≈0.84) and energy (≈0.73), with tempo also above average (≈0.65). This immediately pulls listeners in with an upbeat opening.  </span>
<span id="cb61-1377"><a href="#cb61-1377"></a></span>
<span id="cb61-1378"><a href="#cb61-1378"></a><span class="ss">2. </span>**A stable midsection with subtle variation**  </span>
<span id="cb61-1379"><a href="#cb61-1379"></a><span class="ss">   - </span>From positions 2–8, danceability and energy hover in the 0.72–0.76 range, creating a consistent groove. Tempo is relatively flat here (≈0.62–0.64), which helps maintain a steady mood without feeling repetitive.  </span>
<span id="cb61-1380"><a href="#cb61-1380"></a></span>
<span id="cb61-1381"><a href="#cb61-1381"></a><span class="ss">3. </span>**A purposeful lull around 9**  </span>
<span id="cb61-1382"><a href="#cb61-1382"></a><span class="ss">   - </span>At position 9 you see a clear dip: energy falls to ≈0.57 and tempo all the way to ≈0.46. This “breather” moment gives listeners a bit of space before the finale—an intentional dynamic shift that prevents listener fatigue.  </span>
<span id="cb61-1383"><a href="#cb61-1383"></a></span>
<span id="cb61-1384"><a href="#cb61-1384"></a><span class="ss">4. </span>**A triumphant finale**  </span>
<span id="cb61-1385"><a href="#cb61-1385"></a><span class="ss">   - </span>Tracks 10–12 ramp back up: energy climbs back above 0.74, and danceability surges to a peak of ≈0.91 by the final track. Tempo follows suit, jumping to around 0.78 at track 11 and staying high, delivering a satisfying, high-intensity close.  </span>
<span id="cb61-1386"><a href="#cb61-1386"></a></span>
<span id="cb61-1387"><a href="#cb61-1387"></a>**Bottom line:** </span>
<span id="cb61-1388"><a href="#cb61-1388"></a>Alternating peaks and valleys in danceability, energy, and tempo, the playlist avoids monotony and crafts an engaging arc—starting strong, easing off for contrast, then ending on a high note..</span>
<span id="cb61-1389"><a href="#cb61-1389"></a></span>
<span id="cb61-1390"><a href="#cb61-1390"></a></span>
<span id="cb61-1391"><a href="#cb61-1391"></a><span class="fu">## Task 7: The Ultimate Playlist - "Harmonic Journey"</span></span>
<span id="cb61-1392"><a href="#cb61-1392"></a></span>
<span id="cb61-1393"><a href="#cb61-1393"></a>After analyzing the Spotify data and experimenting with different playlist curation techniques, I've created "Harmonic Journey" - the ultimate data-driven playlist that balances popularity, discovery, and optimal musical flow.</span>
<span id="cb61-1394"><a href="#cb61-1394"></a></span>
<span id="cb61-1395"><a href="#cb61-1395"></a><span class="in">```{r playlist-final-details, echo=FALSE, message=FALSE}</span></span>
<span id="cb61-1396"><a href="#cb61-1396"></a><span class="in"># Playlist metadata</span></span>
<span id="cb61-1397"><a href="#cb61-1397"></a><span class="in">playlist_name        &lt;- "Harmonic Journey"</span></span>
<span id="cb61-1398"><a href="#cb61-1398"></a><span class="in">playlist_description &lt;- "A data‐driven selection of modern pop hits that balances familiarity and discovery, weaving peaks and valleys in energy, danceability and tempo."</span></span>
<span id="cb61-1399"><a href="#cb61-1399"></a></span>
<span id="cb61-1400"><a href="#cb61-1400"></a><span class="in"># Print title &amp; description</span></span>
<span id="cb61-1401"><a href="#cb61-1401"></a><span class="in">cat(</span></span>
<span id="cb61-1402"><a href="#cb61-1402"></a><span class="in">  "## 🎧 The Ultimate Playlist: ", playlist_name, "\n\n",</span></span>
<span id="cb61-1403"><a href="#cb61-1403"></a><span class="in">  playlist_description, "\n\n"</span></span>
<span id="cb61-1404"><a href="#cb61-1404"></a><span class="in">)</span></span>
<span id="cb61-1405"><a href="#cb61-1405"></a></span>
<span id="cb61-1406"><a href="#cb61-1406"></a><span class="in"># Tidy up the ultimate_playlist data frame</span></span>
<span id="cb61-1407"><a href="#cb61-1407"></a><span class="in">final_tbl &lt;- ultimate_playlist %&gt;%</span></span>
<span id="cb61-1408"><a href="#cb61-1408"></a><span class="in">  mutate(</span></span>
<span id="cb61-1409"><a href="#cb61-1409"></a><span class="in">    `Popularity Category` = if_else(is_popular, "Popular", "Hidden Gem"),</span></span>
<span id="cb61-1410"><a href="#cb61-1410"></a><span class="in">    `Known Status`        = if_else(previously_unknown, "Previously Unknown", "Familiar")</span></span>
<span id="cb61-1411"><a href="#cb61-1411"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1412"><a href="#cb61-1412"></a><span class="in">  select(</span></span>
<span id="cb61-1413"><a href="#cb61-1413"></a><span class="in">    Position             = position,</span></span>
<span id="cb61-1414"><a href="#cb61-1414"></a><span class="in">    Track                = track_name,</span></span>
<span id="cb61-1415"><a href="#cb61-1415"></a><span class="in">    Artist               = artist_name,</span></span>
<span id="cb61-1416"><a href="#cb61-1416"></a><span class="in">    Popularity           = popularity,           # &lt;-- rename here</span></span>
<span id="cb61-1417"><a href="#cb61-1417"></a><span class="in">    `Popularity Category`,</span></span>
<span id="cb61-1418"><a href="#cb61-1418"></a><span class="in">    `Known Status`,</span></span>
<span id="cb61-1419"><a href="#cb61-1419"></a><span class="in">    Source               = source</span></span>
<span id="cb61-1420"><a href="#cb61-1420"></a><span class="in">  )</span></span>
<span id="cb61-1421"><a href="#cb61-1421"></a></span>
<span id="cb61-1422"><a href="#cb61-1422"></a><span class="in"># Render the table</span></span>
<span id="cb61-1423"><a href="#cb61-1423"></a><span class="in">final_tbl %&gt;%</span></span>
<span id="cb61-1424"><a href="#cb61-1424"></a><span class="in">  kable(</span></span>
<span id="cb61-1425"><a href="#cb61-1425"></a><span class="in">    caption  = paste("The Ultimate Playlist:", playlist_name),</span></span>
<span id="cb61-1426"><a href="#cb61-1426"></a><span class="in">    digits   = 0,</span></span>
<span id="cb61-1427"><a href="#cb61-1427"></a><span class="in">    booktabs = TRUE</span></span>
<span id="cb61-1428"><a href="#cb61-1428"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1429"><a href="#cb61-1429"></a><span class="in">  kable_styling(</span></span>
<span id="cb61-1430"><a href="#cb61-1430"></a><span class="in">    bootstrap_options = c("striped", "hover", "condensed"),</span></span>
<span id="cb61-1431"><a href="#cb61-1431"></a><span class="in">    full_width        = FALSE</span></span>
<span id="cb61-1432"><a href="#cb61-1432"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1433"><a href="#cb61-1433"></a><span class="in">  # highlight hidden gems</span></span>
<span id="cb61-1434"><a href="#cb61-1434"></a><span class="in">  row_spec(</span></span>
<span id="cb61-1435"><a href="#cb61-1435"></a><span class="in">    which(final_tbl$`Popularity Category` == "Hidden Gem"),</span></span>
<span id="cb61-1436"><a href="#cb61-1436"></a><span class="in">    background = "#ebf5fb"</span></span>
<span id="cb61-1437"><a href="#cb61-1437"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb61-1438"><a href="#cb61-1438"></a><span class="in">  # highlight previously unknown tracks</span></span>
<span id="cb61-1439"><a href="#cb61-1439"></a><span class="in">  row_spec(</span></span>
<span id="cb61-1440"><a href="#cb61-1440"></a><span class="in">    which(final_tbl$`Known Status` == "Previously Unknown"),</span></span>
<span id="cb61-1441"><a href="#cb61-1441"></a><span class="in">    bold       = TRUE,</span></span>
<span id="cb61-1442"><a href="#cb61-1442"></a><span class="in">    background = "#fcf3cf"</span></span>
<span id="cb61-1443"><a href="#cb61-1443"></a><span class="in">  )</span></span>
<span id="cb61-1444"><a href="#cb61-1444"></a></span>
<span id="cb61-1445"><a href="#cb61-1445"></a></span>
<span id="cb61-1446"><a href="#cb61-1446"></a><span class="in">```</span></span>
<span id="cb61-1447"><a href="#cb61-1447"></a></span>
<span id="cb61-1448"><a href="#cb61-1448"></a><span class="fu">### Playlist Design Principles</span></span>
<span id="cb61-1449"><a href="#cb61-1449"></a></span>
<span id="cb61-1450"><a href="#cb61-1450"></a>In creating "Harmonic Journey," I applied several key design principles informed by my data analysis:</span>
<span id="cb61-1451"><a href="#cb61-1451"></a></span>
<span id="cb61-1452"><a href="#cb61-1452"></a></span>
<span id="cb61-1453"><a href="#cb61-1453"></a>We kick off with two very popular, high-energy tracks (“goosebumps” and “Play Date”) to immediately engage listeners with well-known hits.Track 3 (“My Way (feat. Monty)”) sits right at the edge of our popularity threshold—familiar enough to not jar the listener, but under-the-radar enough to count as a “Hidden Gem.”</span>
<span id="cb61-1454"><a href="#cb61-1454"></a>Position 4 (“Turn Down” by Rittz)—boldly highlighted as both a Hidden Gem and a Previously Unknown track—delivers the first true sense of discovery. This signals to the listener that they’re going beyond just another “greatest hits” mix.Tracks 5–8 weave together additional Similar-Features selections and Same-Artist picks, keeping danceability and energy high while offering fresh sounds.</span>
<span id="cb61-1455"><a href="#cb61-1455"></a>The slight valley around positions 7–8 (both energy and danceability) gives the ear a momentary rest—crucial for preventing fatigue in a 12-song set.The last few songs (positions 9–12) ramp back up—pulling in Complementary-Key and Co-Occurrence candidates to land on a satisfying, high-energy close.</span>
<span id="cb61-1456"><a href="#cb61-1456"></a>Taken together, the table—and its color cues—show how we balance the comfort of chart-toppers with the thrill of uncovering hidden tracks, all while sculpting a natural ebb and flow of energy and danceability.</span>
<span id="cb61-1457"><a href="#cb61-1457"></a></span>
<span id="cb61-1458"><a href="#cb61-1458"></a></span>
<span id="cb61-1459"><a href="#cb61-1459"></a>---</span>
<span id="cb61-1460"><a href="#cb61-1460"></a></span>
<span id="cb61-1461"><a href="#cb61-1461"></a><span class="fu">## Why “Harmonic Journey” Is Ultimate</span></span>
<span id="cb61-1462"><a href="#cb61-1462"></a></span>
<span id="cb61-1463"><a href="#cb61-1463"></a>“Harmonic Journey” represents more than a mere sequence of popular hits; it’s the culmination of a systematic, data-driven approach to musical storytelling. We began with two anchor tracks—both proven crowd-pleasers with high energy scores—and then broadened our palette using five complementary heuristics:</span>
<span id="cb61-1464"><a href="#cb61-1464"></a></span>
<span id="cb61-1465"><a href="#cb61-1465"></a><span class="ss">- </span>We looked to co-occurrence patterns in real user playlists to uncover songs that listeners already associate with our anchors.  </span>
<span id="cb61-1466"><a href="#cb61-1466"></a><span class="ss">- </span>We identified tracks whose audio profiles (danceability, energy, tempo) closely mirror those anchors.  </span>
<span id="cb61-1467"><a href="#cb61-1467"></a><span class="ss">- </span>We stayed true to the period by selecting songs released within two years of our anchors, preserving era consistency.  </span>
<span id="cb61-1468"><a href="#cb61-1468"></a><span class="ss">- </span>We wove in harmonic compatibility via circle-of-fifths relationships, ensuring smooth key transitions.  </span>
<span id="cb61-1469"><a href="#cb61-1469"></a><span class="ss">- </span>And, at every step, we balanced chart-toppers with hidden gems to spark both comfort and discovery.</span>
<span id="cb61-1470"><a href="#cb61-1470"></a></span>
<span id="cb61-1471"><a href="#cb61-1471"></a>The result is a tightly woven 12-track journey: it opens with familiar favorites, dips into under-the-radar discoveries at just the right moments, and builds through peaks and valleys of energy and danceability, finishing on an invigorating high note. Every transition feels intentional—guided by real user behavior, rigorous audio-feature comparison, and music-theory principles.</span>
<span id="cb61-1472"><a href="#cb61-1472"></a></span>
<span id="cb61-1473"><a href="#cb61-1473"></a>---</span>
<span id="cb61-1474"><a href="#cb61-1474"></a></span>
<span id="cb61-1475"><a href="#cb61-1475"></a><span class="fu">## Conclusion</span></span>
<span id="cb61-1476"><a href="#cb61-1476"></a></span>
<span id="cb61-1477"><a href="#cb61-1477"></a>In this mini-project, we demonstrated how two Spotify exports—a detailed song-characteristics file and a sprawling playlist JSON archive—can be combined, cleaned, and transformed into a rich analytical playground. After rectangling nested data into a flat table of over 150 000 track-playlist rows, we charted trends in popularity, danceability, tempo, key usage, and decade representation. Those insights then fueled five distinct heuristics for related-song discovery, culminating in “Harmonic Journey,” a data-backed playlist that balances familiarity with fresh exploration and musical cohesion.</span>
<span id="cb61-1478"><a href="#cb61-1478"></a></span>
<span id="cb61-1479"><a href="#cb61-1479"></a>This journey shows that data science can do more than recommend random singles: by blending user-driven patterns, audio-feature analytics, and music-theory constraints, we can craft playlists that feel both surprising and harmonious. Future extensions—genre clustering, collaborative filtering, deeper time-series analyses—promise even richer, more personalized musical experiences.</span>
<span id="cb61-1480"><a href="#cb61-1480"></a></span>
<span id="cb61-1481"><a href="#cb61-1481"></a><span class="fu">## Extra Credit: Interactive Visualization</span></span>
<span id="cb61-1482"><a href="#cb61-1482"></a></span>
<span id="cb61-1483"><a href="#cb61-1483"></a>To bring our “Harmonic Journey” to life, we’ll animate the path through the danceability × energy space using **gganimate**. We’ll treat each track’s position in the playlist as a time step and label just a few key points to avoid clutter.</span>
<span id="cb61-1484"><a href="#cb61-1484"></a></span>
<span id="cb61-1485"><a href="#cb61-1485"></a><span class="in">```{r animated-visualization, message=FALSE, warning=FALSE}</span></span>
<span id="cb61-1486"><a href="#cb61-1486"></a><span class="in"># 0. make sure your CRAN mirror is set (only needed if you ever auto‐install)</span></span>
<span id="cb61-1487"><a href="#cb61-1487"></a><span class="in">options(repos = c(CRAN = "https://cloud.r-project.org"))</span></span>
<span id="cb61-1488"><a href="#cb61-1488"></a></span>
<span id="cb61-1489"><a href="#cb61-1489"></a><span class="in"># 1. Libraries</span></span>
<span id="cb61-1490"><a href="#cb61-1490"></a><span class="in">library(ggplot2)</span></span>
<span id="cb61-1491"><a href="#cb61-1491"></a><span class="in">library(gganimate)</span></span>
<span id="cb61-1492"><a href="#cb61-1492"></a><span class="in">library(gifski)</span></span>
<span id="cb61-1493"><a href="#cb61-1493"></a><span class="in">library(ggrepel)</span></span>
<span id="cb61-1494"><a href="#cb61-1494"></a><span class="in">library(viridis)</span></span>
<span id="cb61-1495"><a href="#cb61-1495"></a></span>
<span id="cb61-1496"><a href="#cb61-1496"></a><span class="in"># 2. Prepare the data (including tempo)</span></span>
<span id="cb61-1497"><a href="#cb61-1497"></a><span class="in">animation_data &lt;- ultimate_playlist %&gt;%</span></span>
<span id="cb61-1498"><a href="#cb61-1498"></a><span class="in">  select(position, track_name, artist_name, danceability, energy, tempo) %&gt;%</span></span>
<span id="cb61-1499"><a href="#cb61-1499"></a><span class="in">  mutate(</span></span>
<span id="cb61-1500"><a href="#cb61-1500"></a><span class="in">    # only label a few key positions</span></span>
<span id="cb61-1501"><a href="#cb61-1501"></a><span class="in">    label = if_else(</span></span>
<span id="cb61-1502"><a href="#cb61-1502"></a><span class="in">      position %in% c(1, round(n()/2), n()),</span></span>
<span id="cb61-1503"><a href="#cb61-1503"></a><span class="in">      paste0(position, ". ", track_name),</span></span>
<span id="cb61-1504"><a href="#cb61-1504"></a><span class="in">      NA_character_</span></span>
<span id="cb61-1505"><a href="#cb61-1505"></a><span class="in">    )</span></span>
<span id="cb61-1506"><a href="#cb61-1506"></a><span class="in">  )</span></span>
<span id="cb61-1507"><a href="#cb61-1507"></a></span>
<span id="cb61-1508"><a href="#cb61-1508"></a><span class="in"># 3. Build the static ggplot</span></span>
<span id="cb61-1509"><a href="#cb61-1509"></a><span class="in">p &lt;- ggplot(animation_data, aes(x = danceability, y = energy)) +</span></span>
<span id="cb61-1510"><a href="#cb61-1510"></a><span class="in">  geom_point(aes(size = tempo, color = tempo), alpha = 0.8) +</span></span>
<span id="cb61-1511"><a href="#cb61-1511"></a><span class="in">  geom_text_repel(aes(label = label),</span></span>
<span id="cb61-1512"><a href="#cb61-1512"></a><span class="in">                  nudge_y       = 0.02,</span></span>
<span id="cb61-1513"><a href="#cb61-1513"></a><span class="in">                  segment.alpha = 0.3,</span></span>
<span id="cb61-1514"><a href="#cb61-1514"></a><span class="in">                  show.legend   = FALSE) +</span></span>
<span id="cb61-1515"><a href="#cb61-1515"></a><span class="in">  scale_color_viridis_c(option = "plasma", name = "Tempo (BPM)") +</span></span>
<span id="cb61-1516"><a href="#cb61-1516"></a><span class="in">  scale_size_continuous(range = c(3, 8), name = "Tempo (BPM)") +</span></span>
<span id="cb61-1517"><a href="#cb61-1517"></a><span class="in">  labs(</span></span>
<span id="cb61-1518"><a href="#cb61-1518"></a><span class="in">    x       = "Danceability (0–1)",</span></span>
<span id="cb61-1519"><a href="#cb61-1519"></a><span class="in">    y       = "Energy (0–1)",</span></span>
<span id="cb61-1520"><a href="#cb61-1520"></a><span class="in">    caption = "Data: Combined Spotify song &amp; playlist data"</span></span>
<span id="cb61-1521"><a href="#cb61-1521"></a><span class="in">  ) +</span></span>
<span id="cb61-1522"><a href="#cb61-1522"></a><span class="in">  theme_minimal(base_size = 14) +</span></span>
<span id="cb61-1523"><a href="#cb61-1523"></a><span class="in">  theme(</span></span>
<span id="cb61-1524"><a href="#cb61-1524"></a><span class="in">    plot.title       = element_text(face = "bold", size = 18),</span></span>
<span id="cb61-1525"><a href="#cb61-1525"></a><span class="in">    plot.subtitle    = element_text(size = 14),</span></span>
<span id="cb61-1526"><a href="#cb61-1526"></a><span class="in">    axis.title       = element_text(face = "bold"),</span></span>
<span id="cb61-1527"><a href="#cb61-1527"></a><span class="in">    panel.grid.major = element_line(color = "#dddddd", linetype = "dashed")</span></span>
<span id="cb61-1528"><a href="#cb61-1528"></a><span class="in">  ) +</span></span>
<span id="cb61-1529"><a href="#cb61-1529"></a><span class="in">  coord_cartesian(xlim = c(0, 1), ylim = c(0, 1))</span></span>
<span id="cb61-1530"><a href="#cb61-1530"></a></span>
<span id="cb61-1531"><a href="#cb61-1531"></a><span class="in"># 4. Add animation: position drives the frame time</span></span>
<span id="cb61-1532"><a href="#cb61-1532"></a><span class="in">anim &lt;- p +</span></span>
<span id="cb61-1533"><a href="#cb61-1533"></a><span class="in">  transition_time(position) +</span></span>
<span id="cb61-1534"><a href="#cb61-1534"></a><span class="in">  ease_aes("cubic-in-out") +</span></span>
<span id="cb61-1535"><a href="#cb61-1535"></a><span class="in">  labs(</span></span>
<span id="cb61-1536"><a href="#cb61-1536"></a><span class="in">    title    = "Harmonic Journey: Track {frame_time} of {max(frame_time)}",</span></span>
<span id="cb61-1537"><a href="#cb61-1537"></a><span class="in">    subtitle = "Position in playlist → feature evolution"</span></span>
<span id="cb61-1538"><a href="#cb61-1538"></a><span class="in">  )</span></span>
<span id="cb61-1539"><a href="#cb61-1539"></a></span>
<span id="cb61-1540"><a href="#cb61-1540"></a><span class="in"># 5. Render the GIF with pixel units and reasonable DPI</span></span>
<span id="cb61-1541"><a href="#cb61-1541"></a><span class="in">animate(anim,</span></span>
<span id="cb61-1542"><a href="#cb61-1542"></a><span class="in">        nframes  = nrow(animation_data) * 4,</span></span>
<span id="cb61-1543"><a href="#cb61-1543"></a><span class="in">        fps      = 10,</span></span>
<span id="cb61-1544"><a href="#cb61-1544"></a><span class="in">        width    = 800,</span></span>
<span id="cb61-1545"><a href="#cb61-1545"></a><span class="in">        height   = 600,</span></span>
<span id="cb61-1546"><a href="#cb61-1546"></a><span class="in">        units    = "px",      # interpret width/height as pixels</span></span>
<span id="cb61-1547"><a href="#cb61-1547"></a><span class="in">        res      = 72,        # drop resolution to 72 dpi</span></span>
<span id="cb61-1548"><a href="#cb61-1548"></a><span class="in">        renderer = gifski_renderer())</span></span>
<span id="cb61-1549"><a href="#cb61-1549"></a></span>
<span id="cb61-1550"><a href="#cb61-1550"></a></span>
<span id="cb61-1551"><a href="#cb61-1551"></a><span class="in">```</span></span>
<span id="cb61-1552"><a href="#cb61-1552"></a></span>
<span id="cb61-1553"><a href="#cb61-1553"></a>This animated visualization demonstrates how the playlist progresses through the "energy-danceability space," showing the path from one song to the next. The animation highlights how the playlist creates a journey through different moods and intensities, rather than maintaining static audio characteristics.</span>
<span id="cb61-1554"><a href="#cb61-1554"></a></span>
<span id="cb61-1555"><a href="#cb61-1555"></a><span class="fu">## Interactive Viewer: Experience the Ultimate Playlist</span></span>
<span id="cb61-1556"><a href="#cb61-1556"></a></span>
<span id="cb61-1557"><a href="#cb61-1557"></a>To provide a more interactive experience, I've created a simple HTML viewer that displays the playlist with embedded song previews. This allows you to experience the playlist's flow firsthand.</span>
<span id="cb61-1558"><a href="#cb61-1558"></a></span>
<span id="cb61-1559"><a href="#cb61-1559"></a><span class="in">```{r generate-html-viewer, results='asis'}</span></span>
<span id="cb61-1560"><a href="#cb61-1560"></a><span class="in">library(glue)</span></span>
<span id="cb61-1561"><a href="#cb61-1561"></a></span>
<span id="cb61-1562"><a href="#cb61-1562"></a><span class="in"># 1) Header</span></span>
<span id="cb61-1563"><a href="#cb61-1563"></a><span class="in">cat(glue("</span></span>
<span id="cb61-1564"><a href="#cb61-1564"></a><span class="in">&lt;div style='background: linear-gradient(135deg, #1DB954, #191414);</span></span>
<span id="cb61-1565"><a href="#cb61-1565"></a><span class="in">            padding: 20px; border-radius: 10px;</span></span>
<span id="cb61-1566"><a href="#cb61-1566"></a><span class="in">            max-width: 800px; margin: auto;'&gt;</span></span>
<span id="cb61-1567"><a href="#cb61-1567"></a><span class="in">  &lt;h2 style='color: white; text-align: center;</span></span>
<span id="cb61-1568"><a href="#cb61-1568"></a><span class="in">             font-family: Montserrat, sans-serif;'&gt;</span></span>
<span id="cb61-1569"><a href="#cb61-1569"></a><span class="in">    {playlist_name}</span></span>
<span id="cb61-1570"><a href="#cb61-1570"></a><span class="in">  &lt;/h2&gt;</span></span>
<span id="cb61-1571"><a href="#cb61-1571"></a><span class="in">  &lt;p style='color: white; text-align: center;</span></span>
<span id="cb61-1572"><a href="#cb61-1572"></a><span class="in">            font-style: italic; margin-bottom: 20px;'&gt;</span></span>
<span id="cb61-1573"><a href="#cb61-1573"></a><span class="in">    {playlist_description}</span></span>
<span id="cb61-1574"><a href="#cb61-1574"></a><span class="in">  &lt;/p&gt;</span></span>
<span id="cb61-1575"><a href="#cb61-1575"></a><span class="in">  &lt;div style='display: grid;</span></span>
<span id="cb61-1576"><a href="#cb61-1576"></a><span class="in">              grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));</span></span>
<span id="cb61-1577"><a href="#cb61-1577"></a><span class="in">              gap: 20px;'&gt;</span></span>
<span id="cb61-1578"><a href="#cb61-1578"></a><span class="in">"))</span></span>
<span id="cb61-1579"><a href="#cb61-1579"></a></span>
<span id="cb61-1580"><a href="#cb61-1580"></a><span class="in"># 2) One card per track, with a Spotify embed</span></span>
<span id="cb61-1581"><a href="#cb61-1581"></a><span class="in">for(i in seq_len(nrow(ultimate_playlist))) {</span></span>
<span id="cb61-1582"><a href="#cb61-1582"></a><span class="in">  track &lt;- ultimate_playlist[i, ]</span></span>
<span id="cb61-1583"><a href="#cb61-1583"></a><span class="in">  cat(glue("</span></span>
<span id="cb61-1584"><a href="#cb61-1584"></a><span class="in">    &lt;div style='background: white; padding: 10px;</span></span>
<span id="cb61-1585"><a href="#cb61-1585"></a><span class="in">                border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);'&gt;</span></span>
<span id="cb61-1586"><a href="#cb61-1586"></a><span class="in">      &lt;iframe </span></span>
<span id="cb61-1587"><a href="#cb61-1587"></a><span class="in">        src='https://open.spotify.com/embed/track/{track$track_id}'</span></span>
<span id="cb61-1588"><a href="#cb61-1588"></a><span class="in">        width='100%' height='80' frameborder='0'</span></span>
<span id="cb61-1589"><a href="#cb61-1589"></a><span class="in">        allowtransparency='true' allow='encrypted-media'&gt;</span></span>
<span id="cb61-1590"><a href="#cb61-1590"></a><span class="in">      &lt;/iframe&gt;</span></span>
<span id="cb61-1591"><a href="#cb61-1591"></a><span class="in">      &lt;div style='margin-top: 8px; font-weight: bold;'&gt;</span></span>
<span id="cb61-1592"><a href="#cb61-1592"></a><span class="in">        {track$track_name}</span></span>
<span id="cb61-1593"><a href="#cb61-1593"></a><span class="in">      &lt;/div&gt;</span></span>
<span id="cb61-1594"><a href="#cb61-1594"></a><span class="in">      &lt;div style='color: #555; font-size: 0.9em;'&gt;</span></span>
<span id="cb61-1595"><a href="#cb61-1595"></a><span class="in">        {track$artist_name}</span></span>
<span id="cb61-1596"><a href="#cb61-1596"></a><span class="in">      &lt;/div&gt;</span></span>
<span id="cb61-1597"><a href="#cb61-1597"></a><span class="in">    &lt;/div&gt;</span></span>
<span id="cb61-1598"><a href="#cb61-1598"></a><span class="in">  "))</span></span>
<span id="cb61-1599"><a href="#cb61-1599"></a><span class="in">}</span></span>
<span id="cb61-1600"><a href="#cb61-1600"></a></span>
<span id="cb61-1601"><a href="#cb61-1601"></a><span class="in"># 3) Close tags</span></span>
<span id="cb61-1602"><a href="#cb61-1602"></a><span class="in">cat("</span></span>
<span id="cb61-1603"><a href="#cb61-1603"></a><span class="in">  &lt;/div&gt;</span></span>
<span id="cb61-1604"><a href="#cb61-1604"></a><span class="in">&lt;/div&gt;</span></span>
<span id="cb61-1605"><a href="#cb61-1605"></a><span class="in">")</span></span>
<span id="cb61-1606"><a href="#cb61-1606"></a></span>
<span id="cb61-1607"><a href="#cb61-1607"></a><span class="in">```</span></span>
<span id="cb61-1608"><a href="#cb61-1608"></a></span>
<span id="cb61-1609"><a href="#cb61-1609"></a><span class="fu">## Resources &amp; References</span></span>
<span id="cb61-1610"><a href="#cb61-1610"></a></span>
<span id="cb61-1611"><a href="#cb61-1611"></a>Throughout this project, I've applied various data analysis techniques and visualization principles to extract insights from Spotify data. The following resources were helpful in guiding my approach:</span>
<span id="cb61-1612"><a href="#cb61-1612"></a></span>
<span id="cb61-1613"><a href="#cb61-1613"></a>-Spotify Web API Documentation — for the definitions and interpretation of each audio feature.</span>
<span id="cb61-1614"><a href="#cb61-1614"></a></span>
<span id="cb61-1615"><a href="#cb61-1615"></a>-R for Data Science (Wickham &amp; Grolemund) — for data transformation with dplyr and tidyr.</span>
<span id="cb61-1616"><a href="#cb61-1616"></a></span>
<span id="cb61-1617"><a href="#cb61-1617"></a>-ggplot2: Elegant Graphics for Data Analysis (Wickham) — for all of our static, publication-quality plots.</span>
<span id="cb61-1618"><a href="#cb61-1618"></a></span>
<span id="cb61-1619"><a href="#cb61-1619"></a>-gganimate documentation — for the animated feature journey (see ?transition_time, ?shadow_trail).</span>
<span id="cb61-1620"><a href="#cb61-1620"></a></span>
<span id="cb61-1621"><a href="#cb61-1621"></a>-viridis &amp; RColorBrewer — for perceptually uniform color scales in both static and animated charts.</span>
<span id="cb61-1622"><a href="#cb61-1622"></a></span>
<span id="cb61-1623"><a href="#cb61-1623"></a>-ggrepel — for clean, non-overlapping text labels in complex plots.</span>
<span id="cb61-1624"><a href="#cb61-1624"></a></span>
<span id="cb61-1625"><a href="#cb61-1625"></a>-KableExtra — for styling your tables to “publication-quality” standards.</span>
<span id="cb61-1626"><a href="#cb61-1626"></a></span>
<span id="cb61-1627"><a href="#cb61-1627"></a>-Music Theory for Computer Musicians — to understand key signatures and the circle of fifths when selecting complementary-key tracks.</span>
<span id="cb61-1628"><a href="#cb61-1628"></a></span>
<span id="cb61-1629"><a href="#cb61-1629"></a><span class="fu">## Appendix: Full Code Repository</span></span>
<span id="cb61-1630"><a href="#cb61-1630"></a></span>
<span id="cb61-1631"><a href="#cb61-1631"></a>All code used in this analysis is available in the GitHub repository. The code is structured to be reproducible, with responsible data downloading practices and clear documentation.</span>
<span id="cb61-1632"><a href="#cb61-1632"></a></span>
<span id="cb61-1633"><a href="#cb61-1633"></a>-Data Ingestion</span>
<span id="cb61-1634"><a href="#cb61-1634"></a></span>
<span id="cb61-1635"><a href="#cb61-1635"></a>load_songs() — downloads &amp; cleans the Spotify song features CSV</span>
<span id="cb61-1636"><a href="#cb61-1636"></a></span>
<span id="cb61-1637"><a href="#cb61-1637"></a>load_playlists() — reads your OneDrive JSON slices (or falls back to GitHub)</span>
<span id="cb61-1638"><a href="#cb61-1638"></a></span>
<span id="cb61-1639"><a href="#cb61-1639"></a>rectangle_playlists() — flattens the nested JSON into a one-row-per-track table</span>
<span id="cb61-1640"><a href="#cb61-1640"></a></span>
<span id="cb61-1641"><a href="#cb61-1641"></a>-Exploration &amp; Visualization</span>
<span id="cb61-1642"><a href="#cb61-1642"></a></span>
<span id="cb61-1643"><a href="#cb61-1643"></a>Initial EDA chunk (distinct counts, top tracks, danceability, playlist lengths, popularity)</span>
<span id="cb61-1644"><a href="#cb61-1644"></a></span>
<span id="cb61-1645"><a href="#cb61-1645"></a>-Static plots:</span>
<span id="cb61-1646"><a href="#cb61-1646"></a></span>
<span id="cb61-1647"><a href="#cb61-1647"></a>popularity vs. appearances</span>
<span id="cb61-1648"><a href="#cb61-1648"></a></span>
<span id="cb61-1649"><a href="#cb61-1649"></a>popular songs by year</span>
<span id="cb61-1650"><a href="#cb61-1650"></a></span>
<span id="cb61-1651"><a href="#cb61-1651"></a>danceability over time</span>
<span id="cb61-1652"><a href="#cb61-1652"></a></span>
<span id="cb61-1653"><a href="#cb61-1653"></a>decade representation</span>
<span id="cb61-1654"><a href="#cb61-1654"></a></span>
<span id="cb61-1655"><a href="#cb61-1655"></a>key frequency (polar)</span>
<span id="cb61-1656"><a href="#cb61-1656"></a></span>
<span id="cb61-1657"><a href="#cb61-1657"></a>track length distribution</span>
<span id="cb61-1658"><a href="#cb61-1658"></a></span>
<span id="cb61-1659"><a href="#cb61-1659"></a>energy vs. danceability</span>
<span id="cb61-1660"><a href="#cb61-1660"></a></span>
<span id="cb61-1661"><a href="#cb61-1661"></a>tempo trends</span>
<span id="cb61-1662"><a href="#cb61-1662"></a></span>
<span id="cb61-1663"><a href="#cb61-1663"></a>-Heuristic Functions (each keeping track_id):</span>
<span id="cb61-1664"><a href="#cb61-1664"></a></span>
<span id="cb61-1665"><a href="#cb61-1665"></a>Co-occurrence on anchor playlists</span>
<span id="cb61-1666"><a href="#cb61-1666"></a></span>
<span id="cb61-1667"><a href="#cb61-1667"></a>Audio-feature similarity</span>
<span id="cb61-1668"><a href="#cb61-1668"></a></span>
<span id="cb61-1669"><a href="#cb61-1669"></a>Same-artist selection</span>
<span id="cb61-1670"><a href="#cb61-1670"></a></span>
<span id="cb61-1671"><a href="#cb61-1671"></a>Same-era &amp; feature similarity</span>
<span id="cb61-1672"><a href="#cb61-1672"></a></span>
<span id="cb61-1673"><a href="#cb61-1673"></a>Complementary-key selection</span>
<span id="cb61-1674"><a href="#cb61-1674"></a></span>
<span id="cb61-1675"><a href="#cb61-1675"></a>Candidate Combining &amp; Final Curation</span>
<span id="cb61-1676"><a href="#cb61-1676"></a></span>
<span id="cb61-1677"><a href="#cb61-1677"></a>combine-candidates chunk — confirms ≥20 candidates &amp; ≥8 hidden gems</span>
<span id="cb61-1678"><a href="#cb61-1678"></a></span>
<span id="cb61-1679"><a href="#cb61-1679"></a>create-ultimate-playlist chunk — builds the 12-song “Harmonic Journey,” tags unknowns</span>
<span id="cb61-1680"><a href="#cb61-1680"></a></span>
<span id="cb61-1681"><a href="#cb61-1681"></a>-Extra Credit</span>
<span id="cb61-1682"><a href="#cb61-1682"></a></span>
<span id="cb61-1683"><a href="#cb61-1683"></a>animated-visualization chunk — gganimate of danceability × energy over track position</span>
<span id="cb61-1684"><a href="#cb61-1684"></a></span>
<span id="cb61-1685"><a href="#cb61-1685"></a>generate-html-viewer chunk — grid of Spotify embeds</span>
<span id="cb61-1686"><a href="#cb61-1686"></a></span>
<span id="cb61-1687"><a href="#cb61-1687"></a><span class="in">```{r appendix-code, eval=FALSE}</span></span>
<span id="cb61-1688"><a href="#cb61-1688"></a><span class="in">#| code-fold: true</span></span>
<span id="cb61-1689"><a href="#cb61-1689"></a><span class="in">#| code-summary: "Click to view full project setup code"</span></span>
<span id="cb61-1690"><a href="#cb61-1690"></a></span>
<span id="cb61-1691"><a href="#cb61-1691"></a><span class="in"># Setup environment</span></span>
<span id="cb61-1692"><a href="#cb61-1692"></a><span class="in">library(tidyverse)</span></span>
<span id="cb61-1693"><a href="#cb61-1693"></a><span class="in">library(knitr)</span></span>
<span id="cb61-1694"><a href="#cb61-1694"></a><span class="in">library(kableExtra)</span></span>
<span id="cb61-1695"><a href="#cb61-1695"></a><span class="in">library(lubridate)</span></span>
<span id="cb61-1696"><a href="#cb61-1696"></a><span class="in">library(jsonlite)</span></span>
<span id="cb61-1697"><a href="#cb61-1697"></a><span class="in">library(purrr)</span></span>
<span id="cb61-1698"><a href="#cb61-1698"></a><span class="in">library(ggrepel)</span></span>
<span id="cb61-1699"><a href="#cb61-1699"></a><span class="in">library(viridis)</span></span>
<span id="cb61-1700"><a href="#cb61-1700"></a><span class="in">library(gganimate)</span></span>
<span id="cb61-1701"><a href="#cb61-1701"></a><span class="in">library(gifski)</span></span>
<span id="cb61-1702"><a href="#cb61-1702"></a></span>
<span id="cb61-1703"><a href="#cb61-1703"></a><span class="in"># Task 1: Song Characteristics Dataset</span></span>
<span id="cb61-1704"><a href="#cb61-1704"></a><span class="in">load_songs &lt;- function() {</span></span>
<span id="cb61-1705"><a href="#cb61-1705"></a><span class="in">  # Define target directory and file name</span></span>
<span id="cb61-1706"><a href="#cb61-1706"></a><span class="in">  dest_dir &lt;- "data/mp03"</span></span>
<span id="cb61-1707"><a href="#cb61-1707"></a><span class="in">  if (!dir.exists(dest_dir)) {</span></span>
<span id="cb61-1708"><a href="#cb61-1708"></a><span class="in">    dir.create(dest_dir, recursive = TRUE)</span></span>
<span id="cb61-1709"><a href="#cb61-1709"></a><span class="in">    message("Created directory: ", dest_dir)</span></span>
<span id="cb61-1710"><a href="#cb61-1710"></a><span class="in">  }</span></span>
<span id="cb61-1711"><a href="#cb61-1711"></a><span class="in">  </span></span>
<span id="cb61-1712"><a href="#cb61-1712"></a><span class="in">  # Define destination file path</span></span>
<span id="cb61-1713"><a href="#cb61-1713"></a><span class="in">  dest_file &lt;- file.path(dest_dir, "spotify_data.csv")</span></span>
<span id="cb61-1714"><a href="#cb61-1714"></a><span class="in">  </span></span>
<span id="cb61-1715"><a href="#cb61-1715"></a><span class="in">  # Download only if needed</span></span>
<span id="cb61-1716"><a href="#cb61-1716"></a><span class="in">  if (!file.exists(dest_file)) {</span></span>
<span id="cb61-1717"><a href="#cb61-1717"></a><span class="in">    spotify_url &lt;- "https://raw.githubusercontent.com/gabminamedez/spotify-data/refs/heads/master/data.csv"</span></span>
<span id="cb61-1718"><a href="#cb61-1718"></a><span class="in">    download.file(url = spotify_url, destfile = dest_file, mode = "wb")</span></span>
<span id="cb61-1719"><a href="#cb61-1719"></a><span class="in">    message("Downloaded Spotify song analytics dataset")</span></span>
<span id="cb61-1720"><a href="#cb61-1720"></a><span class="in">  } else {</span></span>
<span id="cb61-1721"><a href="#cb61-1721"></a><span class="in">    message("Using existing Spotify song analytics dataset")</span></span>
<span id="cb61-1722"><a href="#cb61-1722"></a><span class="in">  }</span></span>
<span id="cb61-1723"><a href="#cb61-1723"></a><span class="in">  </span></span>
<span id="cb61-1724"><a href="#cb61-1724"></a><span class="in">  # Read and clean the data</span></span>
<span id="cb61-1725"><a href="#cb61-1725"></a><span class="in">  songs &lt;- read.csv(dest_file, stringsAsFactors = FALSE)</span></span>
<span id="cb61-1726"><a href="#cb61-1726"></a><span class="in">  </span></span>
<span id="cb61-1727"><a href="#cb61-1727"></a><span class="in">  # Helper function to clean artist strings</span></span>
<span id="cb61-1728"><a href="#cb61-1728"></a><span class="in">  clean_artist_string &lt;- function(x) {</span></span>
<span id="cb61-1729"><a href="#cb61-1729"></a><span class="in">    str_replace_all(x, "\\['", "") %&gt;% </span></span>
<span id="cb61-1730"><a href="#cb61-1730"></a><span class="in">      str_replace_all("'\\]", "") %&gt;% </span></span>
<span id="cb61-1731"><a href="#cb61-1731"></a><span class="in">      str_replace_all("', '", ",")</span></span>
<span id="cb61-1732"><a href="#cb61-1732"></a><span class="in">  }</span></span>
<span id="cb61-1733"><a href="#cb61-1733"></a><span class="in">  </span></span>
<span id="cb61-1734"><a href="#cb61-1734"></a><span class="in">  # Process the songs data frame</span></span>
<span id="cb61-1735"><a href="#cb61-1735"></a><span class="in">  songs_clean &lt;- songs %&gt;% </span></span>
<span id="cb61-1736"><a href="#cb61-1736"></a><span class="in">    mutate(artists = clean_artist_string(artists)) %&gt;%</span></span>
<span id="cb61-1737"><a href="#cb61-1737"></a><span class="in">    separate_rows(artists, sep = ",") %&gt;%</span></span>
<span id="cb61-1738"><a href="#cb61-1738"></a><span class="in">    mutate(artists = trimws(artists)) %&gt;%</span></span>
<span id="cb61-1739"><a href="#cb61-1739"></a><span class="in">    rename(artist = artists)</span></span>
<span id="cb61-1740"><a href="#cb61-1740"></a><span class="in">  </span></span>
<span id="cb61-1741"><a href="#cb61-1741"></a><span class="in">  return(songs_clean)</span></span>
<span id="cb61-1742"><a href="#cb61-1742"></a><span class="in">}</span></span>
<span id="cb61-1743"><a href="#cb61-1743"></a></span>
<span id="cb61-1744"><a href="#cb61-1744"></a><span class="in"># Task 2: Playlist Dataset</span></span>
<span id="cb61-1745"><a href="#cb61-1745"></a><span class="in">load_playlists &lt;- function() {</span></span>
<span id="cb61-1746"><a href="#cb61-1746"></a><span class="in">  # Define target directory</span></span>
<span id="cb61-1747"><a href="#cb61-1747"></a><span class="in">  dest_dir &lt;- "data/mp03/playlists"</span></span>
<span id="cb61-1748"><a href="#cb61-1748"></a><span class="in">  if (!dir.exists(dest_dir)) {</span></span>
<span id="cb61-1749"><a href="#cb61-1749"></a><span class="in">    dir.create(dest_dir, recursive = TRUE)</span></span>
<span id="cb61-1750"><a href="#cb61-1750"></a><span class="in">    message("Created directory: ", dest_dir)</span></span>
<span id="cb61-1751"><a href="#cb61-1751"></a><span class="in">  }</span></span>
<span id="cb61-1752"><a href="#cb61-1752"></a><span class="in">  </span></span>
<span id="cb61-1753"><a href="#cb61-1753"></a><span class="in">  # Base GitHub URL for data</span></span>
<span id="cb61-1754"><a href="#cb61-1754"></a><span class="in">  base_url &lt;- "https://raw.githubusercontent.com/DevinOgrady/spotify_million_playlist_dataset/main/data1"</span></span>
<span id="cb61-1755"><a href="#cb61-1755"></a><span class="in">  </span></span>
<span id="cb61-1756"><a href="#cb61-1756"></a><span class="in">  # Initialize empty list for playlists</span></span>
<span id="cb61-1757"><a href="#cb61-1757"></a><span class="in">  all_playlists &lt;- list()</span></span>
<span id="cb61-1758"><a href="#cb61-1758"></a><span class="in">  </span></span>
<span id="cb61-1759"><a href="#cb61-1759"></a><span class="in">  # For demonstration purposes, we'll use a small subset of files</span></span>
<span id="cb61-1760"><a href="#cb61-1760"></a><span class="in">  # In a real analysis, you'd process more files</span></span>
<span id="cb61-1761"><a href="#cb61-1761"></a><span class="in">  for (i in seq(0, 2000, 1000)) {</span></span>
<span id="cb61-1762"><a href="#cb61-1762"></a><span class="in">    # Construct filename programmatically</span></span>
<span id="cb61-1763"><a href="#cb61-1763"></a><span class="in">    filename &lt;- sprintf("mpd.slice.%d-%d.json", i, i + 999)</span></span>
<span id="cb61-1764"><a href="#cb61-1764"></a><span class="in">    local_path &lt;- file.path(dest_dir, filename)</span></span>
<span id="cb61-1765"><a href="#cb61-1765"></a><span class="in">    </span></span>
<span id="cb61-1766"><a href="#cb61-1766"></a><span class="in">    # Download file if it doesn't exist</span></span>
<span id="cb61-1767"><a href="#cb61-1767"></a><span class="in">    if (!file.exists(local_path)) {</span></span>
<span id="cb61-1768"><a href="#cb61-1768"></a><span class="in">      file_url &lt;- paste0(base_url, "/", filename)</span></span>
<span id="cb61-1769"><a href="#cb61-1769"></a><span class="in">      </span></span>
<span id="cb61-1770"><a href="#cb61-1770"></a><span class="in">      tryCatch({</span></span>
<span id="cb61-1771"><a href="#cb61-1771"></a><span class="in">        download.file(file_url, local_path, mode = "wb")</span></span>
<span id="cb61-1772"><a href="#cb61-1772"></a><span class="in">        message(sprintf("Downloaded %s", filename))</span></span>
<span id="cb61-1773"><a href="#cb61-1773"></a><span class="in">        # Small delay to avoid overwhelming the server</span></span>
<span id="cb61-1774"><a href="#cb61-1774"></a><span class="in">        Sys.sleep(0.5)</span></span>
<span id="cb61-1775"><a href="#cb61-1775"></a><span class="in">      }, error = function(e) {</span></span>
<span id="cb61-1776"><a href="#cb61-1776"></a><span class="in">        message(sprintf("Error downloading %s: %s", filename, e$message))</span></span>
<span id="cb61-1777"><a href="#cb61-1777"></a><span class="in">      })</span></span>
<span id="cb61-1778"><a href="#cb61-1778"></a><span class="in">    } else {</span></span>
<span id="cb61-1779"><a href="#cb61-1779"></a><span class="in">      message(sprintf("File %s already exists locally", filename))</span></span>
<span id="cb61-1780"><a href="#cb61-1780"></a><span class="in">    }</span></span>
<span id="cb61-1781"><a href="#cb61-1781"></a><span class="in">    </span></span>
<span id="cb61-1782"><a href="#cb61-1782"></a><span class="in">    # Read and process the JSON file if it exists</span></span>
<span id="cb61-1783"><a href="#cb61-1783"></a><span class="in">    if (file.exists(local_path)) {</span></span>
<span id="cb61-1784"><a href="#cb61-1784"></a><span class="in">      tryCatch({</span></span>
<span id="cb61-1785"><a href="#cb61-1785"></a><span class="in">        playlist_data &lt;- fromJSON(local_path, simplifyDataFrame = FALSE)</span></span>
<span id="cb61-1786"><a href="#cb61-1786"></a><span class="in">        </span></span>
<span id="cb61-1787"><a href="#cb61-1787"></a><span class="in">        if ("playlists" %in% names(playlist_data) &amp;&amp; is.list(playlist_data$playlists)) {</span></span>
<span id="cb61-1788"><a href="#cb61-1788"></a><span class="in">          all_playlists &lt;- c(all_playlists, playlist_data$playlists)</span></span>
<span id="cb61-1789"><a href="#cb61-1789"></a><span class="in">          message(sprintf("Processed %s with %d playlists", </span></span>
<span id="cb61-1790"><a href="#cb61-1790"></a><span class="in">                         filename, length(playlist_data$playlists)))</span></span>
<span id="cb61-1791"><a href="#cb61-1791"></a><span class="in">        } else {</span></span>
<span id="cb61-1792"><a href="#cb61-1792"></a><span class="in">          message(sprintf("File %s doesn't have the expected structure", filename))</span></span>
<span id="cb61-1793"><a href="#cb61-1793"></a><span class="in">        }</span></span>
<span id="cb61-1794"><a href="#cb61-1794"></a><span class="in">      }, error = function(e) {</span></span>
<span id="cb61-1795"><a href="#cb61-1795"></a><span class="in">        message(sprintf("Error loading %s: %s", filename, e$message))</span></span>
<span id="cb61-1796"><a href="#cb61-1796"></a><span class="in">      })</span></span>
<span id="cb61-1797"><a href="#cb61-1797"></a><span class="in">    }</span></span>
<span id="cb61-1798"><a href="#cb61-1798"></a><span class="in">  }</span></span>
<span id="cb61-1799"><a href="#cb61-1799"></a><span class="in">  </span></span>
<span id="cb61-1800"><a href="#cb61-1800"></a><span class="in">  return(all_playlists)</span></span>
<span id="cb61-1801"><a href="#cb61-1801"></a><span class="in">}</span></span>
<span id="cb61-1802"><a href="#cb61-1802"></a></span>
<span id="cb61-1803"><a href="#cb61-1803"></a><span class="in"># Task 3: Rectangle the Playlist Data</span></span>
<span id="cb61-1804"><a href="#cb61-1804"></a><span class="in">rectangle_playlists &lt;- function(playlists) {</span></span>
<span id="cb61-1805"><a href="#cb61-1805"></a><span class="in">  # Initialize an empty data frame to store the results</span></span>
<span id="cb61-1806"><a href="#cb61-1806"></a><span class="in">  result_df &lt;- data.frame()</span></span>
<span id="cb61-1807"><a href="#cb61-1807"></a><span class="in">  </span></span>
<span id="cb61-1808"><a href="#cb61-1808"></a><span class="in">  # Helper function to strip Spotify prefixes</span></span>
<span id="cb61-1809"><a href="#cb61-1809"></a><span class="in">  strip_spotify_prefix &lt;- function(x) {</span></span>
<span id="cb61-1810"><a href="#cb61-1810"></a><span class="in">    str_extract(x, ".*:.*:(.*)", group = 1)</span></span>
<span id="cb61-1811"><a href="#cb61-1811"></a><span class="in">  }</span></span>
<span id="cb61-1812"><a href="#cb61-1812"></a><span class="in">  </span></span>
<span id="cb61-1813"><a href="#cb61-1813"></a><span class="in">  # Process each playlist</span></span>
<span id="cb61-1814"><a href="#cb61-1814"></a><span class="in">  for (i in seq_along(playlists)) {</span></span>
<span id="cb61-1815"><a href="#cb61-1815"></a><span class="in">    playlist &lt;- playlists[[i]]</span></span>
<span id="cb61-1816"><a href="#cb61-1816"></a><span class="in">    </span></span>
<span id="cb61-1817"><a href="#cb61-1817"></a><span class="in">    # Extract playlist-level information</span></span>
<span id="cb61-1818"><a href="#cb61-1818"></a><span class="in">    playlist_id &lt;- playlist$pid</span></span>
<span id="cb61-1819"><a href="#cb61-1819"></a><span class="in">    playlist_name &lt;- playlist$name</span></span>
<span id="cb61-1820"><a href="#cb61-1820"></a><span class="in">    playlist_followers &lt;- playlist$num_followers</span></span>
<span id="cb61-1821"><a href="#cb61-1821"></a><span class="in">    </span></span>
<span id="cb61-1822"><a href="#cb61-1822"></a><span class="in">    # Process each track in the playlist</span></span>
<span id="cb61-1823"><a href="#cb61-1823"></a><span class="in">    if (length(playlist$tracks) &gt; 0) {</span></span>
<span id="cb61-1824"><a href="#cb61-1824"></a><span class="in">      for (j in seq_along(playlist$tracks)) {</span></span>
<span id="cb61-1825"><a href="#cb61-1825"></a><span class="in">        track &lt;- playlist$tracks[[j]]</span></span>
<span id="cb61-1826"><a href="#cb61-1826"></a><span class="in">        </span></span>
<span id="cb61-1827"><a href="#cb61-1827"></a><span class="in">        # Create a row for this track</span></span>
<span id="cb61-1828"><a href="#cb61-1828"></a><span class="in">        track_row &lt;- data.frame(</span></span>
<span id="cb61-1829"><a href="#cb61-1829"></a><span class="in">          playlist_id = playlist_id,</span></span>
<span id="cb61-1830"><a href="#cb61-1830"></a><span class="in">          playlist_name = playlist_name,</span></span>
<span id="cb61-1831"><a href="#cb61-1831"></a><span class="in">          playlist_followers = playlist_followers,</span></span>
<span id="cb61-1832"><a href="#cb61-1832"></a><span class="in">          playlist_position = j,</span></span>
<span id="cb61-1833"><a href="#cb61-1833"></a><span class="in">          artist_name = track$artist_name,</span></span>
<span id="cb61-1834"><a href="#cb61-1834"></a><span class="in">          artist_id = strip_spotify_prefix(track$artist_uri),</span></span>
<span id="cb61-1835"><a href="#cb61-1835"></a><span class="in">          track_name = track$track_name,</span></span>
<span id="cb61-1836"><a href="#cb61-1836"></a><span class="in">          track_id = strip_spotify_prefix(track$track_uri),</span></span>
<span id="cb61-1837"><a href="#cb61-1837"></a><span class="in">          album_name = track$album_name,</span></span>
<span id="cb61-1838"><a href="#cb61-1838"></a><span class="in">          album_id = strip_spotify_prefix(track$album_uri),</span></span>
<span id="cb61-1839"><a href="#cb61-1839"></a><span class="in">          duration = track$duration_ms,</span></span>
<span id="cb61-1840"><a href="#cb61-1840"></a><span class="in">          stringsAsFactors = FALSE</span></span>
<span id="cb61-1841"><a href="#cb61-1841"></a><span class="in">        )</span></span>
<span id="cb61-1842"><a href="#cb61-1842"></a><span class="in">        </span></span>
<span id="cb61-1843"><a href="#cb61-1843"></a><span class="in">        # Append to the result</span></span>
<span id="cb61-1844"><a href="#cb61-1844"></a><span class="in">        result_df &lt;- rbind(result_df, track_row)</span></span>
<span id="cb61-1845"><a href="#cb61-1845"></a><span class="in">      }</span></span>
<span id="cb61-1846"><a href="#cb61-1846"></a><span class="in">    }</span></span>
<span id="cb61-1847"><a href="#cb61-1847"></a><span class="in">  }</span></span>
<span id="cb61-1848"><a href="#cb61-1848"></a><span class="in">  </span></span>
<span id="cb61-1849"><a href="#cb61-1849"></a><span class="in">  return(result_df)</span></span>
<span id="cb61-1850"><a href="#cb61-1850"></a><span class="in">}</span></span>
<span id="cb61-1851"><a href="#cb61-1851"></a></span>
<span id="cb61-1852"><a href="#cb61-1852"></a><span class="in"># Main execution code would follow here</span></span>
<span id="cb61-1853"><a href="#cb61-1853"></a><span class="in"># For brevity, this is not included in the appendix</span></span>
<span id="cb61-1854"><a href="#cb61-1854"></a><span class="in">```</span></span>
<span id="cb61-1855"><a href="#cb61-1855"></a></span>
<span id="cb61-1856"><a href="#cb61-1856"></a><span class="in">```{r plotting-code, eval=FALSE}</span></span>
<span id="cb61-1857"><a href="#cb61-1857"></a><span class="in">#| code-fold: true</span></span>
<span id="cb61-1858"><a href="#cb61-1858"></a><span class="in">#| code-summary: "Click to view visualization code"</span></span>
<span id="cb61-1859"><a href="#cb61-1859"></a></span>
<span id="cb61-1860"><a href="#cb61-1860"></a><span class="in"># Example of a publication-quality visualization function</span></span>
<span id="cb61-1861"><a href="#cb61-1861"></a><span class="in">create_feature_evolution_plot &lt;- function(playlist_data) {</span></span>
<span id="cb61-1862"><a href="#cb61-1862"></a><span class="in">  # Prepare data</span></span>
<span id="cb61-1863"><a href="#cb61-1863"></a><span class="in">  plot_data &lt;- playlist_data %&gt;%</span></span>
<span id="cb61-1864"><a href="#cb61-1864"></a><span class="in">    select(position, track_name, artist_name, danceability, energy, tempo) %&gt;%</span></span>
<span id="cb61-1865"><a href="#cb61-1865"></a><span class="in">    pivot_longer(</span></span>
<span id="cb61-1866"><a href="#cb61-1866"></a><span class="in">      cols = c(danceability, energy, tempo),</span></span>
<span id="cb61-1867"><a href="#cb61-1867"></a><span class="in">      names_to = "feature",</span></span>
<span id="cb61-1868"><a href="#cb61-1868"></a><span class="in">      values_to = "value"</span></span>
<span id="cb61-1869"><a href="#cb61-1869"></a><span class="in">    ) %&gt;%</span></span>
<span id="cb61-1870"><a href="#cb61-1870"></a><span class="in">    # Normalize tempo to 0-1 scale for better comparison</span></span>
<span id="cb61-1871"><a href="#cb61-1871"></a><span class="in">    mutate(value = ifelse(feature == "tempo", value / 200, value))</span></span>
<span id="cb61-1872"><a href="#cb61-1872"></a><span class="in">  </span></span>
<span id="cb61-1873"><a href="#cb61-1873"></a><span class="in">  # Create plot</span></span>
<span id="cb61-1874"><a href="#cb61-1874"></a><span class="in">  ggplot(plot_data, aes(x = position, y = value, color = feature, group = feature)) +</span></span>
<span id="cb61-1875"><a href="#cb61-1875"></a><span class="in">    geom_line(size = 1.2) +</span></span>
<span id="cb61-1876"><a href="#cb61-1876"></a><span class="in">    geom_point(size = 3) +</span></span>
<span id="cb61-1877"><a href="#cb61-1877"></a><span class="in">    scale_color_manual(values = c("danceability" = "#3498db", "energy" = "#e74c3c", "tempo" = "#2ecc71")) +</span></span>
<span id="cb61-1878"><a href="#cb61-1878"></a><span class="in">    labs(</span></span>
<span id="cb61-1879"><a href="#cb61-1879"></a><span class="in">      title = "Playlist Feature Evolution",</span></span>
<span id="cb61-1880"><a href="#cb61-1880"></a><span class="in">      subtitle = "How audio characteristics flow throughout the playlist",</span></span>
<span id="cb61-1881"><a href="#cb61-1881"></a><span class="in">      x = "Playlist Position",</span></span>
<span id="cb61-1882"><a href="#cb61-1882"></a><span class="in">      y = "Feature Value (normalized)",</span></span>
<span id="cb61-1883"><a href="#cb61-1883"></a><span class="in">      color = "Audio Feature"</span></span>
<span id="cb61-1884"><a href="#cb61-1884"></a><span class="in">    ) +</span></span>
<span id="cb61-1885"><a href="#cb61-1885"></a><span class="in">    theme_minimal() +</span></span>
<span id="cb61-1886"><a href="#cb61-1886"></a><span class="in">    theme(</span></span>
<span id="cb61-1887"><a href="#cb61-1887"></a><span class="in">      plot.title = element_text(face = "bold", size = 16),</span></span>
<span id="cb61-1888"><a href="#cb61-1888"></a><span class="in">      plot.subtitle = element_text(size = 12),</span></span>
<span id="cb61-1889"><a href="#cb61-1889"></a><span class="in">      axis.title = element_text(face = "bold"),</span></span>
<span id="cb61-1890"><a href="#cb61-1890"></a><span class="in">      legend.position = "bottom",</span></span>
<span id="cb61-1891"><a href="#cb61-1891"></a><span class="in">      panel.grid.major = element_line(color = "#bdc3c7", linetype = "dashed")</span></span>
<span id="cb61-1892"><a href="#cb61-1892"></a><span class="in">    )</span></span>
<span id="cb61-1893"><a href="#cb61-1893"></a><span class="in">}</span></span>
<span id="cb61-1894"><a href="#cb61-1894"></a></span>
<span id="cb61-1895"><a href="#cb61-1895"></a><span class="in"># This function would be called with: create_feature_evolution_plot(ultimate_playlist)</span></span>
<span id="cb61-1896"><a href="#cb61-1896"></a><span class="in">```</span></span>
<span id="cb61-1897"><a href="#cb61-1897"></a></span>
<span id="cb61-1898"><a href="#cb61-1898"></a><span class="fu">## Final Thoughts</span></span>
<span id="cb61-1899"><a href="#cb61-1899"></a></span>
<span id="cb61-1900"><a href="#cb61-1900"></a>Creating the ultimate playlist requires both art and science. Through this mini-project, I've demonstrated how data analysis can enhance music curation by revealing patterns and relationships in audio features. The "Harmonic Journey" playlist exemplifies a balanced, data-driven approach to music selection, creating a cohesive listening experience that guides the listener through a carefully crafted sonic landscape.</span>
<span id="cb61-1901"><a href="#cb61-1901"></a></span>
<span id="cb61-1902"><a href="#cb61-1902"></a>The combination of objective metrics (audio features, popularity scores) with more subjective considerations (musical flow, thematic coherence) results in a playlist that's both statistically sound and emotionally engaging. This approach has wide-ranging applications in music recommendation systems, content curation, and digital media strategy.</span>
<span id="cb61-1903"><a href="#cb61-1903"></a></span>
<span id="cb61-1904"><a href="#cb61-1904"></a>Most importantly, this analysis shows how data science can enhance, rather than replace, human creativity—providing insights that inform artistic decisions and create better experiences for listeners. By animating our feature‐journey plot and embedding live Spotify players in the HTML viewer, we’ve turned a static report into an interactive, multimedia exploration of “Harmonic Journey.” This blend of rigorous analytics, music theory, and engaging presentation demonstrates the full potential of data‐driven curation in the digital age.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>